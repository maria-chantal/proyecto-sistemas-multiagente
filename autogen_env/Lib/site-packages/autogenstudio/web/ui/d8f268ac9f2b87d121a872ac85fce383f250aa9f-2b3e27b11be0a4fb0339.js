/*! For license information please see d8f268ac9f2b87d121a872ac85fce383f250aa9f-2b3e27b11be0a4fb0339.js.LICENSE.txt */
(self.webpackChunkautogentstudio=self.webpackChunkautogentstudio||[]).push([[514],{41:function(e,t,n){"use strict";let r=n(4570),o=n(4809).uniqueId;e.exports={run:function(e){("greedy"===e.graph().acyclicer?r(e,function(e){return t=>e.edge(t).weight}(e)):function(e){let t=[],n={},r={};function o(i){Object.hasOwn(r,i)||(r[i]=!0,n[i]=!0,e.outEdges(i).forEach((e=>{Object.hasOwn(n,e.w)?t.push(e):o(e.w)})),delete n[i])}return e.nodes().forEach(o),t}(e)).forEach((t=>{let n=e.edge(t);e.removeEdge(t),n.forwardName=t.name,n.reversed=!0,e.setEdge(t.w,t.v,n,o("rev"))}))},undo:function(e){e.edges().forEach((t=>{let n=e.edge(t);if(n.reversed){e.removeEdge(t);let r=n.forwardName;delete n.reversed,delete n.forwardName,e.setEdge(t.w,t.v,n,r)}}))}}},85:function(e,t,n){"use strict";n.d(t,{A:function(){return r}});const r=(0,n(1788).A)("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]])},258:function(e,t,n){"use strict";let r=n(4809);e.exports={run:function(e){e.graph().dummyChains=[],e.edges().forEach((t=>function(e,t){let n,o,i,a=t.v,s=e.node(a).rank,c=t.w,l=e.node(c).rank,u=t.name,d=e.edge(t),h=d.labelRank;if(l===s+1)return;for(e.removeEdge(t),i=0,++s;s<l;++i,++s)d.points=[],o={width:0,height:0,edgeLabel:d,edgeObj:t,rank:s},n=r.addDummyNode(e,"edge",o,"_d"),s===h&&(o.width=d.width,o.height=d.height,o.dummy="edge-label",o.labelpos=d.labelpos),e.setEdge(a,n,{weight:d.weight},u),0===i&&e.graph().dummyChains.push(n),a=n;e.setEdge(a,c,{weight:d.weight},u)}(e,t)))},undo:function(e){e.graph().dummyChains.forEach((t=>{let n,r=e.node(t),o=r.edgeLabel;for(e.setEdge(r.edgeObj,o);r.dummy;)n=e.successors(t)[0],e.removeNode(t),o.points.push({x:r.x,y:r.y}),"edge-label"===r.dummy&&(o.x=r.x,o.y=r.y,o.width=r.width,o.height=r.height),t=n,r=e.node(t)}))}}},334:function(e,t,n){let r=n(4809),o=n(6743).Graph;e.exports={debugOrdering:function(e){let t=r.buildLayerMatrix(e),n=new o({compound:!0,multigraph:!0}).setGraph({});return e.nodes().forEach((t=>{n.setNode(t,{label:t}),n.setParent(t,"layer"+e.node(t).rank)})),e.edges().forEach((e=>n.setEdge(e.v,e.w,{},e.name))),t.forEach(((e,t)=>{let r="layer"+t;n.setNode(r,{rank:"same"}),e.reduce(((e,t)=>(n.setEdge(e,t,{style:"invis"}),t)))})),n}}},418:function(e,t,n){"use strict";n.d(t,{A:function(){return r}});const r=(0,n(1788).A)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},468:function(e,t,n){"use strict";n.d(t,{A:function(){return r}});const r=(0,n(1788).A)("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]])},477:function(e){e.exports=function(e,t,n){let r,o={};n.forEach((n=>{let i,a,s=e.parent(n);for(;s;){if(i=e.parent(s),i?(a=o[i],o[i]=s):(a=r,r=s),a&&a!==s)return void t.setEdge(a,s);s=i}}))}},834:function(e,t,n){"use strict";n.d(t,{t:function(){return i}});var r=n(1511),o=n(2571);const i=(0,r.v)(((e,t)=>({galleries:[],selectedGallery:null,isLoading:!1,error:null,fetchGalleries:async n=>{try{e({isLoading:!0,error:null});const r=await o.f.listGalleries(n);e({galleries:r,selectedGallery:t().selectedGallery||r[0]||null,isLoading:!1})}catch(r){e({error:r instanceof Error?r.message:"Failed to fetch galleries",isLoading:!1})}},selectGallery:t=>{e({selectedGallery:t})},getSelectedGallery:()=>t().selectedGallery})))},860:function(e,t,n){"use strict";var r=n(9294).longestPath,o=n(3776),i=n(3061);e.exports=function(e){switch(e.graph().ranker){case"network-simplex":default:s(e);break;case"tight-tree":!function(e){r(e),o(e)}(e);break;case"longest-path":a(e)}};var a=r;function s(e){i(e)}},942:function(e,t,n){"use strict";n.d(t,{A:function(){return r}});const r=(0,n(1788).A)("Minimize2",[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]])},1236:function(e,t,n){let r=n(4809);function o(e,t,n,o,i,a){let s={width:0,height:0,rank:a,borderType:t},c=i[t][a-1],l=r.addDummyNode(e,"border",s,n);i[t][a]=l,e.setParent(l,o),c&&e.setEdge(c,l,{weight:1})}e.exports=function(e){e.children().forEach((function t(n){let r=e.children(n),i=e.node(n);if(r.length&&r.forEach(t),Object.hasOwn(i,"minRank")){i.borderLeft=[],i.borderRight=[];for(let t=i.minRank,r=i.maxRank+1;t<r;++t)o(e,"borderLeft","_bl",n,i,t),o(e,"borderRight","_br",n,i,t)}}))}},1325:function(e,t,n){"use strict";n.d(t,{C:function(){return s}});var r=n(1511),o=n(7134),i=n(1806);const a={show_llm_call_events:!1,expanded_messages_by_default:!1,show_agent_flow_by_default:!1},s=(0,r.v)()((0,o.Zr)(((e,t)=>({serverSettings:null,isLoading:!1,error:null,uiSettings:a,initializeSettings:async n=>{if(!t().isLoading)try{e({isLoading:!0,error:null});const t=await i.Y.getSettings(n),r=(e=>e&&e.config&&e.config.ui?e.config.ui:a)(t);e({serverSettings:t,uiSettings:r,isLoading:!1})}catch(r){console.error("Failed to load settings:",r),e({error:"Failed to load settings",isLoading:!1,uiSettings:a})}},updateUISettings:n=>{const{uiSettings:r}=t(),o={...r,...n};e({uiSettings:o})},resetUISettings:async()=>(e({uiSettings:a}),Promise.resolve())})),{name:"ags-app-settings-0",partialize:e=>({uiSettings:e.uiSettings})}))},1806:function(e,t,n){"use strict";n.d(t,{Y:function(){return i}});var r=n(7387);let o=function(e){function t(){return e.apply(this,arguments)||this}(0,r.A)(t,e);var n=t.prototype;return n.getSettings=async function(e){const t=await fetch(`${this.getBaseUrl()}/settings/?user_id=${e}`,{headers:this.getHeaders()}),n=await t.json();if(!n.status)throw new Error(n.message||"Failed to fetch settings");return n.data},n.updateSettings=async function(e,t){const n={...e,user_id:e.user_id||t};console.log("settingsData",n);const r=await fetch(`${this.getBaseUrl()}/settings/`,{method:"PUT",headers:this.getHeaders(),body:JSON.stringify(n)}),o=await r.json();if(!o.status)throw new Error(o.message||"Failed to update settings");return o.data},t}(n(3838).y);const i=new o},2162:function(e,t,n){"use strict";var r=n(6540),o=n(9888);var i="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},a=o.useSyncExternalStore,s=r.useRef,c=r.useEffect,l=r.useMemo,u=r.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,n,r,o){var d=s(null);if(null===d.current){var h={hasValue:!1,value:null};d.current=h}else h=d.current;d=l((function(){function e(e){if(!c){if(c=!0,a=e,e=r(e),void 0!==o&&h.hasValue){var t=h.value;if(o(t,e))return s=t}return s=e}if(t=s,i(a,e))return t;var n=r(e);return void 0!==o&&o(t,n)?(a=e,t):(a=e,s=n)}var a,s,c=!1,l=void 0===n?null:n;return[function(){return e(t())},null===l?void 0:function(){return e(l())}]}),[t,n,r,o]);var f=a(e,d[0],d[1]);return c((function(){h.hasValue=!0,h.value=f}),[f]),u(f),f}},2275:function(e,t,n){"use strict";n.d(t,{Do:function(){return rr},WZ:function(){return Qn},TG:function(){return or},ny:function(){return er},yX:function(){return ir},xN:function(){return Jo},Qc:function(){return tr},I$:function(){return Lo},aQ:function(){return Vo},di:function(){return Fo},kO:function(){return Ko},ET:function(){return ai},rN:function(){return so},bi:function(){return No},_s:function(){return Yr},aE:function(){return vr},Hm:function(){return xo},KE:function(){return Pr},tn:function(){return Jn},xc:function(){return Zn},us:function(){return Fr},Pr:function(){return yr},e_:function(){return Qr},Fp:function(){return no},Mi:function(){return Or},HF:function(){return sr},Eo:function(){return Gr},b5:function(){return po},Tq:function(){return wr},qX:function(){return oo},q1:function(){return Kr},YV:function(){return gr},oj:function(){return qr},aZ:function(){return fr},aW:function(){return wo},uD:function(){return Br},Jo:function(){return hr},U$:function(){return mr},X6:function(){return Ir},oN:function(){return fo},ah:function(){return co},R4:function(){return Rr},r8:function(){return Co},ZO:function(){return Kn},bK:function(){return nr},b$:function(){return cr},uj:function(){return io},v5:function(){return Ur},Ue:function(){return Dr},Er:function(){return Zr},oB:function(){return lr},kf:function(){return zr},mW:function(){return Tr},QE:function(){return Vr},kM:function(){return Cr},No:function(){return Oo},Ff:function(){return Lr},zj:function(){return jr},s_:function(){return $r},vS:function(){return ko},qn:function(){return To},uL:function(){return Ao}});var r={value:()=>{}};function o(){for(var e,t=0,n=arguments.length,r={};t<n;++t){if(!(e=arguments[t]+"")||e in r||/[\s.]/.test(e))throw new Error("illegal type: "+e);r[e]=[]}return new i(r)}function i(e){this._=e}function a(e,t){for(var n,r=0,o=e.length;r<o;++r)if((n=e[r]).name===t)return n.value}function s(e,t,n){for(var o=0,i=e.length;o<i;++o)if(e[o].name===t){e[o]=r,e=e.slice(0,o).concat(e.slice(o+1));break}return null!=n&&e.push({name:t,value:n}),e}i.prototype=o.prototype={constructor:i,on:function(e,t){var n,r,o=this._,i=(r=o,(e+"").trim().split(/^|\s+/).map((function(e){var t="",n=e.indexOf(".");if(n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),e&&!r.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:t}}))),c=-1,l=i.length;if(!(arguments.length<2)){if(null!=t&&"function"!=typeof t)throw new Error("invalid callback: "+t);for(;++c<l;)if(n=(e=i[c]).type)o[n]=s(o[n],e.name,t);else if(null==t)for(n in o)o[n]=s(o[n],e.name,null);return this}for(;++c<l;)if((n=(e=i[c]).type)&&(n=a(o[n],e.name)))return n},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new i(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var n,r,o=new Array(n),i=0;i<n;++i)o[i]=arguments[i+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=0,n=(r=this._[e]).length;i<n;++i)r[i].value.apply(t,o)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],o=0,i=r.length;o<i;++o)r[o].value.apply(t,n)}};var c=o;function l(){}function u(e){return null==e?l:function(){return this.querySelector(e)}}function d(){return[]}function h(e){return null==e?d:function(){return this.querySelectorAll(e)}}function f(e){return function(){return null==(t=e.apply(this,arguments))?[]:Array.isArray(t)?t:Array.from(t);var t}}function m(e){return function(){return this.matches(e)}}function p(e){return function(t){return t.matches(e)}}var g=Array.prototype.find;function y(){return this.firstElementChild}var v=Array.prototype.filter;function w(){return Array.from(this.children)}function x(e){return new Array(e.length)}function b(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}function E(e,t,n,r,o,i){for(var a,s=0,c=t.length,l=i.length;s<l;++s)(a=t[s])?(a.__data__=i[s],r[s]=a):n[s]=new b(e,i[s]);for(;s<c;++s)(a=t[s])&&(o[s]=a)}function _(e,t,n,r,o,i,a){var s,c,l,u=new Map,d=t.length,h=i.length,f=new Array(d);for(s=0;s<d;++s)(c=t[s])&&(f[s]=l=a.call(c,c.__data__,s,t)+"",u.has(l)?o[s]=c:u.set(l,c));for(s=0;s<h;++s)l=a.call(e,i[s],s,i)+"",(c=u.get(l))?(r[s]=c,c.__data__=i[s],u.delete(l)):n[s]=new b(e,i[s]);for(s=0;s<d;++s)(c=t[s])&&u.get(f[s])===c&&(o[s]=c)}function k(e){return e.__data__}function N(e){return"object"==typeof e&&"length"in e?e:Array.from(e)}function S(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}b.prototype={constructor:b,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};var M="http://www.w3.org/1999/xhtml",C={svg:"http://www.w3.org/2000/svg",xhtml:M,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function A(e){var t=e+="",n=t.indexOf(":");return n>=0&&"xmlns"!==(t=e.slice(0,n))&&(e=e.slice(n+1)),C.hasOwnProperty(t)?{space:C[t],local:e}:e}function O(e){return function(){this.removeAttribute(e)}}function I(e){return function(){this.removeAttributeNS(e.space,e.local)}}function T(e,t){return function(){this.setAttribute(e,t)}}function z(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function P(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}}function $(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function L(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function j(e){return function(){this.style.removeProperty(e)}}function R(e,t,n){return function(){this.style.setProperty(e,t,n)}}function D(e,t,n){return function(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function H(e,t){return e.style.getPropertyValue(t)||L(e).getComputedStyle(e,null).getPropertyValue(t)}function B(e){return function(){delete this[e]}}function V(e,t){return function(){this[e]=t}}function F(e,t){return function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}}function Y(e){return e.trim().split(/^|\s+/)}function X(e){return e.classList||new G(e)}function G(e){this._node=e,this._names=Y(e.getAttribute("class")||"")}function q(e,t){for(var n=X(e),r=-1,o=t.length;++r<o;)n.add(t[r])}function W(e,t){for(var n=X(e),r=-1,o=t.length;++r<o;)n.remove(t[r])}function U(e){return function(){q(this,e)}}function Z(e){return function(){W(this,e)}}function K(e,t){return function(){(t.apply(this,arguments)?q:W)(this,e)}}function J(){this.textContent=""}function Q(e){return function(){this.textContent=e}}function ee(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}function te(){this.innerHTML=""}function ne(e){return function(){this.innerHTML=e}}function re(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}function oe(){this.nextSibling&&this.parentNode.appendChild(this)}function ie(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function ae(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===M&&t.documentElement.namespaceURI===M?t.createElement(e):t.createElementNS(n,e)}}function se(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function ce(e){var t=A(e);return(t.local?se:ae)(t)}function le(){return null}function ue(){var e=this.parentNode;e&&e.removeChild(this)}function de(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function he(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function fe(e){return function(){var t=this.__on;if(t){for(var n,r=0,o=-1,i=t.length;r<i;++r)n=t[r],e.type&&n.type!==e.type||n.name!==e.name?t[++o]=n:this.removeEventListener(n.type,n.listener,n.options);++o?t.length=o:delete this.__on}}}function me(e,t,n){return function(){var r,o=this.__on,i=function(e){return function(t){e.call(this,t,this.__data__)}}(t);if(o)for(var a=0,s=o.length;a<s;++a)if((r=o[a]).type===e.type&&r.name===e.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=i,r.options=n),void(r.value=t);this.addEventListener(e.type,i,n),r={type:e.type,name:e.name,value:t,listener:i,options:n},o?o.push(r):this.__on=[r]}}function pe(e,t,n){var r=L(e),o=r.CustomEvent;"function"==typeof o?o=new o(t,n):(o=r.document.createEvent("Event"),n?(o.initEvent(t,n.bubbles,n.cancelable),o.detail=n.detail):o.initEvent(t,!1,!1)),e.dispatchEvent(o)}function ge(e,t){return function(){return pe(this,e,t)}}function ye(e,t){return function(){return pe(this,e,t.apply(this,arguments))}}G.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};var ve=[null];function we(e,t){this._groups=e,this._parents=t}function xe(){return new we([[document.documentElement]],ve)}we.prototype=xe.prototype={constructor:we,select:function(e){"function"!=typeof e&&(e=u(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var i,a,s=t[o],c=s.length,l=r[o]=new Array(c),d=0;d<c;++d)(i=s[d])&&(a=e.call(i,i.__data__,d,s))&&("__data__"in i&&(a.__data__=i.__data__),l[d]=a);return new we(r,this._parents)},selectAll:function(e){e="function"==typeof e?f(e):h(e);for(var t=this._groups,n=t.length,r=[],o=[],i=0;i<n;++i)for(var a,s=t[i],c=s.length,l=0;l<c;++l)(a=s[l])&&(r.push(e.call(a,a.__data__,l,s)),o.push(a));return new we(r,o)},selectChild:function(e){return this.select(null==e?y:function(e){return function(){return g.call(this.children,e)}}("function"==typeof e?e:p(e)))},selectChildren:function(e){return this.selectAll(null==e?w:function(e){return function(){return v.call(this.children,e)}}("function"==typeof e?e:p(e)))},filter:function(e){"function"!=typeof e&&(e=m(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var i,a=t[o],s=a.length,c=r[o]=[],l=0;l<s;++l)(i=a[l])&&e.call(i,i.__data__,l,a)&&c.push(i);return new we(r,this._parents)},data:function(e,t){if(!arguments.length)return Array.from(this,k);var n,r=t?_:E,o=this._parents,i=this._groups;"function"!=typeof e&&(n=e,e=function(){return n});for(var a=i.length,s=new Array(a),c=new Array(a),l=new Array(a),u=0;u<a;++u){var d=o[u],h=i[u],f=h.length,m=N(e.call(d,d&&d.__data__,u,o)),p=m.length,g=c[u]=new Array(p),y=s[u]=new Array(p);r(d,h,g,y,l[u]=new Array(f),m,t);for(var v,w,x=0,b=0;x<p;++x)if(v=g[x]){for(x>=b&&(b=x+1);!(w=y[b])&&++b<p;);v._next=w||null}}return(s=new we(s,o))._enter=c,s._exit=l,s},enter:function(){return new we(this._enter||this._groups.map(x),this._parents)},exit:function(){return new we(this._exit||this._groups.map(x),this._parents)},join:function(e,t,n){var r=this.enter(),o=this,i=this.exit();return"function"==typeof e?(r=e(r))&&(r=r.selection()):r=r.append(e+""),null!=t&&(o=t(o))&&(o=o.selection()),null==n?i.remove():n(i),r&&o?r.merge(o).order():o},merge:function(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,o=n.length,i=r.length,a=Math.min(o,i),s=new Array(o),c=0;c<a;++c)for(var l,u=n[c],d=r[c],h=u.length,f=s[c]=new Array(h),m=0;m<h;++m)(l=u[m]||d[m])&&(f[m]=l);for(;c<o;++c)s[c]=n[c];return new we(s,this._parents)},selection:function(){return this},order:function(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r,o=e[t],i=o.length-1,a=o[i];--i>=0;)(r=o[i])&&(a&&4^r.compareDocumentPosition(a)&&a.parentNode.insertBefore(r,a),a=r);return this},sort:function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=S);for(var n=this._groups,r=n.length,o=new Array(r),i=0;i<r;++i){for(var a,s=n[i],c=s.length,l=o[i]=new Array(c),u=0;u<c;++u)(a=s[u])&&(l[u]=a);l.sort(t)}return new we(o,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],o=0,i=r.length;o<i;++o){var a=r[o];if(a)return a}return null},size:function(){let e=0;for(const t of this)++e;return e},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var o,i=t[n],a=0,s=i.length;a<s;++a)(o=i[a])&&e.call(o,o.__data__,a,i);return this},attr:function(e,t){var n=A(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==t?n.local?I:O:"function"==typeof t?n.local?$:P:n.local?z:T)(n,t))},style:function(e,t,n){return arguments.length>1?this.each((null==t?j:"function"==typeof t?D:R)(e,t,null==n?"":n)):H(this.node(),e)},property:function(e,t){return arguments.length>1?this.each((null==t?B:"function"==typeof t?F:V)(e,t)):this.node()[e]},classed:function(e,t){var n=Y(e+"");if(arguments.length<2){for(var r=X(this.node()),o=-1,i=n.length;++o<i;)if(!r.contains(n[o]))return!1;return!0}return this.each(("function"==typeof t?K:t?U:Z)(n,t))},text:function(e){return arguments.length?this.each(null==e?J:("function"==typeof e?ee:Q)(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?te:("function"==typeof e?re:ne)(e)):this.node().innerHTML},raise:function(){return this.each(oe)},lower:function(){return this.each(ie)},append:function(e){var t="function"==typeof e?e:ce(e);return this.select((function(){return this.appendChild(t.apply(this,arguments))}))},insert:function(e,t){var n="function"==typeof e?e:ce(e),r=null==t?le:"function"==typeof t?t:u(t);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(ue)},clone:function(e){return this.select(e?he:de)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,n){var r,o,i=function(e){return e.trim().split(/^|\s+/).map((function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}}))}(e+""),a=i.length;if(!(arguments.length<2)){for(s=t?me:fe,r=0;r<a;++r)this.each(s(i[r],t,n));return this}var s=this.node().__on;if(s)for(var c,l=0,u=s.length;l<u;++l)for(r=0,c=s[l];r<a;++r)if((o=i[r]).type===c.type&&o.name===c.name)return c.value},dispatch:function(e,t){return this.each(("function"==typeof t?ye:ge)(e,t))},[Symbol.iterator]:function*(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r,o=e[t],i=0,a=o.length;i<a;++i)(r=o[i])&&(yield r)}};var be=xe;function Ee(e){return"string"==typeof e?new we([[document.querySelector(e)]],[document.documentElement]):new we([[e]],ve)}function _e(e,t){if(e=function(e){let t;for(;t=e.sourceEvent;)e=t;return e}(e),void 0===t&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,[(r=r.matrixTransform(t.getScreenCTM().inverse())).x,r.y]}if(t.getBoundingClientRect){var o=t.getBoundingClientRect();return[e.clientX-o.left-t.clientLeft,e.clientY-o.top-t.clientTop]}}return[e.pageX,e.pageY]}const ke={passive:!1},Ne={capture:!0,passive:!1};function Se(e){e.stopImmediatePropagation()}function Me(e){e.preventDefault(),e.stopImmediatePropagation()}function Ce(e){var t=e.document.documentElement,n=Ee(e).on("dragstart.drag",Me,Ne);"onselectstart"in t?n.on("selectstart.drag",Me,Ne):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function Ae(e,t){var n=e.document.documentElement,r=Ee(e).on("dragstart.drag",null);t&&(r.on("click.drag",Me,Ne),setTimeout((function(){r.on("click.drag",null)}),0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}var Oe=e=>()=>e;function Ie(e,{sourceEvent:t,subject:n,target:r,identifier:o,active:i,x:a,y:s,dx:c,dy:l,dispatch:u}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:o,enumerable:!0,configurable:!0},active:{value:i,enumerable:!0,configurable:!0},x:{value:a,enumerable:!0,configurable:!0},y:{value:s,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:l,enumerable:!0,configurable:!0},_:{value:u}})}function Te(e){return!e.ctrlKey&&!e.button}function ze(){return this.parentNode}function Pe(e,t){return null==t?{x:e.x,y:e.y}:t}function $e(){return navigator.maxTouchPoints||"ontouchstart"in this}function Le(){var e,t,n,r,o=Te,i=ze,a=Pe,s=$e,l={},u=c("start","drag","end"),d=0,h=0;function f(e){e.on("mousedown.drag",m).filter(s).on("touchstart.drag",y).on("touchmove.drag",v,ke).on("touchend.drag touchcancel.drag",w).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function m(a,s){if(!r&&o.call(this,a,s)){var c=x(this,i.call(this,a,s),a,s,"mouse");c&&(Ee(a.view).on("mousemove.drag",p,Ne).on("mouseup.drag",g,Ne),Ce(a.view),Se(a),n=!1,e=a.clientX,t=a.clientY,c("start",a))}}function p(r){if(Me(r),!n){var o=r.clientX-e,i=r.clientY-t;n=o*o+i*i>h}l.mouse("drag",r)}function g(e){Ee(e.view).on("mousemove.drag mouseup.drag",null),Ae(e.view,n),Me(e),l.mouse("end",e)}function y(e,t){if(o.call(this,e,t)){var n,r,a=e.changedTouches,s=i.call(this,e,t),c=a.length;for(n=0;n<c;++n)(r=x(this,s,e,t,a[n].identifier,a[n]))&&(Se(e),r("start",e,a[n]))}}function v(e){var t,n,r=e.changedTouches,o=r.length;for(t=0;t<o;++t)(n=l[r[t].identifier])&&(Me(e),n("drag",e,r[t]))}function w(e){var t,n,o=e.changedTouches,i=o.length;for(r&&clearTimeout(r),r=setTimeout((function(){r=null}),500),t=0;t<i;++t)(n=l[o[t].identifier])&&(Se(e),n("end",e,o[t]))}function x(e,t,n,r,o,i){var s,c,h,m=u.copy(),p=_e(i||n,t);if(null!=(h=a.call(e,new Ie("beforestart",{sourceEvent:n,target:f,identifier:o,active:d,x:p[0],y:p[1],dx:0,dy:0,dispatch:m}),r)))return s=h.x-p[0]||0,c=h.y-p[1]||0,function n(i,a,u){var g,y=p;switch(i){case"start":l[o]=n,g=d++;break;case"end":delete l[o],--d;case"drag":p=_e(u||a,t),g=d}m.call(i,e,new Ie(i,{sourceEvent:a,subject:h,target:f,identifier:o,active:g,x:p[0]+s,y:p[1]+c,dx:p[0]-y[0],dy:p[1]-y[1],dispatch:m}),r)}}return f.filter=function(e){return arguments.length?(o="function"==typeof e?e:Oe(!!e),f):o},f.container=function(e){return arguments.length?(i="function"==typeof e?e:Oe(e),f):i},f.subject=function(e){return arguments.length?(a="function"==typeof e?e:Oe(e),f):a},f.touchable=function(e){return arguments.length?(s="function"==typeof e?e:Oe(!!e),f):s},f.on=function(){var e=u.on.apply(u,arguments);return e===u?f:e},f.clickDistance=function(e){return arguments.length?(h=(e=+e)*e,f):Math.sqrt(h)},f}Ie.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function je(e){return((e=Math.exp(e))+1/e)/2}var Re,De,He=function e(t,n,r){function o(e,o){var i,a,s=e[0],c=e[1],l=e[2],u=o[0],d=o[1],h=o[2],f=u-s,m=d-c,p=f*f+m*m;if(p<1e-12)a=Math.log(h/l)/t,i=function(e){return[s+e*f,c+e*m,l*Math.exp(t*e*a)]};else{var g=Math.sqrt(p),y=(h*h-l*l+r*p)/(2*l*n*g),v=(h*h-l*l-r*p)/(2*h*n*g),w=Math.log(Math.sqrt(y*y+1)-y),x=Math.log(Math.sqrt(v*v+1)-v);a=(x-w)/t,i=function(e){var r,o=e*a,i=je(w),u=l/(n*g)*(i*(r=t*o+w,((r=Math.exp(2*r))-1)/(r+1))-function(e){return((e=Math.exp(e))-1/e)/2}(w));return[s+u*f,c+u*m,l*i/je(t*o+w)]}}return i.duration=1e3*a*t/Math.SQRT2,i}return o.rho=function(t){var n=Math.max(.001,+t),r=n*n;return e(n,r,r*r)},o}(Math.SQRT2,2,4),Be=0,Ve=0,Fe=0,Ye=0,Xe=0,Ge=0,qe="object"==typeof performance&&performance.now?performance:Date,We="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Ue(){return Xe||(We(Ze),Xe=qe.now()+Ge)}function Ze(){Xe=0}function Ke(){this._call=this._time=this._next=null}function Je(e,t,n){var r=new Ke;return r.restart(e,t,n),r}function Qe(){Xe=(Ye=qe.now())+Ge,Be=Ve=0;try{!function(){Ue(),++Be;for(var e,t=Re;t;)(e=Xe-t._time)>=0&&t._call.call(void 0,e),t=t._next;--Be}()}finally{Be=0,function(){var e,t,n=Re,r=1/0;for(;n;)n._call?(r>n._time&&(r=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:Re=t);De=e,tt(r)}(),Xe=0}}function et(){var e=qe.now(),t=e-Ye;t>1e3&&(Ge-=t,Ye=e)}function tt(e){Be||(Ve&&(Ve=clearTimeout(Ve)),e-Xe>24?(e<1/0&&(Ve=setTimeout(Qe,e-qe.now()-Ge)),Fe&&(Fe=clearInterval(Fe))):(Fe||(Ye=qe.now(),Fe=setInterval(et,1e3)),Be=1,We(Qe)))}function nt(e,t,n){var r=new Ke;return t=null==t?0:+t,r.restart((n=>{r.stop(),e(n+t)}),t,n),r}Ke.prototype=Je.prototype={constructor:Ke,restart:function(e,t,n){if("function"!=typeof e)throw new TypeError("callback is not a function");n=(null==n?Ue():+n)+(null==t?0:+t),this._next||De===this||(De?De._next=this:Re=this,De=this),this._call=e,this._time=n,tt()},stop:function(){this._call&&(this._call=null,this._time=1/0,tt())}};var rt=c("start","end","cancel","interrupt"),ot=[],it=2,at=5,st=6;function ct(e,t,n,r,o,i){var a=e.__transition;if(a){if(n in a)return}else e.__transition={};!function(e,t,n){var r,o=e.__transition;function i(e){n.state=1,n.timer.restart(a,n.delay,n.time),n.delay<=e&&a(e-n.delay)}function a(i){var l,u,d,h;if(1!==n.state)return c();for(l in o)if((h=o[l]).name===n.name){if(3===h.state)return nt(a);4===h.state?(h.state=st,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete o[l]):+l<t&&(h.state=st,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete o[l])}if(nt((function(){3===n.state&&(n.state=4,n.timer.restart(s,n.delay,n.time),s(i))})),n.state=it,n.on.call("start",e,e.__data__,n.index,n.group),n.state===it){for(n.state=3,r=new Array(d=n.tween.length),l=0,u=-1;l<d;++l)(h=n.tween[l].value.call(e,e.__data__,n.index,n.group))&&(r[++u]=h);r.length=u+1}}function s(t){for(var o=t<n.duration?n.ease.call(null,t/n.duration):(n.timer.restart(c),n.state=at,1),i=-1,a=r.length;++i<a;)r[i].call(e,o);n.state===at&&(n.on.call("end",e,e.__data__,n.index,n.group),c())}function c(){for(var r in n.state=st,n.timer.stop(),delete o[t],o)return;delete e.__transition}o[t]=n,n.timer=Je(i,0,n.time)}(e,n,{name:t,index:r,group:o,on:rt,tween:ot,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:0})}function lt(e,t){var n=dt(e,t);if(n.state>0)throw new Error("too late; already scheduled");return n}function ut(e,t){var n=dt(e,t);if(n.state>3)throw new Error("too late; already running");return n}function dt(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function ht(e,t){var n,r,o,i=e.__transition,a=!0;if(i){for(o in t=null==t?null:t+"",i)(n=i[o]).name===t?(r=n.state>it&&n.state<at,n.state=st,n.timer.stop(),n.on.call(r?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete i[o]):a=!1;a&&delete e.__transition}}function ft(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var mt,pt=180/Math.PI,gt={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function yt(e,t,n,r,o,i){var a,s,c;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(c=e*n+t*r)&&(n-=e*c,r-=t*c),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,c/=s),e*r<t*n&&(e=-e,t=-t,c=-c,a=-a),{translateX:o,translateY:i,rotate:Math.atan2(t,e)*pt,skewX:Math.atan(c)*pt,scaleX:a,scaleY:s}}function vt(e,t,n,r){function o(e){return e.length?e.pop()+" ":""}return function(i,a){var s=[],c=[];return i=e(i),a=e(a),function(e,r,o,i,a,s){if(e!==o||r!==i){var c=a.push("translate(",null,t,null,n);s.push({i:c-4,x:ft(e,o)},{i:c-2,x:ft(r,i)})}else(o||i)&&a.push("translate("+o+t+i+n)}(i.translateX,i.translateY,a.translateX,a.translateY,s,c),function(e,t,n,i){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),i.push({i:n.push(o(n)+"rotate(",null,r)-2,x:ft(e,t)})):t&&n.push(o(n)+"rotate("+t+r)}(i.rotate,a.rotate,s,c),function(e,t,n,i){e!==t?i.push({i:n.push(o(n)+"skewX(",null,r)-2,x:ft(e,t)}):t&&n.push(o(n)+"skewX("+t+r)}(i.skewX,a.skewX,s,c),function(e,t,n,r,i,a){if(e!==n||t!==r){var s=i.push(o(i)+"scale(",null,",",null,")");a.push({i:s-4,x:ft(e,n)},{i:s-2,x:ft(t,r)})}else 1===n&&1===r||i.push(o(i)+"scale("+n+","+r+")")}(i.scaleX,i.scaleY,a.scaleX,a.scaleY,s,c),i=a=null,function(e){for(var t,n=-1,r=c.length;++n<r;)s[(t=c[n]).i]=t.x(e);return s.join("")}}}var wt=vt((function(e){const t=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?gt:yt(t.a,t.b,t.c,t.d,t.e,t.f)}),"px, ","px)","deg)"),xt=vt((function(e){return null==e?gt:(mt||(mt=document.createElementNS("http://www.w3.org/2000/svg","g")),mt.setAttribute("transform",e),(e=mt.transform.baseVal.consolidate())?yt((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):gt)}),", ",")",")");function bt(e,t){var n,r;return function(){var o=ut(this,e),i=o.tween;if(i!==n)for(var a=0,s=(r=n=i).length;a<s;++a)if(r[a].name===t){(r=r.slice()).splice(a,1);break}o.tween=r}}function Et(e,t,n){var r,o;if("function"!=typeof n)throw new Error;return function(){var i=ut(this,e),a=i.tween;if(a!==r){o=(r=a).slice();for(var s={name:t,value:n},c=0,l=o.length;c<l;++c)if(o[c].name===t){o[c]=s;break}c===l&&o.push(s)}i.tween=o}}function _t(e,t,n){var r=e._id;return e.each((function(){var e=ut(this,r);(e.value||(e.value={}))[t]=n.apply(this,arguments)})),function(e){return dt(e,r).value[t]}}function kt(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Nt(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function St(){}var Mt=.7,Ct=1/Mt,At="\\s*([+-]?\\d+)\\s*",Ot="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",It="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Tt=/^#([0-9a-f]{3,8})$/,zt=new RegExp(`^rgb\\(${At},${At},${At}\\)$`),Pt=new RegExp(`^rgb\\(${It},${It},${It}\\)$`),$t=new RegExp(`^rgba\\(${At},${At},${At},${Ot}\\)$`),Lt=new RegExp(`^rgba\\(${It},${It},${It},${Ot}\\)$`),jt=new RegExp(`^hsl\\(${Ot},${It},${It}\\)$`),Rt=new RegExp(`^hsla\\(${Ot},${It},${It},${Ot}\\)$`),Dt={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Ht(){return this.rgb().formatHex()}function Bt(){return this.rgb().formatRgb()}function Vt(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Tt.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?Ft(t):3===n?new Gt(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?Yt(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?Yt(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=zt.exec(e))?new Gt(t[1],t[2],t[3],1):(t=Pt.exec(e))?new Gt(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=$t.exec(e))?Yt(t[1],t[2],t[3],t[4]):(t=Lt.exec(e))?Yt(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=jt.exec(e))?Jt(t[1],t[2]/100,t[3]/100,1):(t=Rt.exec(e))?Jt(t[1],t[2]/100,t[3]/100,t[4]):Dt.hasOwnProperty(e)?Ft(Dt[e]):"transparent"===e?new Gt(NaN,NaN,NaN,0):null}function Ft(e){return new Gt(e>>16&255,e>>8&255,255&e,1)}function Yt(e,t,n,r){return r<=0&&(e=t=n=NaN),new Gt(e,t,n,r)}function Xt(e,t,n,r){return 1===arguments.length?((o=e)instanceof St||(o=Vt(o)),o?new Gt((o=o.rgb()).r,o.g,o.b,o.opacity):new Gt):new Gt(e,t,n,null==r?1:r);var o}function Gt(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function qt(){return`#${Kt(this.r)}${Kt(this.g)}${Kt(this.b)}`}function Wt(){const e=Ut(this.opacity);return`${1===e?"rgb(":"rgba("}${Zt(this.r)}, ${Zt(this.g)}, ${Zt(this.b)}${1===e?")":`, ${e})`}`}function Ut(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Zt(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Kt(e){return((e=Zt(e))<16?"0":"")+e.toString(16)}function Jt(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new en(e,t,n,r)}function Qt(e){if(e instanceof en)return new en(e.h,e.s,e.l,e.opacity);if(e instanceof St||(e=Vt(e)),!e)return new en;if(e instanceof en)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,o=Math.min(t,n,r),i=Math.max(t,n,r),a=NaN,s=i-o,c=(i+o)/2;return s?(a=t===i?(n-r)/s+6*(n<r):n===i?(r-t)/s+2:(t-n)/s+4,s/=c<.5?i+o:2-i-o,a*=60):s=c>0&&c<1?0:a,new en(a,s,c,e.opacity)}function en(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function tn(e){return(e=(e||0)%360)<0?e+360:e}function nn(e){return Math.max(0,Math.min(1,e||0))}function rn(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function on(e,t,n,r,o){var i=e*e,a=i*e;return((1-3*e+3*i-a)*t+(4-6*i+3*a)*n+(1+3*e+3*i-3*a)*r+a*o)/6}kt(St,Vt,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Ht,formatHex:Ht,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return Qt(this).formatHsl()},formatRgb:Bt,toString:Bt}),kt(Gt,Xt,Nt(St,{brighter(e){return e=null==e?Ct:Math.pow(Ct,e),new Gt(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?Mt:Math.pow(Mt,e),new Gt(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Gt(Zt(this.r),Zt(this.g),Zt(this.b),Ut(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:qt,formatHex:qt,formatHex8:function(){return`#${Kt(this.r)}${Kt(this.g)}${Kt(this.b)}${Kt(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:Wt,toString:Wt})),kt(en,(function(e,t,n,r){return 1===arguments.length?Qt(e):new en(e,t,n,null==r?1:r)}),Nt(St,{brighter(e){return e=null==e?Ct:Math.pow(Ct,e),new en(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?Mt:Math.pow(Mt,e),new en(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,o=2*n-r;return new Gt(rn(e>=240?e-240:e+120,o,r),rn(e,o,r),rn(e<120?e+240:e-120,o,r),this.opacity)},clamp(){return new en(tn(this.h),nn(this.s),nn(this.l),Ut(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Ut(this.opacity);return`${1===e?"hsl(":"hsla("}${tn(this.h)}, ${100*nn(this.s)}%, ${100*nn(this.l)}%${1===e?")":`, ${e})`}`}}));var an=e=>()=>e;function sn(e,t){return function(n){return e+n*t}}function cn(e){return 1==(e=+e)?ln:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):an(isNaN(t)?n:t)}}function ln(e,t){var n=t-e;return n?sn(e,n):an(isNaN(e)?t:e)}var un=function e(t){var n=cn(t);function r(e,t){var r=n((e=Xt(e)).r,(t=Xt(t)).r),o=n(e.g,t.g),i=n(e.b,t.b),a=ln(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=o(t),e.b=i(t),e.opacity=a(t),e+""}}return r.gamma=e,r}(1);function dn(e){return function(t){var n,r,o=t.length,i=new Array(o),a=new Array(o),s=new Array(o);for(n=0;n<o;++n)r=Xt(t[n]),i[n]=r.r||0,a[n]=r.g||0,s[n]=r.b||0;return i=e(i),a=e(a),s=e(s),r.opacity=1,function(e){return r.r=i(e),r.g=a(e),r.b=s(e),r+""}}}dn((function(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),o=e[r],i=e[r+1],a=r>0?e[r-1]:2*o-i,s=r<t-1?e[r+2]:2*i-o;return on((n-r/t)*t,a,o,i,s)}})),dn((function(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),o=e[(r+t-1)%t],i=e[r%t],a=e[(r+1)%t],s=e[(r+2)%t];return on((n-r/t)*t,o,i,a,s)}}));var hn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,fn=new RegExp(hn.source,"g");function mn(e,t){var n,r,o,i=hn.lastIndex=fn.lastIndex=0,a=-1,s=[],c=[];for(e+="",t+="";(n=hn.exec(e))&&(r=fn.exec(t));)(o=r.index)>i&&(o=t.slice(i,o),s[a]?s[a]+=o:s[++a]=o),(n=n[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,c.push({i:a,x:ft(n,r)})),i=fn.lastIndex;return i<t.length&&(o=t.slice(i),s[a]?s[a]+=o:s[++a]=o),s.length<2?c[0]?function(e){return function(t){return e(t)+""}}(c[0].x):function(e){return function(){return e}}(t):(t=c.length,function(e){for(var n,r=0;r<t;++r)s[(n=c[r]).i]=n.x(e);return s.join("")})}function pn(e,t){var n;return("number"==typeof t?ft:t instanceof Vt?un:(n=Vt(t))?(t=n,un):mn)(e,t)}function gn(e){return function(){this.removeAttribute(e)}}function yn(e){return function(){this.removeAttributeNS(e.space,e.local)}}function vn(e,t,n){var r,o,i=n+"";return function(){var a=this.getAttribute(e);return a===i?null:a===r?o:o=t(r=a,n)}}function wn(e,t,n){var r,o,i=n+"";return function(){var a=this.getAttributeNS(e.space,e.local);return a===i?null:a===r?o:o=t(r=a,n)}}function xn(e,t,n){var r,o,i;return function(){var a,s,c=n(this);if(null!=c)return(a=this.getAttribute(e))===(s=c+"")?null:a===r&&s===o?i:(o=s,i=t(r=a,c));this.removeAttribute(e)}}function bn(e,t,n){var r,o,i;return function(){var a,s,c=n(this);if(null!=c)return(a=this.getAttributeNS(e.space,e.local))===(s=c+"")?null:a===r&&s===o?i:(o=s,i=t(r=a,c));this.removeAttributeNS(e.space,e.local)}}function En(e,t){var n,r;function o(){var o=t.apply(this,arguments);return o!==r&&(n=(r=o)&&function(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}(e,o)),n}return o._value=t,o}function _n(e,t){var n,r;function o(){var o=t.apply(this,arguments);return o!==r&&(n=(r=o)&&function(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}(e,o)),n}return o._value=t,o}function kn(e,t){return function(){lt(this,e).delay=+t.apply(this,arguments)}}function Nn(e,t){return t=+t,function(){lt(this,e).delay=t}}function Sn(e,t){return function(){ut(this,e).duration=+t.apply(this,arguments)}}function Mn(e,t){return t=+t,function(){ut(this,e).duration=t}}var Cn=be.prototype.constructor;function An(e){return function(){this.style.removeProperty(e)}}var On=0;function In(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function Tn(){return++On}var zn=be.prototype;In.prototype=function(e){return be().transition(e)}.prototype={constructor:In,select:function(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=u(e));for(var r=this._groups,o=r.length,i=new Array(o),a=0;a<o;++a)for(var s,c,l=r[a],d=l.length,h=i[a]=new Array(d),f=0;f<d;++f)(s=l[f])&&(c=e.call(s,s.__data__,f,l))&&("__data__"in s&&(c.__data__=s.__data__),h[f]=c,ct(h[f],t,n,f,h,dt(s,n)));return new In(i,this._parents,t,n)},selectAll:function(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=h(e));for(var r=this._groups,o=r.length,i=[],a=[],s=0;s<o;++s)for(var c,l=r[s],u=l.length,d=0;d<u;++d)if(c=l[d]){for(var f,m=e.call(c,c.__data__,d,l),p=dt(c,n),g=0,y=m.length;g<y;++g)(f=m[g])&&ct(f,t,n,g,m,p);i.push(m),a.push(c)}return new In(i,a,t,n)},selectChild:zn.selectChild,selectChildren:zn.selectChildren,filter:function(e){"function"!=typeof e&&(e=m(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var i,a=t[o],s=a.length,c=r[o]=[],l=0;l<s;++l)(i=a[l])&&e.call(i,i.__data__,l,a)&&c.push(i);return new In(r,this._parents,this._name,this._id)},merge:function(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,o=n.length,i=Math.min(r,o),a=new Array(r),s=0;s<i;++s)for(var c,l=t[s],u=n[s],d=l.length,h=a[s]=new Array(d),f=0;f<d;++f)(c=l[f]||u[f])&&(h[f]=c);for(;s<r;++s)a[s]=t[s];return new In(a,this._parents,this._name,this._id)},selection:function(){return new Cn(this._groups,this._parents)},transition:function(){for(var e=this._name,t=this._id,n=Tn(),r=this._groups,o=r.length,i=0;i<o;++i)for(var a,s=r[i],c=s.length,l=0;l<c;++l)if(a=s[l]){var u=dt(a,t);ct(a,e,n,l,s,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new In(r,this._parents,e,n)},call:zn.call,nodes:zn.nodes,node:zn.node,size:zn.size,empty:zn.empty,each:zn.each,on:function(e,t){var n=this._id;return arguments.length<2?dt(this.node(),n).on.on(e):this.each(function(e,t,n){var r,o,i=function(e){return(e+"").trim().split(/^|\s+/).every((function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||"start"===e}))}(t)?lt:ut;return function(){var a=i(this,e),s=a.on;s!==r&&(o=(r=s).copy()).on(t,n),a.on=o}}(n,e,t))},attr:function(e,t){var n=A(e),r="transform"===n?xt:pn;return this.attrTween(e,"function"==typeof t?(n.local?bn:xn)(n,r,_t(this,"attr."+e,t)):null==t?(n.local?yn:gn)(n):(n.local?wn:vn)(n,r,t))},attrTween:function(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!=typeof t)throw new Error;var r=A(e);return this.tween(n,(r.local?En:_n)(r,t))},style:function(e,t,n){var r="transform"==(e+="")?wt:pn;return null==t?this.styleTween(e,function(e,t){var n,r,o;return function(){var i=H(this,e),a=(this.style.removeProperty(e),H(this,e));return i===a?null:i===n&&a===r?o:o=t(n=i,r=a)}}(e,r)).on("end.style."+e,An(e)):"function"==typeof t?this.styleTween(e,function(e,t,n){var r,o,i;return function(){var a=H(this,e),s=n(this),c=s+"";return null==s&&(this.style.removeProperty(e),c=s=H(this,e)),a===c?null:a===r&&c===o?i:(o=c,i=t(r=a,s))}}(e,r,_t(this,"style."+e,t))).each(function(e,t){var n,r,o,i,a="style."+t,s="end."+a;return function(){var c=ut(this,e),l=c.on,u=null==c.value[a]?i||(i=An(t)):void 0;l===n&&o===u||(r=(n=l).copy()).on(s,o=u),c.on=r}}(this._id,e)):this.styleTween(e,function(e,t,n){var r,o,i=n+"";return function(){var a=H(this,e);return a===i?null:a===r?o:o=t(r=a,n)}}(e,r,t),n).on("end.style."+e,null)},styleTween:function(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==t)return this.tween(r,null);if("function"!=typeof t)throw new Error;return this.tween(r,function(e,t,n){var r,o;function i(){var i=t.apply(this,arguments);return i!==o&&(r=(o=i)&&function(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}(e,i,n)),r}return i._value=t,i}(e,t,null==n?"":n))},text:function(e){return this.tween("text","function"==typeof e?function(e){return function(){var t=e(this);this.textContent=null==t?"":t}}(_t(this,"text",e)):function(e){return function(){this.textContent=e}}(null==e?"":e+""))},textTween:function(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(null==e)return this.tween(t,null);if("function"!=typeof e)throw new Error;return this.tween(t,function(e){var t,n;function r(){var r=e.apply(this,arguments);return r!==n&&(t=(n=r)&&function(e){return function(t){this.textContent=e.call(this,t)}}(r)),t}return r._value=e,r}(e))},remove:function(){return this.on("end.remove",function(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}(this._id))},tween:function(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r,o=dt(this.node(),n).tween,i=0,a=o.length;i<a;++i)if((r=o[i]).name===e)return r.value;return null}return this.each((null==t?bt:Et)(n,e,t))},delay:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?kn:Nn)(t,e)):dt(this.node(),t).delay},duration:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?Sn:Mn)(t,e)):dt(this.node(),t).duration},ease:function(e){var t=this._id;return arguments.length?this.each(function(e,t){if("function"!=typeof t)throw new Error;return function(){ut(this,e).ease=t}}(t,e)):dt(this.node(),t).ease},easeVarying:function(e){if("function"!=typeof e)throw new Error;return this.each(function(e,t){return function(){var n=t.apply(this,arguments);if("function"!=typeof n)throw new Error;ut(this,e).ease=n}}(this._id,e))},end:function(){var e,t,n=this,r=n._id,o=n.size();return new Promise((function(i,a){var s={value:a},c={value:function(){0==--o&&i()}};n.each((function(){var n=ut(this,r),o=n.on;o!==e&&((t=(e=o).copy())._.cancel.push(s),t._.interrupt.push(s),t._.end.push(c)),n.on=t})),0===o&&i()}))},[Symbol.iterator]:zn[Symbol.iterator]};var Pn={time:null,delay:0,duration:250,ease:function(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}};function $n(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}be.prototype.interrupt=function(e){return this.each((function(){ht(this,e)}))},be.prototype.transition=function(e){var t,n;e instanceof In?(t=e._id,e=e._name):(t=Tn(),(n=Pn).time=Ue(),e=null==e?null:e+"");for(var r=this._groups,o=r.length,i=0;i<o;++i)for(var a,s=r[i],c=s.length,l=0;l<c;++l)(a=s[l])&&ct(a,e,t,l,s,n||$n(a,t));return new In(r,this._parents,e,t)};var Ln=e=>()=>e;function jn(e,{sourceEvent:t,target:n,transform:r,dispatch:o}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:o}})}function Rn(e,t,n){this.k=e,this.x=t,this.y=n}Rn.prototype={constructor:Rn,scale:function(e){return 1===e?this:new Rn(this.k*e,this.x,this.y)},translate:function(e,t){return 0===e&0===t?this:new Rn(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Dn=new Rn(1,0,0);function Hn(e){for(;!e.__zoom;)if(!(e=e.parentNode))return Dn;return e.__zoom}function Bn(e){e.stopImmediatePropagation()}function Vn(e){e.preventDefault(),e.stopImmediatePropagation()}function Fn(e){return!(e.ctrlKey&&"wheel"!==e.type||e.button)}function Yn(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e).hasAttribute("viewBox")?[[(e=e.viewBox.baseVal).x,e.y],[e.x+e.width,e.y+e.height]]:[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]:[[0,0],[e.clientWidth,e.clientHeight]]}function Xn(){return this.__zoom||Dn}function Gn(e){return-e.deltaY*(1===e.deltaMode?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function qn(){return navigator.maxTouchPoints||"ontouchstart"in this}function Wn(e,t,n){var r=e.invertX(t[0][0])-n[0][0],o=e.invertX(t[1][0])-n[1][0],i=e.invertY(t[0][1])-n[0][1],a=e.invertY(t[1][1])-n[1][1];return e.translate(o>r?(r+o)/2:Math.min(0,r)||Math.max(0,o),a>i?(i+a)/2:Math.min(0,i)||Math.max(0,a))}function Un(){var e,t,n,r=Fn,o=Yn,i=Wn,a=Gn,s=qn,l=[0,1/0],u=[[-1/0,-1/0],[1/0,1/0]],d=250,h=He,f=c("start","zoom","end"),m=0,p=10;function g(e){e.property("__zoom",Xn).on("wheel.zoom",_,{passive:!1}).on("mousedown.zoom",k).on("dblclick.zoom",N).filter(s).on("touchstart.zoom",S).on("touchmove.zoom",M).on("touchend.zoom touchcancel.zoom",C).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function y(e,t){return(t=Math.max(l[0],Math.min(l[1],t)))===e.k?e:new Rn(t,e.x,e.y)}function v(e,t,n){var r=t[0]-n[0]*e.k,o=t[1]-n[1]*e.k;return r===e.x&&o===e.y?e:new Rn(e.k,r,o)}function w(e){return[(+e[0][0]+ +e[1][0])/2,(+e[0][1]+ +e[1][1])/2]}function x(e,t,n,r){e.on("start.zoom",(function(){b(this,arguments).event(r).start()})).on("interrupt.zoom end.zoom",(function(){b(this,arguments).event(r).end()})).tween("zoom",(function(){var e=this,i=arguments,a=b(e,i).event(r),s=o.apply(e,i),c=null==n?w(s):"function"==typeof n?n.apply(e,i):n,l=Math.max(s[1][0]-s[0][0],s[1][1]-s[0][1]),u=e.__zoom,d="function"==typeof t?t.apply(e,i):t,f=h(u.invert(c).concat(l/u.k),d.invert(c).concat(l/d.k));return function(e){if(1===e)e=d;else{var t=f(e),n=l/t[2];e=new Rn(n,c[0]-t[0]*n,c[1]-t[1]*n)}a.zoom(null,e)}}))}function b(e,t,n){return!n&&e.__zooming||new E(e,t)}function E(e,t){this.that=e,this.args=t,this.active=0,this.sourceEvent=null,this.extent=o.apply(e,t),this.taps=0}function _(e,...t){if(r.apply(this,arguments)){var n=b(this,t).event(e),o=this.__zoom,s=Math.max(l[0],Math.min(l[1],o.k*Math.pow(2,a.apply(this,arguments)))),c=_e(e);if(n.wheel)n.mouse[0][0]===c[0]&&n.mouse[0][1]===c[1]||(n.mouse[1]=o.invert(n.mouse[0]=c)),clearTimeout(n.wheel);else{if(o.k===s)return;n.mouse=[c,o.invert(c)],ht(this),n.start()}Vn(e),n.wheel=setTimeout((function(){n.wheel=null,n.end()}),150),n.zoom("mouse",i(v(y(o,s),n.mouse[0],n.mouse[1]),n.extent,u))}}function k(e,...t){if(!n&&r.apply(this,arguments)){var o=e.currentTarget,a=b(this,t,!0).event(e),s=Ee(e.view).on("mousemove.zoom",(function(e){if(Vn(e),!a.moved){var t=e.clientX-l,n=e.clientY-d;a.moved=t*t+n*n>m}a.event(e).zoom("mouse",i(v(a.that.__zoom,a.mouse[0]=_e(e,o),a.mouse[1]),a.extent,u))}),!0).on("mouseup.zoom",(function(e){s.on("mousemove.zoom mouseup.zoom",null),Ae(e.view,a.moved),Vn(e),a.event(e).end()}),!0),c=_e(e,o),l=e.clientX,d=e.clientY;Ce(e.view),Bn(e),a.mouse=[c,this.__zoom.invert(c)],ht(this),a.start()}}function N(e,...t){if(r.apply(this,arguments)){var n=this.__zoom,a=_e(e.changedTouches?e.changedTouches[0]:e,this),s=n.invert(a),c=n.k*(e.shiftKey?.5:2),l=i(v(y(n,c),a,s),o.apply(this,t),u);Vn(e),d>0?Ee(this).transition().duration(d).call(x,l,a,e):Ee(this).call(g.transform,l,a,e)}}function S(n,...o){if(r.apply(this,arguments)){var i,a,s,c,l=n.touches,u=l.length,d=b(this,o,n.changedTouches.length===u).event(n);for(Bn(n),a=0;a<u;++a)c=[c=_e(s=l[a],this),this.__zoom.invert(c),s.identifier],d.touch0?d.touch1||d.touch0[2]===c[2]||(d.touch1=c,d.taps=0):(d.touch0=c,i=!0,d.taps=1+!!e);e&&(e=clearTimeout(e)),i&&(d.taps<2&&(t=c[0],e=setTimeout((function(){e=null}),500)),ht(this),d.start())}}function M(e,...t){if(this.__zooming){var n,r,o,a,s=b(this,t).event(e),c=e.changedTouches,l=c.length;for(Vn(e),n=0;n<l;++n)o=_e(r=c[n],this),s.touch0&&s.touch0[2]===r.identifier?s.touch0[0]=o:s.touch1&&s.touch1[2]===r.identifier&&(s.touch1[0]=o);if(r=s.that.__zoom,s.touch1){var d=s.touch0[0],h=s.touch0[1],f=s.touch1[0],m=s.touch1[1],p=(p=f[0]-d[0])*p+(p=f[1]-d[1])*p,g=(g=m[0]-h[0])*g+(g=m[1]-h[1])*g;r=y(r,Math.sqrt(p/g)),o=[(d[0]+f[0])/2,(d[1]+f[1])/2],a=[(h[0]+m[0])/2,(h[1]+m[1])/2]}else{if(!s.touch0)return;o=s.touch0[0],a=s.touch0[1]}s.zoom("touch",i(v(r,o,a),s.extent,u))}}function C(e,...r){if(this.__zooming){var o,i,a=b(this,r).event(e),s=e.changedTouches,c=s.length;for(Bn(e),n&&clearTimeout(n),n=setTimeout((function(){n=null}),500),o=0;o<c;++o)i=s[o],a.touch0&&a.touch0[2]===i.identifier?delete a.touch0:a.touch1&&a.touch1[2]===i.identifier&&delete a.touch1;if(a.touch1&&!a.touch0&&(a.touch0=a.touch1,delete a.touch1),a.touch0)a.touch0[1]=this.__zoom.invert(a.touch0[0]);else if(a.end(),2===a.taps&&(i=_e(i,this),Math.hypot(t[0]-i[0],t[1]-i[1])<p)){var l=Ee(this).on("dblclick.zoom");l&&l.apply(this,arguments)}}}return g.transform=function(e,t,n,r){var o=e.selection?e.selection():e;o.property("__zoom",Xn),e!==o?x(e,t,n,r):o.interrupt().each((function(){b(this,arguments).event(r).start().zoom(null,"function"==typeof t?t.apply(this,arguments):t).end()}))},g.scaleBy=function(e,t,n,r){g.scaleTo(e,(function(){return this.__zoom.k*("function"==typeof t?t.apply(this,arguments):t)}),n,r)},g.scaleTo=function(e,t,n,r){g.transform(e,(function(){var e=o.apply(this,arguments),r=this.__zoom,a=null==n?w(e):"function"==typeof n?n.apply(this,arguments):n,s=r.invert(a),c="function"==typeof t?t.apply(this,arguments):t;return i(v(y(r,c),a,s),e,u)}),n,r)},g.translateBy=function(e,t,n,r){g.transform(e,(function(){return i(this.__zoom.translate("function"==typeof t?t.apply(this,arguments):t,"function"==typeof n?n.apply(this,arguments):n),o.apply(this,arguments),u)}),null,r)},g.translateTo=function(e,t,n,r,a){g.transform(e,(function(){var e=o.apply(this,arguments),a=this.__zoom,s=null==r?w(e):"function"==typeof r?r.apply(this,arguments):r;return i(Dn.translate(s[0],s[1]).scale(a.k).translate("function"==typeof t?-t.apply(this,arguments):-t,"function"==typeof n?-n.apply(this,arguments):-n),e,u)}),r,a)},E.prototype={event:function(e){return e&&(this.sourceEvent=e),this},start:function(){return 1==++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(e,t){return this.mouse&&"mouse"!==e&&(this.mouse[1]=t.invert(this.mouse[0])),this.touch0&&"touch"!==e&&(this.touch0[1]=t.invert(this.touch0[0])),this.touch1&&"touch"!==e&&(this.touch1[1]=t.invert(this.touch1[0])),this.that.__zoom=t,this.emit("zoom"),this},end:function(){return 0==--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(e){var t=Ee(this.that).datum();f.call(e,this.that,new jn(e,{sourceEvent:this.sourceEvent,target:g,type:e,transform:this.that.__zoom,dispatch:f}),t)}},g.wheelDelta=function(e){return arguments.length?(a="function"==typeof e?e:Ln(+e),g):a},g.filter=function(e){return arguments.length?(r="function"==typeof e?e:Ln(!!e),g):r},g.touchable=function(e){return arguments.length?(s="function"==typeof e?e:Ln(!!e),g):s},g.extent=function(e){return arguments.length?(o="function"==typeof e?e:Ln([[+e[0][0],+e[0][1]],[+e[1][0],+e[1][1]]]),g):o},g.scaleExtent=function(e){return arguments.length?(l[0]=+e[0],l[1]=+e[1],g):[l[0],l[1]]},g.translateExtent=function(e){return arguments.length?(u[0][0]=+e[0][0],u[1][0]=+e[1][0],u[0][1]=+e[0][1],u[1][1]=+e[1][1],g):[[u[0][0],u[0][1]],[u[1][0],u[1][1]]]},g.constrain=function(e){return arguments.length?(i=e,g):i},g.duration=function(e){return arguments.length?(d=+e,g):d},g.interpolate=function(e){return arguments.length?(h=e,g):h},g.on=function(){var e=f.on.apply(f,arguments);return e===f?g:e},g.clickDistance=function(e){return arguments.length?(m=(e=+e)*e,g):Math.sqrt(m)},g.tapDistance=function(e){return arguments.length?(p=+e,g):p},g}Hn.prototype=Rn.prototype;const Zn={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,{id:t,sourceHandle:n,targetHandle:r})=>`Couldn't create edge for ${e} handle id: "${"source"===e?n:r}", edge id: ${t}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(e="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},Kn=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],Jn=["Enter"," ","Escape"];var Qn,er,tr;!function(e){e.Strict="strict",e.Loose="loose"}(Qn||(Qn={})),function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"}(er||(er={})),function(e){e.Partial="partial",e.Full="full"}(tr||(tr={}));const nr={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null};var rr,or,ir;!function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"}(rr||(rr={})),function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"}(or||(or={})),function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"}(ir||(ir={}));const ar={[ir.Left]:ir.Right,[ir.Right]:ir.Left,[ir.Top]:ir.Bottom,[ir.Bottom]:ir.Top};function sr(e){return null===e?null:e?"valid":"invalid"}const cr=e=>"id"in e&&"source"in e&&"target"in e,lr=e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e),ur=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e),dr=(e,t=[0,0])=>{const{width:n,height:r}=Br(e),o=e.origin??t,i=n*o[0],a=r*o[1];return{x:e.position.x-i,y:e.position.y-a}},hr=(e,t={nodeOrigin:[0,0],nodeLookup:void 0})=>{if(0===e.length)return{x:0,y:0,width:0,height:0};const n=e.reduce(((e,n)=>{const r="string"==typeof n;let o=t.nodeLookup||r?void 0:n;t.nodeLookup&&(o=r?t.nodeLookup.get(n):ur(n)?n:t.nodeLookup.get(n.id));const i=o?Ar(o,t.nodeOrigin):{x:0,y:0,x2:0,y2:0};return Nr(e,i)}),{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return Mr(n)},fr=(e,t={})=>{if(0===e.size)return{x:0,y:0,width:0,height:0};let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0};return e.forEach((e=>{if(void 0===t.filter||t.filter(e)){const t=Ar(e);n=Nr(n,t)}})),Mr(n)},mr=(e,t,[n,r,o]=[0,0,1],i=!1,a=!1)=>{const s={...Lr(t,[n,r,o]),width:t.width/o,height:t.height/o},c=[];for(const l of e.values()){const{measured:e,selectable:t=!0,hidden:n=!1}=l;if(a&&!t||n)continue;const r=e.width??l.width??l.initialWidth??null,o=e.height??l.height??l.initialHeight??null,u=Ir(s,Cr(l)),d=(r??0)*(o??0),h=i&&u>0;(!l.internals.handleBounds||h||u>=d||l.dragging)&&c.push(l)}return c},pr=(e,t)=>{const n=new Set;return e.forEach((e=>{n.add(e.id)})),t.filter((e=>n.has(e.source)||n.has(e.target)))};function gr(e,t){const n=new Map,r=t?.nodes?new Set(t.nodes.map((e=>e.id))):null;return e.forEach((e=>{!(e.measured.width&&e.measured.height&&(t?.includeHiddenNodes||!e.hidden))||r&&!r.has(e.id)||n.set(e.id,e)})),n}async function yr({nodes:e,width:t,height:n,panZoom:r,minZoom:o,maxZoom:i},a){if(0===e.size)return Promise.resolve(!1);const s=fr(e),c=Rr(s,t,n,a?.minZoom??o,a?.maxZoom??i,a?.padding??.1);return await r.setViewport(c,{duration:a?.duration}),Promise.resolve(!0)}function vr({nodeId:e,nextPosition:t,nodeLookup:n,nodeOrigin:r=[0,0],nodeExtent:o,onError:i}){const a=n.get(e),s=a.parentId?n.get(a.parentId):void 0,{x:c,y:l}=s?s.internals.positionAbsolute:{x:0,y:0},u=a.origin??r;let d=o;if("parent"!==a.extent||a.expandParent)s&&Hr(a.extent)&&(d=[[a.extent[0][0]+c,a.extent[0][1]+l],[a.extent[1][0]+c,a.extent[1][1]+l]]);else if(s){const e=s.measured.width,t=s.measured.height;e&&t&&(d=[[c,l],[c+e,l+t]])}else i?.("005",Zn.error005());const h=Hr(d)?br(t,d,a.measured):t;return void 0!==a.measured.width&&void 0!==a.measured.height||i?.("015",Zn.error015()),{position:{x:h.x-c+(a.measured.width??0)*u[0],y:h.y-l+(a.measured.height??0)*u[1]},positionAbsolute:h}}async function wr({nodesToRemove:e=[],edgesToRemove:t=[],nodes:n,edges:r,onBeforeDelete:o}){const i=new Set(e.map((e=>e.id))),a=[];for(const d of n){if(!1===d.deletable)continue;const e=i.has(d.id),t=!e&&d.parentId&&a.find((e=>e.id===d.parentId));(e||t)&&a.push(d)}const s=new Set(t.map((e=>e.id))),c=r.filter((e=>!1!==e.deletable)),l=pr(a,c);for(const d of c){s.has(d.id)&&!l.find((e=>e.id===d.id))&&l.push(d)}if(!o)return{edges:l,nodes:a};const u=await o({nodes:a,edges:l});return"boolean"==typeof u?u?{edges:l,nodes:a}:{edges:[],nodes:[]}:u}const xr=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),br=(e={x:0,y:0},t,n)=>({x:xr(e.x,t[0][0],t[1][0]-(n?.width??0)),y:xr(e.y,t[0][1],t[1][1]-(n?.height??0))});function Er(e,t,n){const{width:r,height:o}=Br(n),{x:i,y:a}=n.internals.positionAbsolute;return br(e,[[i,a],[i+r,a+o]],t)}const _r=(e,t,n)=>e<t?xr(Math.abs(e-t),1,t)/t:e>n?-xr(Math.abs(e-n),1,t)/t:0,kr=(e,t,n=15,r=40)=>[_r(e.x,r,t.width-r)*n,_r(e.y,r,t.height-r)*n],Nr=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),Sr=({x:e,y:t,width:n,height:r})=>({x:e,y:t,x2:e+n,y2:t+r}),Mr=({x:e,y:t,x2:n,y2:r})=>({x:e,y:t,width:n-e,height:r-t}),Cr=(e,t=[0,0])=>{const{x:n,y:r}=ur(e)?e.internals.positionAbsolute:dr(e,t);return{x:n,y:r,width:e.measured?.width??e.width??e.initialWidth??0,height:e.measured?.height??e.height??e.initialHeight??0}},Ar=(e,t=[0,0])=>{const{x:n,y:r}=ur(e)?e.internals.positionAbsolute:dr(e,t);return{x:n,y:r,x2:n+(e.measured?.width??e.width??e.initialWidth??0),y2:r+(e.measured?.height??e.height??e.initialHeight??0)}},Or=(e,t)=>Mr(Nr(Sr(e),Sr(t))),Ir=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),r=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*r)},Tr=e=>zr(e.width)&&zr(e.height)&&zr(e.x)&&zr(e.y),zr=e=>!isNaN(e)&&isFinite(e),Pr=(e,t)=>{0},$r=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),Lr=({x:e,y:t},[n,r,o],i=!1,a=[1,1])=>{const s={x:(e-n)/o,y:(t-r)/o};return i?$r(s,a):s},jr=({x:e,y:t},[n,r,o])=>({x:e*o+n,y:t*o+r}),Rr=(e,t,n,r,o,i)=>{const a=t/(e.width*(1+i)),s=n/(e.height*(1+i)),c=Math.min(a,s),l=xr(c,r,o);return{x:t/2-(e.x+e.width/2)*l,y:n/2-(e.y+e.height/2)*l,zoom:l}},Dr=()=>"undefined"!=typeof navigator&&navigator?.userAgent?.indexOf("Mac")>=0;function Hr(e){return void 0!==e&&"parent"!==e}function Br(e){return{width:e.measured?.width??e.width??e.initialWidth??0,height:e.measured?.height??e.height??e.initialHeight??0}}function Vr(e){return void 0!==(e.measured?.width??e.width??e.initialWidth)&&void 0!==(e.measured?.height??e.height??e.initialHeight)}function Fr(e,t={width:0,height:0},n,r,o){const i={...e},a=r.get(n);if(a){const e=a.origin||o;i.x+=a.internals.positionAbsolute.x-(t.width??0)*e[0],i.y+=a.internals.positionAbsolute.y-(t.height??0)*e[1]}return i}function Yr(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function Xr(e,{snapGrid:t=[0,0],snapToGrid:n=!1,transform:r,containerBounds:o}){const{x:i,y:a}=Kr(e),s=Lr({x:i-(o?.left??0),y:a-(o?.top??0)},r),{x:c,y:l}=n?$r(s,t):s;return{xSnapped:c,ySnapped:l,...s}}const Gr=e=>({width:e.offsetWidth,height:e.offsetHeight}),qr=e=>e?.getRootNode?.()||window?.document,Wr=["INPUT","SELECT","TEXTAREA"];function Ur(e){const t=e.composedPath?.()?.[0]||e.target;if(1!==t?.nodeType)return!1;return Wr.includes(t.nodeName)||t.hasAttribute("contenteditable")||!!t.closest(".nokey")}const Zr=e=>"clientX"in e,Kr=(e,t)=>{const n=Zr(e),r=n?e.clientX:e.touches?.[0].clientX,o=n?e.clientY:e.touches?.[0].clientY;return{x:r-(t?.left??0),y:o-(t?.top??0)}},Jr=(e,t,n,r,o)=>{const i=t.querySelectorAll(`.${e}`);return i&&i.length?Array.from(i).map((t=>{const i=t.getBoundingClientRect();return{id:t.getAttribute("data-handleid"),type:e,nodeId:o,position:t.getAttribute("data-handlepos"),x:(i.left-n.left)/r,y:(i.top-n.top)/r,...Gr(t)}})):null};function Qr({sourceX:e,sourceY:t,targetX:n,targetY:r,sourceControlX:o,sourceControlY:i,targetControlX:a,targetControlY:s}){const c=.125*e+.375*o+.375*a+.125*n,l=.125*t+.375*i+.375*s+.125*r;return[c,l,Math.abs(c-e),Math.abs(l-t)]}function eo(e,t){return e>=0?.5*e:25*t*Math.sqrt(-e)}function to({pos:e,x1:t,y1:n,x2:r,y2:o,c:i}){switch(e){case ir.Left:return[t-eo(t-r,i),n];case ir.Right:return[t+eo(r-t,i),n];case ir.Top:return[t,n-eo(n-o,i)];case ir.Bottom:return[t,n+eo(o-n,i)]}}function no({sourceX:e,sourceY:t,sourcePosition:n=ir.Bottom,targetX:r,targetY:o,targetPosition:i=ir.Top,curvature:a=.25}){const[s,c]=to({pos:n,x1:e,y1:t,x2:r,y2:o,c:a}),[l,u]=to({pos:i,x1:r,y1:o,x2:e,y2:t,c:a}),[d,h,f,m]=Qr({sourceX:e,sourceY:t,targetX:r,targetY:o,sourceControlX:s,sourceControlY:c,targetControlX:l,targetControlY:u});return[`M${e},${t} C${s},${c} ${l},${u} ${r},${o}`,d,h,f,m]}function ro({sourceX:e,sourceY:t,targetX:n,targetY:r}){const o=Math.abs(n-e)/2,i=n<e?n+o:n-o,a=Math.abs(r-t)/2;return[i,r<t?r+a:r-a,o,a]}function oo({sourceNode:e,targetNode:t,selected:n=!1,zIndex:r=0,elevateOnSelect:o=!1}){if(!o)return r;const i=n||t.selected||e.selected,a=Math.max(e.internals.z||0,t.internals.z||0,1e3);return r+(i?a:0)}function io({sourceNode:e,targetNode:t,width:n,height:r,transform:o}){const i=Nr(Ar(e),Ar(t));i.x===i.x2&&(i.x2+=1),i.y===i.y2&&(i.y2+=1);const a={x:-o[0]/o[2],y:-o[1]/o[2],width:n/o[2],height:r/o[2]};return Ir(a,Mr(i))>0}const ao=({source:e,sourceHandle:t,target:n,targetHandle:r})=>`xy-edge__${e}${t||""}-${n}${r||""}`,so=(e,t)=>{if(!e.source||!e.target)return Pr("006",Zn.error006()),t;let n;return n=cr(e)?{...e}:{...e,id:ao(e)},((e,t)=>t.some((t=>!(t.source!==e.source||t.target!==e.target||t.sourceHandle!==e.sourceHandle&&(t.sourceHandle||e.sourceHandle)||t.targetHandle!==e.targetHandle&&(t.targetHandle||e.targetHandle)))))(n,t)?t:(null===n.sourceHandle&&delete n.sourceHandle,null===n.targetHandle&&delete n.targetHandle,t.concat(n))};function co({sourceX:e,sourceY:t,targetX:n,targetY:r}){const[o,i,a,s]=ro({sourceX:e,sourceY:t,targetX:n,targetY:r});return[`M ${e},${t}L ${n},${r}`,o,i,a,s]}const lo={[ir.Left]:{x:-1,y:0},[ir.Right]:{x:1,y:0},[ir.Top]:{x:0,y:-1},[ir.Bottom]:{x:0,y:1}},uo=({source:e,sourcePosition:t=ir.Bottom,target:n})=>t===ir.Left||t===ir.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},ho=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function fo({sourceX:e,sourceY:t,sourcePosition:n=ir.Bottom,targetX:r,targetY:o,targetPosition:i=ir.Top,borderRadius:a=5,centerX:s,centerY:c,offset:l=20}){const[u,d,h,f,m]=function({source:e,sourcePosition:t=ir.Bottom,target:n,targetPosition:r=ir.Top,center:o,offset:i}){const a=lo[t],s=lo[r],c={x:e.x+a.x*i,y:e.y+a.y*i},l={x:n.x+s.x*i,y:n.y+s.y*i},u=uo({source:c,sourcePosition:t,target:l}),d=0!==u.x?"x":"y",h=u[d];let f,m,p=[];const g={x:0,y:0},y={x:0,y:0},[v,w,x,b]=ro({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(a[d]*s[d]==-1){f=o.x??v,m=o.y??w;const e=[{x:f,y:c.y},{x:f,y:l.y}],t=[{x:c.x,y:m},{x:l.x,y:m}];p=a[d]===h?"x"===d?e:t:"x"===d?t:e}else{const o=[{x:c.x,y:l.y}],u=[{x:l.x,y:c.y}];if(p="x"===d?a.x===h?u:o:a.y===h?o:u,t===r){const t=Math.abs(e[d]-n[d]);if(t<=i){const r=Math.min(i-1,i-t);a[d]===h?g[d]=(c[d]>e[d]?-1:1)*r:y[d]=(l[d]>n[d]?-1:1)*r}}if(t!==r){const e="x"===d?"y":"x",t=a[d]===s[e],n=c[e]>l[e],r=c[e]<l[e];(1===a[d]&&(!t&&n||t&&r)||1!==a[d]&&(!t&&r||t&&n))&&(p="x"===d?o:u)}const v={x:c.x+g.x,y:c.y+g.y},w={x:l.x+y.x,y:l.y+y.y};Math.max(Math.abs(v.x-p[0].x),Math.abs(w.x-p[0].x))>=Math.max(Math.abs(v.y-p[0].y),Math.abs(w.y-p[0].y))?(f=(v.x+w.x)/2,m=p[0].y):(f=p[0].x,m=(v.y+w.y)/2)}return[[e,{x:c.x+g.x,y:c.y+g.y},...p,{x:l.x+y.x,y:l.y+y.y},n],f,m,x,b]}({source:{x:e,y:t},sourcePosition:n,target:{x:r,y:o},targetPosition:i,center:{x:s,y:c},offset:l}),p=u.reduce(((e,t,n)=>{let r="";return r=n>0&&n<u.length-1?function(e,t,n,r){const o=Math.min(ho(e,t)/2,ho(t,n)/2,r),{x:i,y:a}=t;if(e.x===i&&i===n.x||e.y===a&&a===n.y)return`L${i} ${a}`;if(e.y===a)return`L ${i+o*(e.x<n.x?-1:1)},${a}Q ${i},${a} ${i},${a+o*(e.y<n.y?1:-1)}`;const s=e.x<n.x?1:-1;return`L ${i},${a+o*(e.y<n.y?-1:1)}Q ${i},${a} ${i+o*s},${a}`}(u[n-1],t,u[n+1],a):`${0===n?"M":"L"}${t.x} ${t.y}`,e+=r}),"");return[p,d,h,f,m]}function mo(e){return e&&!(!e.internals.handleBounds&&!e.handles?.length)&&!!(e.measured.width||e.width||e.initialWidth)}function po(e){const{sourceNode:t,targetNode:n}=e;if(!mo(t)||!mo(n))return null;const r=t.internals.handleBounds||go(t.handles),o=n.internals.handleBounds||go(n.handles),i=vo(r?.source??[],e.sourceHandle),a=vo(e.connectionMode===Qn.Strict?o?.target??[]:(o?.target??[]).concat(o?.source??[]),e.targetHandle);if(!i||!a)return e.onError?.("008",Zn.error008(i?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;const s=i?.position||ir.Bottom,c=a?.position||ir.Top,l=yo(t,i,s),u=yo(n,a,c);return{sourceX:l.x,sourceY:l.y,targetX:u.x,targetY:u.y,sourcePosition:s,targetPosition:c}}function go(e){if(!e)return null;const t=[],n=[];for(const r of e)r.width=r.width??1,r.height=r.height??1,"source"===r.type?t.push(r):"target"===r.type&&n.push(r);return{source:t,target:n}}function yo(e,t,n=ir.Left,r=!1){const o=(t?.x??0)+e.internals.positionAbsolute.x,i=(t?.y??0)+e.internals.positionAbsolute.y,{width:a,height:s}=t??Br(e);if(r)return{x:o+a/2,y:i+s/2};switch(t?.position??n){case ir.Top:return{x:o+a/2,y:i};case ir.Right:return{x:o+a,y:i+s/2};case ir.Bottom:return{x:o+a/2,y:i+s};case ir.Left:return{x:o,y:i+s/2}}}function vo(e,t){return e&&(t?e.find((e=>e.id===t)):e[0])||null}function wo(e,t){if(!e)return"";if("string"==typeof e)return e;return`${t?`${t}__`:""}${Object.keys(e).sort().map((t=>`${t}=${e[t]}`)).join("&")}`}function xo(e,{id:t,defaultColor:n,defaultMarkerStart:r,defaultMarkerEnd:o}){const i=new Set;return e.reduce(((e,a)=>([a.markerStart||r,a.markerEnd||o].forEach((r=>{if(r&&"object"==typeof r){const o=wo(r,t);i.has(o)||(e.push({id:o,color:r.color||n,...r}),i.add(o))}})),e)),[]).sort(((e,t)=>e.id.localeCompare(t.id)))}const bo={nodeOrigin:[0,0],nodeExtent:Kn,elevateNodesOnSelect:!0,defaults:{}},Eo={...bo,checkEquality:!0};function _o(e,t){const n={...e};for(const r in t)void 0!==t[r]&&(n[r]=t[r]);return n}function ko(e,t,n){const r=_o(bo,n);for(const o of e.values())if(o.parentId)So(o,e,t,r);else{const e=dr(o,r.nodeOrigin),t=Hr(o.extent)?o.extent:r.nodeExtent,n=br(e,t,Br(o));o.internals.positionAbsolute=n}}function No(e,t,n,r){const o=_o(Eo,r),i=new Map(t),a=o?.elevateNodesOnSelect?1e3:0;t.clear(),n.clear();for(const s of e){let e=i.get(s.id);if(o.checkEquality&&s===e?.internals.userNode)t.set(s.id,e);else{const n=dr(s,o.nodeOrigin),r=Hr(s.extent)?s.extent:o.nodeExtent,i=br(n,r,Br(s));e={...o.defaults,...s,measured:{width:s.measured?.width,height:s.measured?.height},internals:{positionAbsolute:i,handleBounds:s.measured?e?.internals.handleBounds:void 0,z:Mo(s,a),userNode:s}},t.set(s.id,e)}s.parentId&&So(e,t,n,r)}}function So(e,t,n,r){const{elevateNodesOnSelect:o,nodeOrigin:i,nodeExtent:a}=_o(bo,r),s=e.parentId,c=t.get(s);if(!c)return void console.warn(`Parent node ${s} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);!function(e,t){if(!e.parentId)return;const n=t.get(e.parentId);n?n.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}(e,n);const l=o?1e3:0,{x:u,y:d,z:h}=function(e,t,n,r,o){const{x:i,y:a}=t.internals.positionAbsolute,s=Br(e),c=dr(e,n),l=Hr(e.extent)?br(c,e.extent,s):c;let u=br({x:i+l.x,y:a+l.y},r,s);"parent"===e.extent&&(u=Er(u,s,t));const d=Mo(e,o),h=t.internals.z??0;return{x:u.x,y:u.y,z:h>d?h:d}}(e,c,i,a,l),{positionAbsolute:f}=e.internals,m=u!==f.x||d!==f.y;(m||h!==e.internals.z)&&t.set(e.id,{...e,internals:{...e.internals,positionAbsolute:m?{x:u,y:d}:f,z:h}})}function Mo(e,t){return(zr(e.zIndex)?e.zIndex:0)+(e.selected?t:0)}function Co(e,t,n,r=[0,0]){const o=[],i=new Map;for(const a of e){const e=t.get(a.parentId);if(!e)continue;const n=i.get(a.parentId)?.expandedRect??Cr(e),r=Or(n,a.rect);i.set(a.parentId,{expandedRect:r,parent:e})}return i.size>0&&i.forEach((({expandedRect:t,parent:i},a)=>{const s=i.internals.positionAbsolute,c=Br(i),l=i.origin??r,u=t.x<s.x?Math.round(Math.abs(s.x-t.x)):0,d=t.y<s.y?Math.round(Math.abs(s.y-t.y)):0,h=Math.max(c.width,Math.round(t.width)),f=Math.max(c.height,Math.round(t.height)),m=(h-c.width)*l[0],p=(f-c.height)*l[1];(u>0||d>0||m||p)&&(o.push({id:a,type:"position",position:{x:i.position.x-u+m,y:i.position.y-d+p}}),n.get(a)?.forEach((t=>{e.some((e=>e.id===t.id))||o.push({id:t.id,type:"position",position:{x:t.position.x+u,y:t.position.y+d}})}))),(c.width<t.width||c.height<t.height||u||d)&&o.push({id:a,type:"dimensions",setAttributes:!0,dimensions:{width:h+(u?l[0]*u-m:0),height:f+(d?l[1]*d-p:0)}})})),o}function Ao(e,t,n,r,o,i){const a=r?.querySelector(".xyflow__viewport");let s=!1;if(!a)return{changes:[],updatedInternals:s};const c=[],l=window.getComputedStyle(a),{m22:u}=new window.DOMMatrixReadOnly(l.transform),d=[];for(const h of e.values()){const e=t.get(h.id);if(!e)continue;if(e.hidden){t.set(e.id,{...e,internals:{...e.internals,handleBounds:void 0}}),s=!0;continue}const r=Gr(h.nodeElement),a=e.measured.width!==r.width||e.measured.height!==r.height;if(!(!r.width||!r.height||!a&&e.internals.handleBounds&&!h.force)){const l=h.nodeElement.getBoundingClientRect(),f=Hr(e.extent)?e.extent:i;let{positionAbsolute:m}=e.internals;e.parentId&&"parent"===e.extent?m=Er(m,r,t.get(e.parentId)):f&&(m=br(m,f,r));const p={...e,measured:r,internals:{...e.internals,positionAbsolute:m,handleBounds:{source:Jr("source",h.nodeElement,l,u,e.id),target:Jr("target",h.nodeElement,l,u,e.id)}}};t.set(e.id,p),e.parentId&&So(p,t,n,{nodeOrigin:o}),s=!0,a&&(c.push({id:e.id,type:"dimensions",dimensions:r}),e.expandParent&&e.parentId&&d.push({id:e.id,parentId:e.parentId,rect:Cr(p,o)}))}}if(d.length>0){const e=Co(d,t,n,o);c.push(...e)}return{changes:c,updatedInternals:s}}async function Oo({delta:e,panZoom:t,transform:n,translateExtent:r,width:o,height:i}){if(!t||!e.x&&!e.y)return Promise.resolve(!1);const a=await t.setViewportConstrained({x:n[0]+e.x,y:n[1]+e.y,zoom:n[2]},[[0,0],[o,i]],r),s=!!a&&(a.x!==n[0]||a.y!==n[1]||a.k!==n[2]);return Promise.resolve(s)}function Io(e,t,n,r,o,i){let a=o;const s=r.get(a)||new Map;r.set(a,s.set(n,t)),a=`${o}-${e}`;const c=r.get(a)||new Map;if(r.set(a,c.set(n,t)),i){a=`${o}-${e}-${i}`;const s=r.get(a)||new Map;r.set(a,s.set(n,t))}}function To(e,t,n){e.clear(),t.clear();for(const r of n){const{source:n,target:o,sourceHandle:i=null,targetHandle:a=null}=r,s={edgeId:r.id,source:n,target:o,sourceHandle:i,targetHandle:a},c=`${n}-${i}--${o}-${a}`;Io("source",s,`${o}-${a}--${n}-${i}`,e,n,i),Io("target",s,c,e,o,a),t.set(r.id,r)}}function zo(e,t){if(!e.parentId)return!1;const n=t.get(e.parentId);return!!n&&(!!n.selected||zo(n,t))}function Po(e,t,n){let r=e;do{if(r?.matches?.(t))return!0;if(r===n)return!1;r=r?.parentElement}while(r);return!1}function $o({nodeId:e,dragItems:t,nodeLookup:n,dragging:r=!0}){const o=[];for(const[a,s]of t){const e=n.get(a)?.internals.userNode;e&&o.push({...e,position:s.position,dragging:r})}if(!e)return[o[0],o];const i=n.get(e)?.internals.userNode;return[i?{...i,position:t.get(e)?.position||i.position,dragging:r}:o[0],o]}function Lo({onNodeMouseDown:e,getStoreItems:t,onDragStart:n,onDrag:r,onDragStop:o}){let i={x:null,y:null},a=0,s=new Map,c=!1,l={x:0,y:0},u=null,d=!1,h=null,f=!1;return{update:function({noDragClassName:m,handleSelector:p,domNode:g,isSelectable:y,nodeId:v,nodeClickDistance:w=0}){function x({x:e,y:n},o){const{nodeLookup:a,nodeExtent:c,snapGrid:l,snapToGrid:u,nodeOrigin:d,onNodeDrag:h,onSelectionDrag:f,onError:m,updateNodePositions:p}=t();i={x:e,y:n};let g=!1,y={x:0,y:0,x2:0,y2:0};if(s.size>1&&c){const e=fr(s);y=Sr(e)}for(const[t,r]of s){if(!a.has(t))continue;let o={x:e-r.distance.x,y:n-r.distance.y};u&&(o=$r(o,l));let i=[[c[0][0],c[0][1]],[c[1][0],c[1][1]]];if(s.size>1&&c&&!r.extent){const{positionAbsolute:e}=r.internals,t=e.x-y.x+c[0][0],n=e.x+r.measured.width-y.x2+c[1][0];i=[[t,e.y-y.y+c[0][1]],[n,e.y+r.measured.height-y.y2+c[1][1]]]}const{position:h,positionAbsolute:f}=vr({nodeId:t,nextPosition:o,nodeLookup:a,nodeExtent:i,nodeOrigin:d,onError:m});g=g||r.position.x!==h.x||r.position.y!==h.y,r.position=h,r.internals.positionAbsolute=f}if(g&&(p(s,!0),o&&(r||h||!v&&f))){const[e,t]=$o({nodeId:v,dragItems:s,nodeLookup:a});r?.(o,s,e,t),h?.(o,e,t),v||f?.(o,t)}}async function b(){if(!u)return;const{transform:e,panBy:n,autoPanSpeed:r,autoPanOnNodeDrag:o}=t();if(!o)return c=!1,void cancelAnimationFrame(a);const[s,d]=kr(l,u,r);0===s&&0===d||(i.x=(i.x??0)-s/e[2],i.y=(i.y??0)-d/e[2],await n({x:s,y:d})&&x(i,null)),a=requestAnimationFrame(b)}function E(r){const{nodeLookup:o,multiSelectionActive:a,nodesDraggable:c,transform:l,snapGrid:h,snapToGrid:f,selectNodesOnDrag:m,onNodeDragStart:p,onSelectionDragStart:g,unselectNodesAndEdges:w}=t();d=!0,m&&y||a||!v||o.get(v)?.selected||w(),y&&m&&v&&e?.(v);const x=Xr(r.sourceEvent,{transform:l,snapGrid:h,snapToGrid:f,containerBounds:u});if(i=x,s=function(e,t,n,r){const o=new Map;for(const[i,a]of e)if((a.selected||a.id===r)&&(!a.parentId||!zo(a,e))&&(a.draggable||t&&void 0===a.draggable)){const t=e.get(i);t&&o.set(i,{id:i,position:t.position||{x:0,y:0},distance:{x:n.x-t.internals.positionAbsolute.x,y:n.y-t.internals.positionAbsolute.y},extent:t.extent,parentId:t.parentId,origin:t.origin,expandParent:t.expandParent,internals:{positionAbsolute:t.internals.positionAbsolute||{x:0,y:0}},measured:{width:t.measured.width??0,height:t.measured.height??0}})}return o}(o,c,x,v),s.size>0&&(n||p||!v&&g)){const[e,t]=$o({nodeId:v,dragItems:s,nodeLookup:o});n?.(r.sourceEvent,s,e,t),p?.(r.sourceEvent,e,t),v||g?.(r.sourceEvent,t)}}h=Ee(g);const _=Le().clickDistance(w).on("start",(e=>{const{domNode:n,nodeDragThreshold:r,transform:o,snapGrid:a,snapToGrid:s}=t();u=n?.getBoundingClientRect()||null,f=!1,0===r&&E(e);const c=Xr(e.sourceEvent,{transform:o,snapGrid:a,snapToGrid:s,containerBounds:u});i=c,l=Kr(e.sourceEvent,u)})).on("drag",(e=>{const{autoPanOnNodeDrag:n,transform:r,snapGrid:o,snapToGrid:a,nodeDragThreshold:h,nodeLookup:m}=t(),p=Xr(e.sourceEvent,{transform:r,snapGrid:o,snapToGrid:a,containerBounds:u});if(("touchmove"===e.sourceEvent.type&&e.sourceEvent.touches.length>1||v&&!m.has(v))&&(f=!0),!f){if(!c&&n&&d&&(c=!0,b()),!d){const t=p.xSnapped-(i.x??0),n=p.ySnapped-(i.y??0);Math.sqrt(t*t+n*n)>h&&E(e)}(i.x!==p.xSnapped||i.y!==p.ySnapped)&&s&&d&&(l=Kr(e.sourceEvent,u),x(p,e.sourceEvent))}})).on("end",(e=>{if(d&&!f&&(c=!1,d=!1,cancelAnimationFrame(a),s.size>0)){const{nodeLookup:n,updateNodePositions:r,onNodeDragStop:i,onSelectionDragStop:a}=t();if(r(s,!1),o||i||!v&&a){const[t,r]=$o({nodeId:v,dragItems:s,nodeLookup:n,dragging:!1});o?.(e.sourceEvent,s,t,r),i?.(e.sourceEvent,t,r),v||a?.(e.sourceEvent,r)}}})).filter((e=>{const t=e.target;return!e.button&&(!m||!Po(t,`.${m}`,g))&&(!p||Po(t,p,g))}));h.call(_)},destroy:function(){h?.on(".drag",null)}}}function jo(e,t,n,r){let o=[],i=1/0;const a=function(e,t,n){const r=[],o={x:e.x-n,y:e.y-n,width:2*n,height:2*n};for(const i of t.values())Ir(o,Cr(i))>0&&r.push(i);return r}(e,n,t+250);for(const s of a){const n=[...s.internals.handleBounds?.source??[],...s.internals.handleBounds?.target??[]];for(const a of n){if(r.nodeId===a.nodeId&&r.type===a.type&&r.id===a.id)continue;const{x:n,y:c}=yo(s,a,a.position,!0),l=Math.sqrt(Math.pow(n-e.x,2)+Math.pow(c-e.y,2));l>t||(l<i?(o=[{...a,x:n,y:c}],i=l):l===i&&o.push({...a,x:n,y:c}))}}if(!o.length)return null;if(o.length>1){const e="source"===r.type?"target":"source";return o.find((t=>t.type===e))??o[0]}return o[0]}function Ro(e,t,n,r,o,i=!1){const a=r.get(e);if(!a)return null;const s="strict"===o?a.internals.handleBounds?.[t]:[...a.internals.handleBounds?.source??[],...a.internals.handleBounds?.target??[]],c=(n?s?.find((e=>e.id===n)):s?.[0])??null;return c&&i?{...c,...yo(a,c,c.position,!0)}:c}function Do(e,t){return e||(t?.classList.contains("target")?"target":t?.classList.contains("source")?"source":null)}const Ho=()=>!0;function Bo(e,{handle:t,connectionMode:n,fromNodeId:r,fromHandleId:o,fromType:i,doc:a,lib:s,flowId:c,isValidConnection:l=Ho,nodeLookup:u}){const d="target"===i,h=t?a.querySelector(`.${s}-flow__handle[data-id="${c}-${t?.nodeId}-${t?.id}-${t?.type}"]`):null,{x:f,y:m}=Kr(e),p=a.elementFromPoint(f,m),g=p?.classList.contains(`${s}-flow__handle`)?p:h,y={handleDomNode:g,isValid:!1,connection:null,toHandle:null};if(g){const e=Do(void 0,g),t=g.getAttribute("data-nodeid"),i=g.getAttribute("data-handleid"),a=g.classList.contains("connectable"),s=g.classList.contains("connectableend");if(!t||!e)return y;const c={source:d?t:r,sourceHandle:d?i:o,target:d?r:t,targetHandle:d?o:i};y.connection=c;const h=a&&s&&(n===Qn.Strict?d&&"source"===e||!d&&"target"===e:t!==r||i!==o);y.isValid=h&&l(c),y.toHandle=Ro(t,e,i,u,n,!1)}return y}const Vo={onPointerDown:function(e,{connectionMode:t,connectionRadius:n,handleId:r,nodeId:o,edgeUpdaterType:i,isTarget:a,domNode:s,nodeLookup:c,lib:l,autoPanOnConnect:u,flowId:d,panBy:h,cancelConnection:f,onConnectStart:m,onConnect:p,onConnectEnd:g,isValidConnection:y=Ho,onReconnectEnd:v,updateConnection:w,getTransform:x,getFromHandle:b,autoPanSpeed:E}){const _=qr(e.target);let k,N=0;const{x:S,y:M}=Kr(e),C=_?.elementFromPoint(S,M),A=Do(i,C),O=s?.getBoundingClientRect();if(!O||!A)return;const I=Ro(o,A,r,c,t);if(!I)return;let T=Kr(e,O),z=!1,P=null,$=!1,L=null;function j(){if(!u||!O)return;const[e,t]=kr(T,O,E);h({x:e,y:t}),N=requestAnimationFrame(j)}const R={...I,nodeId:o,type:A,position:I.position},D=c.get(o),H={inProgress:!0,isValid:null,from:yo(D,R,ir.Left,!0),fromHandle:R,fromPosition:R.position,fromNode:D,to:T,toHandle:null,toPosition:ar[R.position],toNode:null};w(H);let B=H;function V(e){if(!b()||!R)return void F(e);const i=x();T=Kr(e,O),k=jo(Lr(T,i,!1,[1,1]),n,c,R),z||(j(),z=!0);const s=Bo(e,{handle:k,connectionMode:t,fromNodeId:o,fromHandleId:r,fromType:a?"target":"source",isValidConnection:y,doc:_,lib:l,flowId:d,nodeLookup:c});L=s.handleDomNode,P=s.connection,$=function(e,t){let n=null;return t?n=!0:e&&!t&&(n=!1),n}(!!k,s.isValid);const u={...B,isValid:$,to:k&&$?jr({x:k.x,y:k.y},i):T,toHandle:s.toHandle,toPosition:$&&s.toHandle?s.toHandle.position:ar[R.position],toNode:s.toHandle?c.get(s.toHandle.nodeId):null};$&&k&&B.toHandle&&u.toHandle&&B.toHandle.type===u.toHandle.type&&B.toHandle.nodeId===u.toHandle.nodeId&&B.toHandle.id===u.toHandle.id&&B.to.x===u.to.x&&B.to.y===u.to.y||(w(u),B=u)}function F(e){(k||L)&&P&&$&&p?.(P);const{inProgress:t,...n}=B,r={...n,toPosition:B.toHandle?B.toPosition:null};g?.(e,r),i&&v?.(e,r),f(),cancelAnimationFrame(N),z=!1,$=!1,P=null,L=null,_.removeEventListener("mousemove",V),_.removeEventListener("mouseup",F),_.removeEventListener("touchmove",V),_.removeEventListener("touchend",F)}m?.(e,{nodeId:o,handleId:r,handleType:A}),_.addEventListener("mousemove",V),_.addEventListener("mouseup",F),_.addEventListener("touchmove",V),_.addEventListener("touchend",F)},isValid:Bo};function Fo({domNode:e,panZoom:t,getTransform:n,getViewScale:r}){const o=Ee(e);return{update:function({translateExtent:e,width:i,height:a,zoomStep:s=10,pannable:c=!0,zoomable:l=!0,inversePan:u=!1}){let d=[0,0];const h=Un().on("start",(e=>{"mousedown"!==e.sourceEvent.type&&"touchstart"!==e.sourceEvent.type||(d=[e.sourceEvent.clientX??e.sourceEvent.touches[0].clientX,e.sourceEvent.clientY??e.sourceEvent.touches[0].clientY])})).on("zoom",c?o=>{const s=n();if("mousemove"!==o.sourceEvent.type&&"touchmove"!==o.sourceEvent.type||!t)return;const c=[o.sourceEvent.clientX??o.sourceEvent.touches[0].clientX,o.sourceEvent.clientY??o.sourceEvent.touches[0].clientY],l=[c[0]-d[0],c[1]-d[1]];d=c;const h=r()*Math.max(s[2],Math.log(s[2]))*(u?-1:1),f={x:s[0]-l[0]*h,y:s[1]-l[1]*h},m=[[0,0],[i,a]];t.setViewportConstrained({x:f.x,y:f.y,zoom:s[2]},m,e)}:null).on("zoom.wheel",l?e=>{const r=n();if("wheel"!==e.sourceEvent.type||!t)return;const o=-e.sourceEvent.deltaY*(1===e.sourceEvent.deltaMode?.05:e.sourceEvent.deltaMode?1:.002)*s,i=r[2]*Math.pow(2,o);t.scaleTo(i)}:null);o.call(h,{})},destroy:function(){o.on("zoom",null)},pointer:_e}}const Yo=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,Xo=e=>({x:e.x,y:e.y,zoom:e.k}),Go=({x:e,y:t,zoom:n})=>Dn.translate(e,t).scale(n),qo=(e,t)=>e.target.closest(`.${t}`),Wo=(e,t)=>2===t&&Array.isArray(e)&&e.includes(2),Uo=(e,t=0,n=()=>{})=>{const r="number"==typeof t&&t>0;return r||n(),r?e.transition().duration(t).on("end",n):e},Zo=e=>{const t=e.ctrlKey&&Dr()?10:1;return-e.deltaY*(1===e.deltaMode?.05:e.deltaMode?1:.002)*t};function Ko({domNode:e,minZoom:t,maxZoom:n,paneClickDistance:r,translateExtent:o,viewport:i,onPanZoom:a,onPanZoomStart:s,onPanZoomEnd:c,onDraggingChange:l}){const u={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{x:0,y:0,zoom:0},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},d=e.getBoundingClientRect(),h=Un().clickDistance(!zr(r)||r<0?0:r).scaleExtent([t,n]).translateExtent(o),f=Ee(e).call(h);v({x:i.x,y:i.y,zoom:xr(i.zoom,t,n)},[[0,0],[d.width,d.height]],o);const m=f.on("wheel.zoom"),p=f.on("dblclick.zoom");function g(e,t){return f?new Promise((n=>{h?.transform(Uo(f,t?.duration,(()=>n(!0))),e)})):Promise.resolve(!1)}function y(){h.on("zoom",null)}async function v(e,t,n){const r=Go(e),o=h?.constrain()(r,t,n);return o&&await g(o),new Promise((e=>e(o)))}return h.wheelDelta(Zo),{update:function({noWheelClassName:e,noPanClassName:t,onPaneContextMenu:n,userSelectionActive:r,panOnScroll:o,panOnDrag:i,panOnScrollMode:d,panOnScrollSpeed:g,preventScrolling:v,zoomOnPinch:w,zoomOnScroll:x,zoomOnDoubleClick:b,zoomActivationKeyPressed:E,lib:_,onTransformChange:k}){r&&!u.isZoomingOrPanning&&y();const N=o&&!E&&!r?function({zoomPanValues:e,noWheelClassName:t,d3Selection:n,d3Zoom:r,panOnScrollMode:o,panOnScrollSpeed:i,zoomOnPinch:a,onPanZoomStart:s,onPanZoom:c,onPanZoomEnd:l}){return u=>{if(qo(u,t))return!1;u.preventDefault(),u.stopImmediatePropagation();const d=n.property("__zoom").k||1;if(u.ctrlKey&&a){const e=_e(u),t=Zo(u),o=d*Math.pow(2,t);return void r.scaleTo(n,o,e,u)}const h=1===u.deltaMode?20:1;let f=o===er.Vertical?0:u.deltaX*h,m=o===er.Horizontal?0:u.deltaY*h;!Dr()&&u.shiftKey&&o!==er.Vertical&&(f=u.deltaY*h,m=0),r.translateBy(n,-f/d*i,-m/d*i,{internal:!0});const p=Xo(n.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling||(e.isPanScrolling=!0,s?.(u,p)),e.isPanScrolling&&(c?.(u,p),e.panScrollTimeout=setTimeout((()=>{l?.(u,p),e.isPanScrolling=!1}),150))}}({zoomPanValues:u,noWheelClassName:e,d3Selection:f,d3Zoom:h,panOnScrollMode:d,panOnScrollSpeed:g,zoomOnPinch:w,onPanZoomStart:s,onPanZoom:a,onPanZoomEnd:c}):function({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:n}){return function(r,o){if(!t&&"wheel"===r.type&&!r.ctrlKey||qo(r,e))return null;r.preventDefault(),n.call(this,r,o)}}({noWheelClassName:e,preventScrolling:v,d3ZoomHandler:m});if(f.on("wheel.zoom",N,{passive:!1}),!r){const e=function({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:n}){return r=>{if(r.sourceEvent?.internal)return;const o=Xo(r.transform);e.mouseButton=r.sourceEvent?.button||0,e.isZoomingOrPanning=!0,e.prevViewport=o,"mousedown"===r.sourceEvent?.type&&t(!0),n&&n?.(r.sourceEvent,o)}}({zoomPanValues:u,onDraggingChange:l,onPanZoomStart:s});h.on("start",e);const t=function({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:n,onTransformChange:r,onPanZoom:o}){return i=>{e.usedRightMouseButton=!(!n||!Wo(t,e.mouseButton??0)),i.sourceEvent?.sync||r([i.transform.x,i.transform.y,i.transform.k]),o&&!i.sourceEvent?.internal&&o?.(i.sourceEvent,Xo(i.transform))}}({zoomPanValues:u,panOnDrag:i,onPaneContextMenu:!!n,onPanZoom:a,onTransformChange:k});h.on("zoom",t);const r=function({zoomPanValues:e,panOnDrag:t,panOnScroll:n,onDraggingChange:r,onPanZoomEnd:o,onPaneContextMenu:i}){return a=>{if(!a.sourceEvent?.internal&&(e.isZoomingOrPanning=!1,i&&Wo(t,e.mouseButton??0)&&!e.usedRightMouseButton&&a.sourceEvent&&i(a.sourceEvent),e.usedRightMouseButton=!1,r(!1),o&&Yo(e.prevViewport,a.transform))){const t=Xo(a.transform);e.prevViewport=t,clearTimeout(e.timerId),e.timerId=setTimeout((()=>{o?.(a.sourceEvent,t)}),n?150:0)}}}({zoomPanValues:u,panOnDrag:i,panOnScroll:o,onPaneContextMenu:n,onPanZoomEnd:c,onDraggingChange:l});h.on("end",r)}const S=function({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:n,panOnDrag:r,panOnScroll:o,zoomOnDoubleClick:i,userSelectionActive:a,noWheelClassName:s,noPanClassName:c,lib:l}){return u=>{const d=e||t,h=n&&u.ctrlKey;if(1===u.button&&"mousedown"===u.type&&(qo(u,`${l}-flow__node`)||qo(u,`${l}-flow__edge`)))return!0;if(!(r||d||o||i||n))return!1;if(a)return!1;if(qo(u,s)&&"wheel"===u.type)return!1;if(qo(u,c)&&("wheel"!==u.type||o&&"wheel"===u.type&&!e))return!1;if(!n&&u.ctrlKey&&"wheel"===u.type)return!1;if(!n&&"touchstart"===u.type&&u.touches?.length>1)return u.preventDefault(),!1;if(!d&&!o&&!h&&"wheel"===u.type)return!1;if(!r&&("mousedown"===u.type||"touchstart"===u.type))return!1;if(Array.isArray(r)&&!r.includes(u.button)&&"mousedown"===u.type)return!1;const f=Array.isArray(r)&&r.includes(u.button)||!u.button||u.button<=1;return(!u.ctrlKey||"wheel"===u.type)&&f}}({zoomActivationKeyPressed:E,panOnDrag:i,zoomOnScroll:x,panOnScroll:o,zoomOnDoubleClick:b,zoomOnPinch:w,userSelectionActive:r,noPanClassName:t,noWheelClassName:e,lib:_});h.filter(S),b?f.on("dblclick.zoom",p):f.on("dblclick.zoom",null)},destroy:y,setViewport:async function(e,t){const n=Go(e);return await g(n,t),new Promise((e=>e(n)))},setViewportConstrained:v,getViewport:function(){const e=f?Hn(f.node()):{x:0,y:0,k:1};return{x:e.x,y:e.y,zoom:e.k}},scaleTo:function(e,t){return f?new Promise((n=>{h?.scaleTo(Uo(f,t?.duration,(()=>n(!0))),e)})):Promise.resolve(!1)},scaleBy:function(e,t){return f?new Promise((n=>{h?.scaleBy(Uo(f,t?.duration,(()=>n(!0))),e)})):Promise.resolve(!1)},setScaleExtent:function(e){h?.scaleExtent(e)},setTranslateExtent:function(e){h?.translateExtent(e)},syncViewport:function(e){if(f){const t=Go(e),n=f.property("__zoom");n.k===e.zoom&&n.x===e.x&&n.y===e.y||h?.transform(f,t,null,{sync:!0})}},setClickDistance:function(e){const t=!zr(e)||e<0?0:e;h?.clickDistance(t)}}}var Jo;!function(e){e.Line="line",e.Handle="handle"}(Jo||(Jo={}));function Qo(e,t){return Math.max(0,t-e)}function ei(e,t){return Math.max(0,e-t)}function ti(e,t,n){return Math.max(0,t-e,e-n)}function ni(e,t){return e?!t:t}const ri={width:0,height:0,x:0,y:0},oi={...ri,pointerX:0,pointerY:0,aspectRatio:1};function ii(e,t,n){const r=t.position.x+e.position.x,o=t.position.y+e.position.y,i=e.measured.width??0,a=e.measured.height??0,s=n[0]*i,c=n[1]*a;return[[r-s,o-c],[r+i-s,o+a-c]]}function ai({domNode:e,nodeId:t,getStoreItems:n,onChange:r,onEnd:o}){const i=Ee(e);return{update:function({controlPosition:e,boundaries:a,keepAspectRatio:s,onResizeStart:c,onResize:l,onResizeEnd:u,shouldResize:d}){let h={...ri},f={...oi};const m=function(e){return{isHorizontal:e.includes("right")||e.includes("left"),isVertical:e.includes("bottom")||e.includes("top"),affectsX:e.includes("left"),affectsY:e.includes("top")}}(e);let p,g,y,v,w=null,x=[];const b=Le().on("start",(e=>{const{nodeLookup:r,transform:o,snapGrid:i,snapToGrid:a,nodeOrigin:s,paneDomNode:l}=n();if(p=r.get(t),!p)return;w=l?.getBoundingClientRect()??null;const{xSnapped:u,ySnapped:d}=Xr(e.sourceEvent,{transform:o,snapGrid:i,snapToGrid:a,containerBounds:w});h={width:p.measured.width??0,height:p.measured.height??0,x:p.position.x??0,y:p.position.y??0},f={...h,pointerX:u,pointerY:d,aspectRatio:h.width/h.height},g=void 0,p.parentId&&("parent"===p.extent||p.expandParent)&&(g=r.get(p.parentId),y=g&&"parent"===p.extent?function(e){return[[0,0],[e.measured.width,e.measured.height]]}(g):void 0),x=[],v=void 0;for(const[n,c]of r)if(c.parentId===t&&(x.push({id:n,position:{...c.position},extent:c.extent}),"parent"===c.extent||c.expandParent)){const e=ii(c,p,c.origin??s);v=v?[[Math.min(e[0][0],v[0][0]),Math.min(e[0][1],v[0][1])],[Math.max(e[1][0],v[1][0]),Math.max(e[1][1],v[1][1])]]:e}c?.(e,{...h})})).on("drag",(e=>{const{transform:t,snapGrid:o,snapToGrid:i,nodeOrigin:c}=n(),u=Xr(e.sourceEvent,{transform:t,snapGrid:o,snapToGrid:i,containerBounds:w}),b=[];if(!p)return;const{x:E,y:_,width:k,height:N}=h,S={},M=p.origin??c,{width:C,height:A,x:O,y:I}=function(e,t,n,r,o,i,a,s){let{affectsX:c,affectsY:l}=t;const{isHorizontal:u,isVertical:d}=t,h=u&&d,{xSnapped:f,ySnapped:m}=n,{minWidth:p,maxWidth:g,minHeight:y,maxHeight:v}=r,{x:w,y:x,width:b,height:E,aspectRatio:_}=e;let k=Math.floor(u?f-e.pointerX:0),N=Math.floor(d?m-e.pointerY:0);const S=b+(c?-k:k),M=E+(l?-N:N),C=-i[0]*b,A=-i[1]*E;let O=ti(S,p,g),I=ti(M,y,v);if(a){let e=0,t=0;c&&k<0?e=Qo(w+k+C,a[0][0]):!c&&k>0&&(e=ei(w+S+C,a[1][0])),l&&N<0?t=Qo(x+N+A,a[0][1]):!l&&N>0&&(t=ei(x+M+A,a[1][1])),O=Math.max(O,e),I=Math.max(I,t)}if(s){let e=0,t=0;c&&k>0?e=ei(w+k,s[0][0]):!c&&k<0&&(e=Qo(w+S,s[1][0])),l&&N>0?t=ei(x+N,s[0][1]):!l&&N<0&&(t=Qo(x+M,s[1][1])),O=Math.max(O,e),I=Math.max(I,t)}if(o){if(u){const e=ti(S/_,y,v)*_;if(O=Math.max(O,e),a){let e=0;e=!c&&!l||c&&!l&&h?ei(x+A+S/_,a[1][1])*_:Qo(x+A+(c?k:-k)/_,a[0][1])*_,O=Math.max(O,e)}if(s){let e=0;e=!c&&!l||c&&!l&&h?Qo(x+S/_,s[1][1])*_:ei(x+(c?k:-k)/_,s[0][1])*_,O=Math.max(O,e)}}if(d){const e=ti(M*_,p,g)/_;if(I=Math.max(I,e),a){let e=0;e=!c&&!l||l&&!c&&h?ei(w+M*_+C,a[1][0])/_:Qo(w+(l?N:-N)*_+C,a[0][0])/_,I=Math.max(I,e)}if(s){let e=0;e=!c&&!l||l&&!c&&h?Qo(w+M*_,s[1][0])/_:ei(w+(l?N:-N)*_,s[0][0])/_,I=Math.max(I,e)}}}N+=N<0?I:-I,k+=k<0?O:-O,o&&(h?S>M*_?N=(ni(c,l)?-k:k)/_:k=(ni(c,l)?-N:N)*_:u?(N=k/_,l=c):(k=N*_,c=l));const T=c?w+k:w,z=l?x+N:x;return{width:b+(c?-k:k),height:E+(l?-N:N),x:i[0]*k*(c?-1:1)+T,y:i[1]*N*(l?-1:1)+z}}(f,m,u,a,s,M,y,v),T=C!==k,z=A!==N,P=O!==E&&T,$=I!==_&&z;if(!(P||$||T||z))return;if((P||$||1===M[0]||1===M[1])&&(S.x=P?O:h.x,S.y=$?I:h.y,h.x=S.x,h.y=S.y,x.length>0)){const e=O-E,t=I-_;for(const n of x)n.position={x:n.position.x-e+M[0]*(C-k),y:n.position.y-t+M[1]*(A-N)},b.push(n)}if((T||z)&&(S.width=T?C:h.width,S.height=z?A:h.height,h.width=S.width,h.height=S.height),g&&p.expandParent){const e=M[0]*(S.width??0);S.x&&S.x<e&&(h.x=e,f.x=f.x-(S.x-e));const t=M[1]*(S.height??0);S.y&&S.y<t&&(h.y=t,f.y=f.y-(S.y-t))}const L=function({width:e,prevWidth:t,height:n,prevHeight:r,affectsX:o,affectsY:i}){const a=e-t,s=n-r,c=[a>0?1:a<0?-1:0,s>0?1:s<0?-1:0];return a&&o&&(c[0]=-1*c[0]),s&&i&&(c[1]=-1*c[1]),c}({width:h.width,prevWidth:k,height:h.height,prevHeight:N,affectsX:m.affectsX,affectsY:m.affectsY}),j={...h,direction:L},R=d?.(e,j);!1!==R&&(l?.(e,j),r(S,b))})).on("end",(e=>{u?.(e,{...h}),o?.()}));i.call(b)},destroy:function(){i.on(".drag",null)}}}},2377:function(e,t,n){var r=n(6239);function o(e){return e.nodes().map((function(t){var n=e.node(t),r=e.parent(t),o={v:t};return void 0!==n&&(o.value=n),void 0!==r&&(o.parent=r),o}))}function i(e){return e.edges().map((function(t){var n=e.edge(t),r={v:t.v,w:t.w};return void 0!==t.name&&(r.name=t.name),void 0!==n&&(r.value=n),r}))}e.exports={write:function(e){var t={options:{directed:e.isDirected(),multigraph:e.isMultigraph(),compound:e.isCompound()},nodes:o(e),edges:i(e)};void 0!==e.graph()&&(t.value=structuredClone(e.graph()));return t},read:function(e){var t=new r(e.options).setGraph(e.value);return e.nodes.forEach((function(e){t.setNode(e.v,e.value),e.parent&&t.setParent(e.v,e.parent)})),e.edges.forEach((function(e){t.setEdge({v:e.v,w:e.w,name:e.name},e.value)})),t}}},2667:function(e,t,n){"use strict";let r=n(4809);e.exports=function(e){let t={},n=e.nodes().filter((t=>!e.children(t).length)),o=n.map((t=>e.node(t).rank)),i=r.applyWithChunking(Math.max,o),a=r.range(i+1).map((()=>[]));return n.sort(((t,n)=>e.node(t).rank-e.node(n).rank)).forEach((function n(r){if(t[r])return;t[r]=!0;let o=e.node(r);a[o.rank].push(r),e.successors(r).forEach(n)})),a}},2806:function(e,t,n){"use strict";let r=n(6743).Graph,o=n(4809);function i(e,t){let n={};return t.length&&t.reduce((function(t,r){let o=0,i=0,a=t.length,c=r[r.length-1];return r.forEach(((t,l)=>{let u=function(e,t){if(e.node(t).dummy)return e.predecessors(t).find((t=>e.node(t).dummy))}(e,t),d=u?e.node(u).order:a;(u||t===c)&&(r.slice(i,l+1).forEach((t=>{e.predecessors(t).forEach((r=>{let i=e.node(r),a=i.order;!(a<o||d<a)||i.dummy&&e.node(t).dummy||s(n,r,t)}))})),i=l+1,o=d)})),r})),n}function a(e,t){let n={};function r(t,r,i,a,c){let l;o.range(r,i).forEach((r=>{l=t[r],e.node(l).dummy&&e.predecessors(l).forEach((t=>{let r=e.node(t);r.dummy&&(r.order<a||r.order>c)&&s(n,t,l)}))}))}return t.length&&t.reduce((function(t,n){let o,i=-1,a=0;return n.forEach(((s,c)=>{if("border"===e.node(s).dummy){let t=e.predecessors(s);t.length&&(o=e.node(t[0]).order,r(n,a,c,i,o),a=c,i=o)}r(n,a,n.length,o,t.length)})),n})),n}function s(e,t,n){if(t>n){let e=t;t=n,n=e}let r=e[t];r||(e[t]=r={}),r[n]=!0}function c(e,t,n){if(t>n){let e=t;t=n,n=e}return!!e[t]&&Object.hasOwn(e[t],n)}function l(e,t,n,r){let o={},i={},a={};return t.forEach((e=>{e.forEach(((e,t)=>{o[e]=e,i[e]=e,a[e]=t}))})),t.forEach((e=>{let t=-1;e.forEach((e=>{let s=r(e);if(s.length){s=s.sort(((e,t)=>a[e]-a[t]));let r=(s.length-1)/2;for(let l=Math.floor(r),u=Math.ceil(r);l<=u;++l){let r=s[l];i[e]===e&&t<a[r]&&!c(n,e,r)&&(i[r]=e,i[e]=o[e]=o[r],t=a[r])}}}))})),{root:o,align:i}}function u(e,t,n,o,i){let a={},s=function(e,t,n,o){let i=new r,a=e.graph(),s=function(e,t,n){return(r,o,i)=>{let a,s=r.node(o),c=r.node(i),l=0;if(l+=s.width/2,Object.hasOwn(s,"labelpos"))switch(s.labelpos.toLowerCase()){case"l":a=-s.width/2;break;case"r":a=s.width/2}if(a&&(l+=n?a:-a),a=0,l+=(s.dummy?t:e)/2,l+=(c.dummy?t:e)/2,l+=c.width/2,Object.hasOwn(c,"labelpos"))switch(c.labelpos.toLowerCase()){case"l":a=c.width/2;break;case"r":a=-c.width/2}return a&&(l+=n?a:-a),a=0,l}}(a.nodesep,a.edgesep,o);return t.forEach((t=>{let r;t.forEach((t=>{let o=n[t];if(i.setNode(o),r){var a=n[r],c=i.edge(a,o);i.setEdge(a,o,Math.max(s(e,t,r),c||0))}r=t}))})),i}(e,t,n,i),c=i?"borderLeft":"borderRight";function l(e,t){let n=s.nodes(),r=n.pop(),o={};for(;r;)o[r]?e(r):(o[r]=!0,n.push(r),n=n.concat(t(r))),r=n.pop()}return l((function(e){a[e]=s.inEdges(e).reduce(((e,t)=>Math.max(e,a[t.v]+s.edge(t))),0)}),s.predecessors.bind(s)),l((function(t){let n=s.outEdges(t).reduce(((e,t)=>Math.min(e,a[t.w]-s.edge(t))),Number.POSITIVE_INFINITY),r=e.node(t);n!==Number.POSITIVE_INFINITY&&r.borderType!==c&&(a[t]=Math.max(a[t],n))}),s.successors.bind(s)),Object.keys(o).forEach((e=>a[e]=a[n[e]])),a}function d(e,t){return Object.values(t).reduce(((t,n)=>{let r=Number.NEGATIVE_INFINITY,o=Number.POSITIVE_INFINITY;Object.entries(n).forEach((([t,n])=>{let i=function(e,t){return e.node(t).width}(e,t)/2;r=Math.max(n+i,r),o=Math.min(n-i,o)}));const i=r-o;return i<t[0]&&(t=[i,n]),t}),[Number.POSITIVE_INFINITY,null])[1]}function h(e,t){let n=Object.values(t),r=o.applyWithChunking(Math.min,n),i=o.applyWithChunking(Math.max,n);["u","d"].forEach((n=>{["l","r"].forEach((a=>{let s=n+a,c=e[s];if(c===t)return;let l=Object.values(c),u=r-o.applyWithChunking(Math.min,l);"l"!==a&&(u=i-o.applyWithChunking(Math.max,l)),u&&(e[s]=o.mapValues(c,(e=>e+u)))}))}))}function f(e,t){return o.mapValues(e.ul,((n,r)=>{if(t)return e[t.toLowerCase()][r];{let t=Object.values(e).map((e=>e[r])).sort(((e,t)=>e-t));return(t[1]+t[2])/2}}))}e.exports={positionX:function(e){let t,n=o.buildLayerMatrix(e),r=Object.assign(i(e,n),a(e,n)),s={};["u","d"].forEach((i=>{t="u"===i?n:Object.values(n).reverse(),["l","r"].forEach((n=>{"r"===n&&(t=t.map((e=>Object.values(e).reverse())));let a=("u"===i?e.predecessors:e.successors).bind(e),c=l(e,t,r,a),d=u(e,t,c.root,c.align,"r"===n);"r"===n&&(d=o.mapValues(d,(e=>-e))),s[i+n]=d}))}));let c=d(e,s);return h(s,c),f(s,e.graph().align)},findType1Conflicts:i,findType2Conflicts:a,addConflict:s,hasConflict:c,verticalAlignment:l,horizontalCompaction:u,alignCoordinates:h,findSmallestWidthAlignment:d,balance:f}},2839:function(e,t,n){var r=n(4168);e.exports=function(e){return r(e).filter((function(t){return t.length>1||1===t.length&&e.hasEdge(t[0],t[0])}))}},3061:function(e,t,n){"use strict";var r=n(3776),o=n(9294).slack,i=n(9294).longestPath,a=n(6743).alg.preorder,s=n(6743).alg.postorder,c=n(4809).simplify;function l(e){e=c(e),i(e);var t,n=r(e);for(h(n),u(n,e);t=m(n);)g(n,e,t,p(n,e,t))}function u(e,t){var n=s(e,e.nodes());(n=n.slice(0,n.length-1)).forEach((n=>function(e,t,n){var r=e.node(n),o=r.parent;e.edge(n,o).cutvalue=d(e,t,n)}(e,t,n)))}function d(e,t,n){var r=e.node(n).parent,o=!0,i=t.edge(n,r),a=0;return i||(o=!1,i=t.edge(r,n)),a=i.weight,t.nodeEdges(n).forEach((i=>{var s,c,l=i.v===n,u=l?i.w:i.v;if(u!==r){var d=l===o,h=t.edge(i).weight;if(a+=d?h:-h,s=n,c=u,e.hasEdge(s,c)){var f=e.edge(n,u).cutvalue;a+=d?-f:f}}})),a}function h(e,t){arguments.length<2&&(t=e.nodes()[0]),f(e,{},1,t)}function f(e,t,n,r,o){var i=n,a=e.node(r);return t[r]=!0,e.neighbors(r).forEach((o=>{Object.hasOwn(t,o)||(n=f(e,t,n,o,r))})),a.low=i,a.lim=n++,o?a.parent=o:delete a.parent,n}function m(e){return e.edges().find((t=>e.edge(t).cutvalue<0))}function p(e,t,n){var r=n.v,i=n.w;t.hasEdge(r,i)||(r=n.w,i=n.v);var a=e.node(r),s=e.node(i),c=a,l=!1;a.lim>s.lim&&(c=s,l=!0);var u=t.edges().filter((t=>l===y(e,e.node(t.v),c)&&l!==y(e,e.node(t.w),c)));return u.reduce(((e,n)=>o(t,n)<o(t,e)?n:e))}function g(e,t,n,r){var o=n.v,i=n.w;e.removeEdge(o,i),e.setEdge(r.v,r.w,{}),h(e),u(e,t),function(e,t){var n=e.nodes().find((e=>!t.node(e).parent)),r=a(e,n);(r=r.slice(1)).forEach((n=>{var r=e.node(n).parent,o=t.edge(n,r),i=!1;o||(o=t.edge(r,n),i=!0),t.node(n).rank=t.node(r).rank+(i?o.minlen:-o.minlen)}))}(e,t)}function y(e,t,n){return n.low<=t.lim&&t.lim<=n.lim}e.exports=l,l.initLowLimValues=h,l.initCutValues=u,l.calcCutValue=d,l.leaveEdge=m,l.enterEdge=p,l.exchangeEdges=g},3128:function(e,t,n){"use strict";n.d(t,{A:function(){return Pe}});var r=n(436),o=n(6540),i=n(3532),a=n(955),s=n(2941),c=n(180),l=n(2744);function u({title:e,titleId:t,...n},r){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},n),e?o.createElement("title",{id:t},e):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.325.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 0 1 1.37.49l1.296 2.247a1.125 1.125 0 0 1-.26 1.431l-1.003.827c-.293.241-.438.613-.43.992a7.723 7.723 0 0 1 0 .255c-.008.378.137.75.43.991l1.004.827c.424.35.534.955.26 1.43l-1.298 2.247a1.125 1.125 0 0 1-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.47 6.47 0 0 1-.22.128c-.331.183-.581.495-.644.869l-.213 1.281c-.09.543-.56.94-1.11.94h-2.594c-.55 0-1.019-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 0 1-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 0 1-1.369-.49l-1.297-2.247a1.125 1.125 0 0 1 .26-1.431l1.004-.827c.292-.24.437-.613.43-.991a6.932 6.932 0 0 1 0-.255c.007-.38-.138-.751-.43-.992l-1.004-.827a1.125 1.125 0 0 1-.26-1.43l1.297-2.247a1.125 1.125 0 0 1 1.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.086.22-.128.332-.183.582-.495.644-.869l.214-1.28Z"}),o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))}var d=o.forwardRef(u);function h({title:e,titleId:t,...n},r){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},n),e?o.createElement("title",{id:t},e):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 12 3.269 3.125A59.769 59.769 0 0 1 21.485 12 59.768 59.768 0 0 1 3.27 20.875L5.999 12Zm0 0h7.5"}))}var f=o.forwardRef(h);function m({title:e,titleId:t,...n},r){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},n),e?o.createElement("title",{id:t},e):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"}))}var p=o.forwardRef(m);function g(e){let{onSubmit:t,loading:n,error:r,disabled:i=!1}=e;const a=o.useRef(null),[s,c]=o.useState(n),[l,u]=o.useState(""),h="64px",m=i||n;o.useEffect((()=>{if(a.current){a.current.style.height=h;const e=a.current.scrollHeight;a.current.style.height=`${e}px`}}),[l]),o.useEffect((()=>{!s||n||r||g(),c(n)}),[n,r,s]);const g=()=>{a.current&&(a.current.value="",a.current.style.height=h,u(""))},y=()=>{var e;if(null!==(e=a.current)&&void 0!==e&&e.value&&!m){const e=a.current.value;t(e)}};return o.createElement("div",{className:"mt-2 w-full"},o.createElement("div",{className:"mt-2 rounded shadow-sm flex mb-1 "+(m?"opacity-50":"")},o.createElement("form",{className:"flex-1 relative",onSubmit:e=>{e.preventDefault(),y()}},o.createElement("textarea",{id:"queryInput",name:"queryInput",ref:a,defaultValue:"what is the height of the eiffel tower",onChange:e=>{u(e.target.value)},onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),y())},className:"flex items-center w-full resize-none text-gray-600 rounded border border-accent bg-white p-2 pl-5 pr-16 "+(m?"cursor-not-allowed":""),style:{maxHeight:"120px",overflowY:"auto",minHeight:"50px"},placeholder:"Type your message here...",disabled:m}),o.createElement("button",{type:"button",onClick:y,disabled:m,className:"absolute right-3 bottom-2 bg-accent transition duration-300 rounded flex justify-center items-center w-11 h-9 "+(m?"cursor-not-allowed":"hover:brightness-75")},n?o.createElement(d,{className:"text-white animate-spin rounded-full h-6 w-6"}):o.createElement(f,{className:"h-6 w-6 text-white"})))),r&&!r.status&&o.createElement("div",{className:"p-2 border rounded mt-4 text-orange-500 text-sm"},o.createElement(p,{className:"h-5 text-orange-500 inline-block mr-2"}),r.message))}var y=n(2197),v=n(9850),w=n(2640),x=n(1788);const b=(0,x.A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),E=(0,x.A)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);var _=n(4471),k=n(418);const N=(0,x.A)("CircleStop",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{x:"9",y:"9",width:"6",height:"6",rx:"1",key:"1ssd4o"}]]);var S=n(2102),M=n(5107);const C=(0,x.A)("PanelRightOpen",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M15 3v18",key:"14nvp0"}],["path",{d:"m10 15-3-3 3-3",key:"1pgupc"}]]),A=(0,x.A)("PanelRightClose",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M15 3v18",key:"14nvp0"}],["path",{d:"m8 9 3 3-3 3",key:"12hl5m"}]]);var O=n(1133),I=n(8057),T=n.n(I),z=(n(8280),n(2275));const P=(0,x.A)("CircleUser",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]),$=(0,x.A)("Flag",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]]);var L=function(e){let{data:t,isConnectable:n}=e;const r=(0,o.useCallback)((()=>{"end"!==t.type&&console.log(`${t.type} ${t.label} clicked`)}),[t.type,t.label]),i=(()=>{const e=t.isActive?"ring-2 ring-accent/50 ":"  ";return"end"===t.type?{wrapper:`relative min-w-[180px] shadow rounded-lg overflow-hidden  ${e}`,border:"complete"===t.status?"var(--accent)":"error"===t.status?"rgb(239 68 68)":"var(--secondary)"}:{wrapper:`min-w-[180px] rounded-lg shadow overflow-hidden ${e}`,border:void 0}})();return o.createElement("div",{className:i.wrapper,onClick:r,style:i.border?{borderColor:i.border}:void 0},o.createElement(O.h7,{type:"target",position:z.yX.Top,style:{background:"#555"},isConnectable:n,id:"target"}),o.createElement("div",{className:"flex agent-draghandle items-center gap-2 px-3 py-2 bg-secondary border-b border-border"},(()=>{switch(t.type){case"user":return o.createElement(P,{className:"text-primary",size:20});case"agent":return o.createElement(w.A,{className:"text-primary",size:20});case"end":return o.createElement($,{className:"text-primary",size:20})}})(),o.createElement("span",{className:"text-sm font-medium text-primary truncate"},t.label)),o.createElement("div",{className:"bg-tertiary px-3 py-2"},"end"===t.type?o.createElement(o.Fragment,null,o.createElement("div",{className:"flex items-center justify-center gap-2"},(()=>{if("end"!==t.type||!t.status)return null;switch(t.status){case"complete":return o.createElement(_.A,{className:"text-accent",size:24});case"error":return o.createElement(k.A,{className:"text-red-500",size:24});case"stopped":return o.createElement(N,{className:"text-red-500",size:24});default:return null}})(),o.createElement("span",{className:"text-primary text-sm font-medium"},t.status&&t.status.charAt(0).toUpperCase()+t.status.slice(1))),t.reason&&o.createElement("div",{className:"mt-1 text-xs text-secondary max-w-[200px] text-center"},t.reason.length>100?`${t.reason.substring(0,97)}...`:t.reason)):o.createElement(o.Fragment,null,t.agentType&&o.createElement("div",{className:"text-sm text-secondary"},t.agentType),t.description&&o.createElement("div",{className:"text-xs text-secondary mt-1 truncate max-w-[200px]"},t.description))),"end"!==t.type&&o.createElement(O.h7,{type:"source",position:z.yX.Bottom,id:"source",style:{background:"#555"},isConnectable:n}))};var j=n(5625),R=n(8603),D=n(468);const H=(0,x.A)("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);var B=n(6043),V=n(9492),F=n(942),Y=n(3324);const X=(0,x.A)("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]),G=(0,x.A)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),q=(0,x.A)("MessageSquareOff",[["path",{d:"M21 15V5a2 2 0 0 0-2-2H9",key:"43el77"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M3.6 3.6c-.4.3-.6.8-.6 1.4v16l4-4h10",key:"pwpm4a"}]]);var W=n(4718);const U=e=>{let{isFullscreen:t,onToggleFullscreen:n,onResetView:r}=e;const{agentFlow:i,setAgentFlowSettings:c}=(0,j.J)(),l=e=>()=>{c({[e]:!i[e]})},u=[{key:"grid",label:"Show Grid",icon:o.createElement(D.A,{size:16}),onClick:l("showGrid")},{key:"tokens",label:"Show Tokens",icon:o.createElement(H,{size:16}),onClick:l("showTokens")},{key:"miniMap",label:"Mini Map",icon:o.createElement(B.A,{size:16}),onClick:l("showMiniMap")},{type:"divider"},{key:"reset",label:"Reset View",icon:o.createElement(V.A,{size:16}),onClick:r,disabled:!r}];return o.createElement("div",{className:"absolute top-2 right-2 bg-secondary bg-opacity-70 hover:bg-secondary rounded backdrop-blur-sm z-50"},o.createElement("div",{className:"p-1 flex items-center gap-1"},o.createElement(a.A,{title:t?"Exit Fullscreen":"Enter Fullscreen"},o.createElement(s.Ay,{type:"text",icon:t?o.createElement(F.A,{size:18}):o.createElement(Y.A,{size:18}),className:"p-1.5 hover:bg-primary/10 rounded-md text-primary/75 hover:text-primary",onClick:n})),o.createElement(a.A,{title:`Switch to ${"TB"===i.direction?"Horizontal":"Vertical"} Layout`},o.createElement(s.Ay,{type:"text",icon:"TB"===i.direction?o.createElement(X,{size:18}):o.createElement(G,{size:18}),className:"p-1.5 hover:bg-primary/10 rounded-md text-primary/75 hover:text-primary",onClick:()=>c({direction:"TB"===i.direction?"LR":"TB"})})),o.createElement(a.A,{title:i.showLabels?"Hide Labels":"Show Labels"},o.createElement(s.Ay,{type:"text",icon:i.showLabels?o.createElement(E,{size:18}):o.createElement(q,{size:18}),className:"p-1.5 hover:bg-primary/10 rounded-md text-primary/75 hover:text-primary",onClick:l("showLabels")})),o.createElement(R.A,{menu:{items:u},trigger:["click"],getPopupContainer:e=>e.parentNode,overlayStyle:{zIndex:1e3}},o.createElement(s.Ay,{type:"text",icon:o.createElement(W.A,{size:18}),className:"p-1.5 hover:bg-primary/10 rounded-md text-primary/75 hover:text-primary",title:"More Options"}))))};var Z=n(9957),K=n(8458);const J=(0,x.A)("DraftingCompass",[["path",{d:"m12.99 6.74 1.93 3.44",key:"iwagvd"}],["path",{d:"M19.136 12a10 10 0 0 1-14.271 0",key:"ppmlo4"}],["path",{d:"m21 21-2.16-3.84",key:"vylbct"}],["path",{d:"m3 21 8.02-14.26",key:"1ssaw4"}],["circle",{cx:"12",cy:"5",r:"2",key:"f1ur92"}]]),Q=(0,x.A)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),ee=(0,x.A)("Bug",[["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M9 7.13v-1a3.003 3.003 0 1 1 6 0v1",key:"d7y7pr"}],["path",{d:"M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6",key:"xs1cw7"}],["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M6.53 9C4.6 8.8 3 7.1 3 5",key:"32zzws"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"M3 21c0-2.1 1.7-3.9 3.8-4",key:"4p0ekp"}],["path",{d:"M20.97 5c0 2.1-1.6 3.8-3.5 4",key:"18gb23"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M17.2 17c2.1.1 3.8 1.9 3.8 4",key:"k3fwyw"}]]);var te=n(2206),ne=n(8697),re=n(6813);const oe=e=>e>=1e3?`${(e/1e3).toFixed(1)}k`:e,ie=e=>{var t,n;let{event:r,onClose:i}=e;return o.createElement("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center transition-opacity duration-300",onClick:i},o.createElement("div",{className:"relative bg-primary w-full h-full md:w-4/5 md:h-4/5 md:rounded-lg p-8 overflow-auto",style:{opacity:.95},onClick:e=>e.stopPropagation()},o.createElement(a.A,{title:"Close"},o.createElement("button",{onClick:i,className:"absolute top-4 right-4 p-2 rounded-full bg-tertiary hover:bg-secondary text-primary transition-colors"},o.createElement(ne.A,{size:24}))),o.createElement("div",{className:"space-y-4"},o.createElement("div",{className:"flex items-center gap-2 mb-4"},o.createElement(re.A,{size:20,className:"text-accent"}),o.createElement("h3",{className:"text-lg font-medium"},"LLM Call Details"),o.createElement("h4",{className:"text-sm text-secondary"},r.agent_id.split("/")[0]," • ",r.response.model," •"," ",oe(r.response.usage.total_tokens)," tokens")),o.createElement("div",{className:"space-y-2"},o.createElement("h4",{className:"text-sm font-medium"},"Messages"),r.messages.map(((e,t)=>o.createElement("div",{key:t,className:"p-4 bg-tertiary rounded-lg"},o.createElement("div",{className:"flex justify-between mb-2"},o.createElement("span",{className:"text-xs font-medium uppercase text-secondary"},e.name&&`${e.name}`||e.role," ")),Array.isArray(e.content)?e.content.map(((e,t)=>o.createElement("div",{key:t,className:"text-sm text-secondary"},o.createElement(te.PA,{content:e,showFullscreen:!1})))):o.createElement(te.PA,{content:e.content,showFullscreen:!1}))))),r.response.choices&&o.createElement("div",{className:"space-y-2"},o.createElement("h4",{className:"text-sm font-medium"},"Response"),o.createElement("div",{className:"p-4 bg-tertiary rounded-lg"},o.createElement(te.PA,{content:null===(t=r.response)||void 0===t||null===(n=t.choices[0])||void 0===n?void 0:n.message.content,textThreshold:1e3}))),o.createElement("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-4"},o.createElement("div",{className:"p-3 bg-tertiary rounded-lg"},o.createElement("div",{className:"text-xs text-secondary mb-1"},"Model"),o.createElement("div",{className:"font-medium"},r.response.model)),o.createElement("div",{className:"p-3 bg-tertiary rounded-lg"},o.createElement("div",{className:"text-xs text-secondary mb-1"},"Prompt Tokens"),o.createElement("div",{className:"font-medium"},r.response.usage.prompt_tokens)),o.createElement("div",{className:"p-3 bg-tertiary rounded-lg"},o.createElement("div",{className:"text-xs text-secondary mb-1"},"Completion Tokens"),o.createElement("div",{className:"font-medium"},r.response.usage.completion_tokens)),o.createElement("div",{className:"p-3 bg-tertiary rounded-lg"},o.createElement("div",{className:"text-xs text-secondary mb-1"},"Total Tokens"),o.createElement("div",{className:"font-medium"},r.response.usage.total_tokens))))))};var ae=e=>{var t;let{content:n}=e;const{0:r,1:i}=(0,o.useState)(!1),s=(0,o.useMemo)((()=>{try{return JSON.parse(n)}catch(e){return console.error("Failed to parse LLM log content:",e),null}}),[n]);if(!s)return o.createElement("div",{className:"flex items-center gap-2 text-red-500 p-2 bg-red-500/10 rounded"},o.createElement(re.A,{size:16}),o.createElement("span",null,"Invalid log format"));const{messages:c,response:l,agent_id:u}=s,d=(null===(t=c[0])||void 0===t||t.name,l.usage.total_tokens),h=u?`${u.split("/")[0]}`:"";return o.createElement(o.Fragment,null,o.createElement("div",{className:"flex items-center gap-2 py-2   bg-secondary/20 rounded-lg text-sm text-secondary hover:text-primary transition-colors group"},o.createElement(re.A,{size:14,className:"text-accent"}),o.createElement("span",{className:"flex-1"},h?`${h}`:""," • ",l.model," •"," ",oe(d)," tokens"),o.createElement(a.A,{title:"View details"},o.createElement("button",{onClick:()=>i(!0),className:"p-1 mr-1 hover:bg-secondary rounded-md transition-colors"},o.createElement(Y.A,{size:14,className:"group-hover:text-accent"})))),r&&o.createElement(ie,{event:s,onClose:()=>i(!1)}))};const se=e=>e.url?e.url:e.data?`data:image/png;base64,${e.data}`:"/api/placeholder/400/320",ce=e=>{let{content:t}=e;return o.createElement("div",{className:"space-y-2"},t.map(((e,t)=>"string"==typeof e?o.createElement(te.PA,{key:t,content:e,className:"break-all"}):o.createElement(te.wx,{key:t,src:se(e),alt:e.alt||"Image",className:"w-full h-auto rounded border border-secondary"}))))},le=e=>{let{content:t}=e;return o.createElement("div",{className:"space-y-2"},t.map((e=>o.createElement("div",{key:e.id,className:"relative pl-3 border border-secondary rounded p-2"},o.createElement("div",{className:"absolute top-0 -left-0.5 w-1 bg-secondary h-full rounded"}),o.createElement("div",{className:"font-medium"},o.createElement(J,{className:"w-4 h-4 text-accent inline-block mr-1.5 -mt-0.5"})," ","Calling ",e.name," tool with arguments"),o.createElement(te.PA,{content:JSON.stringify(e.arguments,null,2),isJson:!0,className:"text-sm mt-1 bg-secondary p-2 rounded"})))))},ue=e=>{let{content:t}=e;return o.createElement("div",{className:"space-y-2"},t.map((e=>o.createElement("div",{key:e.call_id,className:"rounded p-2 pl-3 relative border border-secondary"},o.createElement("div",{className:"absolute top-0 -left-0.5 w-1 bg-secondary h-full rounded"}),o.createElement("div",{className:"font-medium"},o.createElement(J,{className:"w-4 text-accent h-4 inline-block mr-1.5 -mt-0.5"})," ","Tool Result"),o.createElement(te.PA,{content:e.content,className:"text-sm mt-1 bg-secondary p-2 border border-secondary rounded scroll overflow-x-scroll"})))))},de={isToolCallContent(e){return!!Array.isArray(e)&&e.every((e=>"object"==typeof e&&null!==e&&"id"in e&&"arguments"in e&&"name"in e))},isMultiModalContent(e){return!!Array.isArray(e)&&e.every((e=>"string"==typeof e||"object"==typeof e&&null!==e&&("url"in e||"data"in e)))},isFunctionExecutionResult(e){return!!Array.isArray(e)&&e.every((e=>"object"==typeof e&&null!==e&&"call_id"in e&&"content"in e))},isUser(e){return"user"===e}},he=e=>{let{message:t,isLast:n=!1,className:r=""}=e;if(!t)return null;const i=de.isUser(t.source),a=t.content,s="llm_call_event"===t.source;return o.createElement("div",{className:`relative group ${n?"":"mb-2"} ${r} ${s?"border-accent":""}`},o.createElement("div",{className:`\n        flex items-start gap-2 p-2 rounded\n        ${i?"bg-secondary":"bg-tertiary"}\n        border border-secondary\n        transition-all duration-200\n      `},o.createElement("div",{className:`\n          p-1.5 rounded bg-light \n          ${i?"text-accent":"text-primary"}\n        `},i?o.createElement(Q,{size:14}):"llm_call_event"==t.source?o.createElement(ee,{size:14}):o.createElement(w.A,{size:14})),o.createElement("div",{className:"flex-1 min-w-0"},o.createElement("div",{className:"flex items-center gap-2"},o.createElement("span",{className:"text-sm font-semibold text-primary"},t.source)),o.createElement("div",{className:"text-sm text-secondary"},de.isToolCallContent(a)?o.createElement(le,{content:a}):de.isMultiModalContent(a)?o.createElement(ce,{content:a}):de.isFunctionExecutionResult(a)?o.createElement(ue,{content:a}):"llm_call_event"===t.source?o.createElement(ae,{content:String(a)}):o.createElement(te.PA,{content:String(a),className:"break-all"})),t.models_usage&&o.createElement("div",{className:"text-xs text-secondary mt-1"},"Tokens:"," ",(t.models_usage.prompt_tokens||0)+(t.models_usage.completion_tokens||0)))))},{Search:fe}=Z.A,me=e=>{var t,n;let{open:r,onClose:i,edge:a}=e;const{0:s,1:c}=(0,o.useState)(""),l=(0,o.useMemo)((()=>{var e;return null!=a&&null!==(e=a.data)&&void 0!==e&&e.messages?a.data.messages.reduce(((e,t)=>{var n,r;return e+((null===(n=t.models_usage)||void 0===n?void 0:n.prompt_tokens)||0)+((null===(r=t.models_usage)||void 0===r?void 0:r.completion_tokens)||0)}),0):0}),[null==a||null===(t=a.data)||void 0===t?void 0:t.messages]),u=(0,o.useMemo)((()=>{var e;return null!=a&&null!==(e=a.data)&&void 0!==e&&e.messages?s?a.data.messages.filter((e=>"string"==typeof e.content&&e.content.toLowerCase().includes(s.toLowerCase()))):a.data.messages:[]}),[null==a||null===(n=a.data)||void 0===n?void 0:n.messages,s]);return a?o.createElement(K.A,{title:o.createElement("div",{className:"space-y-2"},o.createElement("div",{className:"font-medium"},a.source," → ",a.target),o.createElement("div",{className:"text-sm text-secondary flex justify-between"},a.data&&o.createElement("span",null,a.data.messages.length," message",""+(a.data.messages.length>1?"s":"")),o.createElement("span",null,l.toLocaleString()," tokens")),a.data&&a.data.messages.length>0&&o.createElement("div",{className:"text-xs py-2 font-normal"}," ","The above represents the number of times the ",`${a.target}`," ","node sent a message"," ",o.createElement("span",{className:"font-semibold underline text-accent"},"after")," ","the ",`${a.source}`," node."," ")),open:r,onCancel:i,width:800,footer:null},o.createElement("div",{className:"max-h-[70vh] overflow-y-auto space-y-4 scroll pr-2"},o.createElement(fe,{placeholder:"Search message content...",value:s,onChange:e=>c(e.target.value),allowClear:!0,className:"sticky top-0 z-10"}),o.createElement("div",{className:"space-y-4 "},u.map(((e,t)=>o.createElement(he,{key:t,message:e,isLast:t===u.length-1}))),0===u.length&&o.createElement("div",{className:"text-center text-secondary py-8"},"No messages found")))):null},pe={default:{width:170,height:100},end:{width:170,height:80},task:{width:170,height:100}},ge=function(e,t,n,r,o){void 0===r&&(r=!1);const i="active"===(null==o?void 0:o.status)||"awaiting_input"===(null==o?void 0:o.status);return"user"===t?{id:e,type:"agentNode",position:{x:0,y:0},data:{type:"user",label:"User",agentType:"user",description:"Human user",isActive:r,status:"",reason:"",draggable:!i}}:"end"===t?{id:e,type:"agentNode",position:{x:0,y:0},data:{type:"end",label:"End",status:null==o?void 0:o.status,reason:(null==o?void 0:o.error_message)||"",agentType:"",description:"",isActive:!1,draggable:!1}}:{id:e,type:"agentNode",position:{x:0,y:0},data:{type:"agent",label:e,agentType:(null==n?void 0:n.label)||"",description:(null==n?void 0:n.description)||"",isActive:r,status:"",reason:"",draggable:!i}}},ye={agentNode:L},ve={custom:e=>{var t;let{id:n,sourceX:r,sourceY:i,targetX:a,targetY:s,source:c,target:l,data:u,style:d={},markerEnd:h}=e;const f=c===l,m=d.strokeWidth||1,p=(null===(t=u.messages)||void 0===t?void 0:t.length)||0,g=f?Math.max(m,2):Math.min(Math.max(p,1),5)*m;let y="",v=0,w=0;if("secondary"===u.routingType||f){const e=140;y=`\n      M ${r},${i}\n      L ${r},${i+10}\n      L ${r+e},${i+10}\n      L ${r+e},${s-10}\n      L ${a},${s-10}\n      L ${a},${s}\n    `,v=r+e,w=(i+s)/2}else[y,v,w]=(0,z.oN)({sourceX:r,sourceY:i,targetX:a,targetY:s});const x=((e,t)=>{if(!u.routingType||f)return{x:e,y:t};u.routingType;const n="secondary"===u.routingType?-25:25,o=a-r,c=s-i;return{x:Math.abs(o)>Math.abs(c)?e:e+n,y:t+("secondary"===u.routingType?-20:20)}})(v,w);return o.createElement(o.Fragment,null,o.createElement("path",{id:n,className:"react-flow__edge-path",d:y,style:{...d,strokeWidth:g,stroke:"secondary"===u.routingType?"#0891b2":d.stroke},markerEnd:h}),(null==u?void 0:u.label)&&o.createElement(O.rV,null,o.createElement("div",{style:{position:"absolute",transform:`translate(-50%, -50%) translate(${x.x}px,${x.y}px)`,pointerEvents:"all",transition:"all 0.2s ease-in-out"},onClick:u.onClick},o.createElement("div",{className:"px-2 py-1 rounded bg-secondary hover:bg-tertiary text-primary   cursor-pointer transform hover:scale-110 transition-all flex items-center gap-1",style:{whiteSpace:"nowrap"}},p>0&&o.createElement("span",{className:"text-xs text-secondary"},"(",p,")"),o.createElement("span",{className:"text-sm"},u.label)))))}},we=e=>{let{teamConfig:t,run:n}=e;const{fitView:r}=(0,O.VH)(),{0:i,1:a}=(0,o.useState)([]),{0:s,1:c}=(0,o.useState)([]),{0:l,1:u}=(0,o.useState)(!1),{0:d,1:h}=(0,o.useState)(!1),{agentFlow:f}=(0,j.J)(),{0:m,1:p}=(0,o.useState)(!1),{0:g,1:y}=(0,o.useState)(null),v=(0,o.useCallback)((e=>{var t;null!==(t=e.data)&&void 0!==t&&t.messages&&(y(e),p(!0))}),[]),w=(0,o.useCallback)((e=>{a((t=>(0,O._0)(e,t)))}),[]),x=(0,o.useRef)(null);(0,o.useEffect)((()=>{if(l){const e=setTimeout((()=>{r({padding:.2,duration:200}),u(!1)}),100);return()=>clearTimeout(e)}}),[l,r]);const b=(0,o.useCallback)((e=>{if(!n.task)return{nodes:[],edges:[]};const r=new Map,o=new Map,i=new Map;if(e.length>0){var a,s,c;const o=t.config.participants.find((t=>{var n;return t.config.name===(null===(n=e[0])||void 0===n?void 0:n.source)}));r.set(null===(a=e[0])||void 0===a?void 0:a.source,ge(null===(s=e[0])||void 0===s?void 0:s.source,"user"===(null===(c=e[0])||void 0===c?void 0:c.source)?"user":"agent",o,!1,n))}for(let f=0;f<e.length-1;f++){const i=e[f],a=e[f+1],s=`${null==i?void 0:i.source}->${null==a?void 0:a.source}`;if(o.has(s)){var l,u;const e=o.get(s);e.count++,e.totalTokens+=((null==i||null===(l=i.models_usage)||void 0===l?void 0:l.prompt_tokens)||0)+((null==i||null===(u=i.models_usage)||void 0===u?void 0:u.completion_tokens)||0),e.messages.push(i)}else{var d,h;o.set(s,{source:null==i?void 0:i.source,target:null==a?void 0:a.source,count:1,totalTokens:((null==i||null===(d=i.models_usage)||void 0===d?void 0:d.prompt_tokens)||0)+((null==i||null===(h=i.models_usage)||void 0===h?void 0:h.completion_tokens)||0),messages:[i]})}if(!r.has(null==a?void 0:a.source)){const e=t.config.participants.find((e=>e.config.name===a.source));r.set(a.source,ge(a.source,"user"===a.source?"user":"agent",e,!1,n))}}o.forEach(((e,t)=>{const[n,r]=t.split("->"),a=`${r}->${n}`,s=o.get(a);if(s&&!i.has(t)){const t=[n,r].sort().join("->");i.set(t,{forward:e,reverse:s})}}));const m=[],p=new Set,g=e=>f.showLabels&&e.totalTokens>0?`${e.count>1?`${e.count}x`:""} ${f.showTokens?`(${e.totalTokens} tokens)`:""}`.trim():"";if(o.forEach(((e,t)=>{if(p.has(t))return;const[r,a]=t.split("->"),s=[r,a].sort().join("->");if(i.get(s)){const e=`${r}->${a}`,t=`${a}->${r}`,n=`${r}-${a}-forward`,i=`${a}-${r}-reverse`,s=(e,t,n,r)=>({id:n,source:e.source,target:e.target,type:"custom",data:{label:g(e),messages:f.showMessages?e.messages:[],routingType:t?"secondary":"primary",bidirectionalPair:r},style:{stroke:"#2563eb",strokeWidth:1}});m.push(s(o.get(e),!1,n,i),s(o.get(t),!0,i,n)),p.add(e),p.add(t)}else m.push({id:`${e.source}-${e.target}-${t}`,source:e.source,target:e.target,type:"custom",data:{label:g(e),messages:f.showMessages?e.messages:[]},animated:"active"===n.status&&t===Array.from(o.keys()).pop(),style:{stroke:"#2563eb",strokeWidth:1}})})),n&&e.length>0){const t=e[e.length-1];if(["complete","error","stopped"].includes(n.status)){r.set("end",ge("end","end",void 0,!1,n));const e={complete:"#2563eb",stopped:"red",error:"red",active:"#2563eb",awaiting_input:"#2563eb",timeout:"red",created:"#2563eb"}[n.status];m.push({id:`${null==t?void 0:t.source}-end`,source:null==t?void 0:t.source,target:"end",type:"custom",data:{label:f.showLabels?"ended":"",messages:[]},style:{stroke:e,strokeWidth:1,opacity:1,zIndex:100}})}}return{nodes:Array.from(r.values()),edges:m}}),[t.config.participants,n,f]),E=(0,o.useCallback)((()=>{h(!d),u(!0)}),[d]);(0,o.useEffect)((()=>{if(!d)return;const e=e=>{"Escape"===e.key&&E()};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)}),[d,E]),(0,o.useEffect)((()=>{const{nodes:e,edges:t}=b(n.messages.map((e=>e.config))),{nodes:o,edges:i}=((e,t,n)=>{const r=(new(T().graphlib.Graph)).setDefaultEdgeLabel((()=>({})));r.setGraph({rankdir:n,nodesep:110,ranksep:100,ranker:"network-simplex",marginx:30,marginy:30}),e.forEach((e=>{const t="end"===e.data.type?pe.end:pe.default;r.setNode(e.id,{...e,...t})}));const o=new Map;t.forEach((e=>{e.source,e.target,e.target,e.source;const t=[e.source,e.target].sort().join("-");o.has(t)||o.set(t,[]),o.get(t).push({source:e.source,target:e.target})})),o.forEach(((e,t)=>{if(2===e.length){const[t,n]=e;r.setEdge(t.source,t.target,{weight:2,minlen:1}),r.setEdge(n.source,n.target,{weight:1,minlen:1})}else{const t=e[0];r.setEdge(t.source,t.target,{weight:1,minlen:1})}})),T().layout(r);const i=e.map((e=>{const{x:t,y:n}=r.node(e.id),o="end"===e.data.type?pe.end:pe.default;return{...e,position:{x:t-o.width/2,y:n-o.height/2}}})),a=new Map(i.map((e=>[e.id,{x:e.position.x+pe.default.width/2,y:e.position.y+pe.default.height/2}])));return{nodes:i,edges:t.map((e=>{const t=a.get(e.source),n=a.get(e.target);return{...e,sourceX:t.x,sourceY:t.y,targetX:n.x,targetY:n.y}}))}})(e,t,f.direction);a(o),c(i),n.messages.length>0&&setTimeout((()=>{r({padding:.2,duration:200})}),50)}),[n.messages,b,f.direction,n.status,r]);const _={nodes:i,edges:s.map((e=>({...e,data:{...e.data,onClick:()=>v(e)}}))),nodeTypes:ye,edgeTypes:ve,defaultViewport:{x:0,y:0,zoom:1},minZoom:.5,maxZoom:2,onNodesChange:w,proOptions:{hideAttribution:!0}},k=(0,o.useMemo)((()=>({isFullscreen:d,onToggleFullscreen:E,onResetView:()=>r({padding:.2,duration:200})})),[d,E,r]);return o.createElement("div",{ref:x,className:`transition-all duration-200 ${d?"fixed inset-4 z-[50] shadow":"w-full h-full min-h-[300px]"} bg-tertiary rounded-lg`},d&&o.createElement("div",{className:"fixed inset-0 -z-10 bg-background/80 backdrop-blur-sm",onClick:E}),o.createElement(O.Gc,_,f.showGrid&&o.createElement(O.VS,null),f.showMiniMap&&o.createElement(O.of,null),o.createElement("div",{className:"absolute top-0 right-0 z-10"},o.createElement(U,k))),o.createElement(me,{open:m,onClose:()=>{p(!1),y(null)},edge:g}))};function xe(e){return o.createElement(O.Ln,null,o.createElement(we,e))}const be=(0,x.A)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),Ee=(0,x.A)("SendHorizontal",[["path",{d:"M3.714 3.048a.498.498 0 0 0-.683.627l2.843 7.627a2 2 0 0 1 0 1.396l-2.842 7.627a.498.498 0 0 0 .682.627l18-8.5a.5.5 0 0 0 0-.904z",key:"117uat"}],["path",{d:"M6 12h16",key:"s4cdu5"}]]),_e={DURATION_MS:18e4,DURATION_SEC:180,WEBSOCKET_CODE:4e3,DEFAULT_MESSAGE:"Input timeout after 3 minutes",WARNING_THRESHOLD_SEC:30};var ke=e=>{let{prompt:t,onSubmit:n,disabled:r=!1,onTimeout:i}=e;const[a,s]=o.useState(""),[c,l]=o.useState(!1),[u,d]=o.useState(_e.DURATION_SEC),[h,f]=o.useState(!1),m=o.useRef(null),p=(0,o.useRef)();(0,o.useEffect)((()=>(r||(p.current=setInterval((()=>{d((e=>e<=1?(clearInterval(p.current),null==i||i(),0):e-1))}),1e3)),()=>{p.current&&clearInterval(p.current)})),[r,i]),o.useEffect((()=>{m.current&&!r&&m.current.focus()}),[r]);const g=async()=>{if(a.trim()&&!r&&!c){l(!0);try{await n(a.trim()),s(""),f(!1)}finally{l(!1)}}};return o.createElement("div",{className:"p-4 bg-accent/10 border border-accent/20 rounded-lg mt-3 "+(r?"opacity-50":"")},o.createElement("div",{className:"flex justify-between items-center mb-2"},o.createElement("div",{className:"text-sm font-medium text-primary flex items-center gap-2"},t,!h&&!r&&o.createElement("span",{className:"relative flex h-3 w-3"},o.createElement("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-accent opacity-75"}),o.createElement("span",{className:"relative inline-flex rounded-full h-3 w-3 bg-accent"}))),!r&&o.createElement("div",{className:"flex items-center gap-2 text-sm"},o.createElement(be,{size:14,className:"text-accent"}),o.createElement("span",{className:u<_e.WARNING_THRESHOLD_SEC?"text-red-500 font-bold animate-pulse":"text-accent"},(y=u,`${Math.floor(y/60)}:${(y%60).toString().padStart(2,"0")}`)))),o.createElement("div",{className:"flex gap-2"},o.createElement("input",{ref:m,type:"text",value:a,onChange:e=>{s(e.target.value),h||f(!0)},onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),g())},disabled:r||c,className:"text-primary flex-1 px-3 py-2 rounded bg-tertiary border border-secondary focus:border-accent focus:ring-1 focus:ring-accent outline-none disabled:opacity-50",placeholder:r?"Input timeout - please restart the conversation":"Type your response..."}),o.createElement("button",{onClick:g,disabled:r||c||!a.trim(),className:"px-4 py-2 rounded bg-accent text-white hover:bg-accent/90 disabled:opacity-50 disabled:hover:bg-accent flex items-center gap-2 transition-all "+(h||r||a.trim()?"":"animate-pulse")},c?o.createElement(b,{size:16,className:"animate-spin"}):o.createElement(Ee,{size:16}),o.createElement("span",null,"Submit"))));var y},Ne=n(1325);const Se=e=>{let{content:t,source:n}=e;const{0:r,1:i}=(0,o.useState)(!0);return(0,o.useEffect)((()=>{const e=setInterval((()=>{i((e=>!e))}),530);return()=>clearInterval(e)}),[]),o.createElement("div",{className:"flex items-start gap-2 p-2 rounded bg-tertiary border border-secondary transition-all duration-200 mb-6"},o.createElement("div",{className:"p-1.5 rounded bg-light text-primary"},o.createElement(w.A,{size:14})),o.createElement("div",{className:"flex-1 min-w-0"},o.createElement("div",{className:"flex items-center gap-2"},o.createElement("span",{className:"text-sm font-semibold text-primary"},n)),o.createElement("div",{className:"text-sm text-secondary break-all"},t,r&&o.createElement("span",{className:"inline-block w-2 h-4 ml-1 bg-accent/70 animate-pulse"}))))},Me=e=>e.filter((e=>"llm_call_event"!==e.config.source));var Ce=e=>{var t,n,r,i,s;let{run:c,onInputResponse:l,onCancel:u,teamConfig:d,isFirstRun:h=!1,streamingContent:f}=e;const{0:m,1:p}=(0,o.useState)(!0),g=(0,o.useRef)(null),y="active"===c.status||"awaiting_input"===c.status,{uiSettings:v}=(0,Ne.C)(),{0:x,1:O}=(0,o.useState)(null===(t=v.show_agent_flow_by_default)||void 0===t||t),I=(0,o.useMemo)((()=>v.show_llm_call_events?c.messages:c.messages.filter((e=>"llm_call_event"!==e.config.source))),[c.messages,v.show_llm_call_events]);(0,o.useEffect)((()=>{setTimeout((()=>{g.current&&g.current.scrollTo({top:g.current.scrollHeight,behavior:"smooth"})}),450)}),[c.messages,f]);const T=e=>{switch(e){case"active":return o.createElement("div",{className:"inline-block mr-1"},o.createElement(b,{size:20,className:"inline-block mr-1 text-accent animate-spin"}),o.createElement("span",{className:"inline-block mr-2 ml-1 "},"Processing"),o.createElement(te.XC,{size:8}));case"awaiting_input":return o.createElement("div",{className:"text-sm mb-2"},o.createElement(E,{size:20,className:"inline-block mr-2 text-accent"}),o.createElement("span",{className:"inline-block mr-2"},"Waiting for your input "),o.createElement(te.XC,{size:8}));case"complete":return o.createElement("div",{className:"text-sm mb-2"},o.createElement(_.A,{size:20,className:"inline-block mr-2 text-accent"}),"Task completed");case"error":return o.createElement("div",{className:"text-sm mb-2"},o.createElement(k.A,{size:20,className:"inline-block mr-2 text-red-500"}),c.error_message||"An error occurred");case"stopped":return o.createElement("div",{className:"text-sm mb-2"},o.createElement(N,{size:20,className:"inline-block mr-2 text-red-500"}),"Task was stopped");default:return null}},z=null===(n=c.team_result)||void 0===n||null===(r=n.task_result)||void 0===r?void 0:r.messages.slice(-1)[0],P=I.filter((e=>"llm_call_event"!==e.config.source)).slice(-1)[0];return o.createElement("div",{className:"space-y-6  mr-2 "},o.createElement("div",{className:(h?"mb-2":"mt-4")+" mb-4 pb-2 pt-2 border-b border-dashed border-secondary"},o.createElement("div",{className:"text-xs text-secondary"},o.createElement(a.A,{title:o.createElement("div",{className:"text-xs"},o.createElement("div",null,"ID: ",c.id),o.createElement("div",null,"Created: ",new Date(c.created_at).toLocaleString()),o.createElement("div",null,"Status: ",c.status))},o.createElement("span",{className:"cursor-help"},"Run ...",c.id," | ",(0,te.vq)((null==c?void 0:c.created_at)||"")," ")),!h&&o.createElement(o.Fragment,null," ","|"," ",o.createElement(k.A,{className:"w-4 h-4 -mt-1 inline-block mr-1 ml-1"}),"Note: Each run does not share data with previous runs in the same session yet."))),o.createElement("div",{className:"flex flex-col items-end w-full"},o.createElement("div",{className:"w-full"},o.createElement(he,{message:c.task,isLast:!1}))),o.createElement("div",{className:"flex flex-col items-start"},o.createElement("div",{className:"flex items-center gap-2 mb-1"},o.createElement("div",{className:"p-1.5 rounded bg-secondary text-primary"},o.createElement(w.A,{size:20})),o.createElement("span",{className:"text-sm font-medium text-primary"},"Agent Team")),o.createElement("div",{className:"   w-full"},o.createElement("div",{className:"p-4 bg-secondary border border-secondary rounded"},o.createElement("div",{className:"flex justify-between items-start mb-2"},o.createElement("div",{className:"text-primary"},T(c.status)),y&&u&&o.createElement("button",{onClick:u,className:"px-4 text-sm py-2 bg-red-500 hover:bg-red-600 text-white rounded-md transition-colors flex items-center gap-2"},o.createElement(N,{size:16}),"Cancel Run")),"awaiting_input"!==c.status&&"active"!==c.status&&o.createElement("div",{className:"text-sm break-all"},o.createElement("div",{className:"text-xs bg-tertiary mb-1 text-secondary border-secondary -mt-2 bdorder rounded p-2"},"Stop reason: ",null===(i=c.team_result)||void 0===i||null===(s=i.task_result)||void 0===s?void 0:s.stop_reason),P?o.createElement(he,{message:P.config,isLast:!0}):o.createElement(o.Fragment,null,z&&o.createElement(he,{message:z})))),o.createElement("div",{className:""},I.length>0&&o.createElement("div",{className:"mt-2 pl-4 border-secondary rounded-b border-l-2 border-secondary/30"},o.createElement("div",{className:"flex pt-2"},o.createElement("div",{className:"flex-1"},o.createElement("button",{onClick:()=>p(!m),className:"flex items-center gap-1 text-sm text-secondary hover:text-primary transition-colors"},o.createElement(E,{size:16})," Agent steps [",o.createElement("span",{className:"text-accent text-xs"},m?o.createElement("span",null,o.createElement(S.A,{size:16,className:"inline-block mr-1"}),"Hide"):o.createElement("span",null," ",o.createElement(M.A,{size:16,className:"inline-block mr-1"})," ","Show more"))," ","]")),o.createElement("div",{className:"text-sm text-secondary"},(e=>e.reduce(((e,t)=>{var n;return null!==(n=t.config)&&void 0!==n&&n.models_usage?e+(t.config.models_usage.prompt_tokens||0)+(t.config.models_usage.completion_tokens||0):e}),0))(I)," tokens |"," ",I.length," messages")),m&&o.createElement("div",{className:"flex relative flex-row gap-4"},!x&&o.createElement("div",{className:"z-50 absolute right-2 top-2 bg-tertiary rounded p-2 hover:opacity-100 opacity-80"},o.createElement(a.A,{title:"Show message flow graph"},o.createElement("button",{onClick:()=>O(!0),className:" p-1 rounded-md bg-tertiary  hover:bg-secondary  transition-colors"},o.createElement(C,{strokeWidth:1.5,size:22})))),o.createElement("div",{ref:g,className:"flex-1 mt-2 overflow-y-auto max-h-[400px] scroll-smooth scroll pb-2 relative"},o.createElement("div",{id:"scroll-gradient",className:"scroll-gradient h-8"}," ",o.createElement("span",{className:"  inline-block h-6"})," "),I.map(((e,t)=>o.createElement("div",{key:"message_id"+t+c.id,className:"  mr-2"},o.createElement(he,{message:e.config,isLast:t===I.length-1})))),f&&f.runId===c.id&&o.createElement("div",{className:"mr-2 mb-10"},o.createElement(Se,{content:f.content,source:f.source})),"awaiting_input"===c.status&&l&&o.createElement("div",{className:"mt-4 mr-2"},o.createElement(ke,{prompt:"Type your response...",onSubmit:l})),o.createElement("div",{className:"text-primary mt-2"},o.createElement("div",{className:"w-4 h-4 inline-block  border-secondary rounded-bl-lg border-l-2 border-b-2"})," ",o.createElement("div",{className:"inline-block "},T(c.status)))),x&&o.createElement("div",{className:"bg-tertiary flex-1 rounded mt-2 relative"},o.createElement("div",{className:"z-10 absolute left-2 top-2 p-2 hover:opacity-100 opacity-80"},o.createElement(a.A,{title:"Hide message flow"},o.createElement("button",{onClick:()=>O(!1),className:" p-1 rounded-md bg-tertiary hover:bg-secondary transition-colors"},o.createElement(A,{strokeWidth:1.5,size:22})))),d&&o.createElement(xe,{teamConfig:d,run:{...c,messages:Me(I)}}))))))))},Ae=n(7677);const Oe=(0,x.A)("SquareSplitHorizontal",[["path",{d:"M8 19H5c-1 0-2-1-2-2V7c0-1 1-2 2-2h3",key:"lubmu8"}],["path",{d:"M16 5h3c1 0 2 1 2 2v10c0 1-1 2-2 2h-3",key:"1ag34g"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]);var Ie=n(5061),Te=n(7015);var ze=e=>{let{session:t,availableSessions:n,onSessionChange:i,className:s=""}=e;const[c,l]=o.useState(""),u=n.filter((e=>e.name.toLowerCase().includes(c.toLowerCase()))),d=[{type:"group",key:"search-sessions",label:o.createElement("div",null,o.createElement("div",{className:"text-xs text-secondary mb-1"},"Search sessions"),o.createElement(Z.A,{prefix:o.createElement(Te.A,{className:"w-4 h-4"}),placeholder:"Search sessions",onChange:e=>l(e.target.value),onClick:e=>e.stopPropagation()}))},{type:"divider"}].concat((0,r.A)(u.map((e=>({key:(e.id||"").toString(),label:o.createElement("div",{className:"py-1"},o.createElement("div",{className:"font-medium"},e.name),o.createElement("div",{className:"text-xs text-secondary"},(0,te.vq)(e.updated_at||"")))})))));return o.createElement(R.A,{menu:{items:d,onClick:e=>{let{key:t}=e;const r=n.find((e=>e.id===Number(t)));r&&i(r)}},trigger:["click"]},o.createElement("div",{className:`cursor-pointer flex items-center gap-2 min-w-0 ${s}`},o.createElement(a.A,{title:null==t?void 0:t.name},o.createElement("span",{className:"text-primary font-medium truncate overflow-hidden"},(null==t?void 0:t.name)||"Select Session")),o.createElement(M.A,{className:"w-4 h-4 text-secondary flex-shrink-0"})))};n(8351).A;function Pe(e){let{session:t,isCompareMode:n=!1,isSecondaryView:u=!1,onCompareClick:d,onExitCompare:h,onSessionChange:f,availableSessions:m=[],showCompareButton:p=!0}=e;const w=(0,c.Tt)(),[x,b]=o.useState(!1),[E,_]=o.useState({status:!0,message:"All good"}),[k,N]=o.useState([]),[S,M]=o.useState(null),[C,A]=i.Ay.useMessage(),O=o.useRef(null),[I,T]=o.useState(null),{user:z}=o.useContext(l.v),[P,$]=o.useState(null),[L,j]=o.useState(null),R=o.useRef(null),D=o.useRef(null),H=(e,t,n)=>({created_at:(new Date).toISOString(),updated_at:(new Date).toISOString(),config:e,session_id:n,run_id:t,user_id:(null==z?void 0:z.id)||void 0});o.useEffect((()=>{null!=t&&t.id?((async()=>{if(null!=t&&t.id&&null!=z&&z.id)try{const e=await v.j.getSessionRuns(t.id,z.id);N(e.runs)}catch(E){console.error("Error loading session runs:",E),C.error("Failed to load chat history")}})(),M(null)):(N([]),M(null))}),[null==t?void 0:t.id]),o.useEffect((()=>{null!=t&&t.team_id&&null!=z&&z.id&&y.CG.getTeam(t.team_id,z.id).then((e=>{j(e.component)})).catch((e=>{console.error("Error loading team config:",e),j(null)}))}),[t]),o.useEffect((()=>{setTimeout((()=>{O.current&&k.length>0&&O.current.scrollTo({top:O.current.scrollHeight,behavior:"auto"})}),450)}),[k.length,null==S?void 0:S.messages]),o.useEffect((()=>()=>{R.current&&clearTimeout(R.current),null==P||P.close()}),[P]);const B=e=>{console.error("Error:",e),i.Ay.error("Error during request processing"),M((t=>{if(!t)return null;const n={...t,status:"error",error_message:e instanceof Error?e.message:"Unknown error occurred"};return N((e=>[].concat((0,r.A)(e),[n]))),null})),_({status:!1,message:e instanceof Error?e.message:"Unknown error occurred"})},V=(e,n)=>{if(!t||!t.id)throw new Error("Invalid session configuration");(null==P?void 0:P.readyState)===WebSocket.OPEN&&P.close();const o=F(w),i="https:"===window.location.protocol?"wss:":"ws:",a=localStorage.getItem("auth_token"),s=new WebSocket(`${i}//${o}/api/ws/runs/${e}?token=${a}`);return M({id:e,created_at:(new Date).toISOString(),status:"active",task:H({content:n,source:"user"},e,t.id||0).config,team_result:null,messages:[],error_message:void 0}),s.onopen=()=>{s.send(JSON.stringify({type:"start",task:n,team_config:L}))},s.onmessage=e=>{try{(e=>{M((n=>{if(!n||null==t||!t.id)return null;switch(e.type){case"error":R.current&&(clearTimeout(R.current),R.current=null),P&&(P.close(),$(null),D.current=null),console.log("Error: ",e.error);const o={...n,status:"error",error_message:e.error||"An error occurred"};return N((e=>[].concat((0,r.A)(e),[o]))),null;case"message_chunk":if(!e.data)return n;try{const t=e.data;T((e=>({runId:n.id,content:((null==e?void 0:e.content)||"")+(t.content||""),source:t.source||"assistant"})))}catch(E){console.error("Error parsing message chunk:",E)}return n;case"message":if(T(null),!e.data)return n;const i=H(e.data,n.id,t.id);return{...n,messages:[].concat((0,r.A)(n.messages),[i])};case"input_request":return R.current&&clearTimeout(R.current),R.current=setTimeout((()=>{const e=D.current;console.log("Input timeout",e),(null==e?void 0:e.readyState)===WebSocket.OPEN&&(e.send(JSON.stringify({type:"stop",reason:_e.DEFAULT_MESSAGE,code:_e.WEBSOCKET_CODE})),M((e=>e?{...e,status:"stopped",error_message:_e.DEFAULT_MESSAGE}:null)))}),_e.DURATION_MS),{...n,status:"awaiting_input"};case"result":case"completion":const a="complete"===e.status?"complete":"error"===e.status?"error":"stopped",s=e=>e&&"task_result"in e&&"usage"in e&&"duration"in e,c={...n,status:a,team_result:e.data&&s(e.data)?e.data:null};return"complete"===a?(R.current&&(clearTimeout(R.current),R.current=null),P&&(P.close(),$(null),D.current=null),N((e=>[].concat((0,r.A)(e),[c]))),null):c;default:return n}}))})(JSON.parse(e.data))}catch(E){console.error("WebSocket message parsing error:",E)}},s.onclose=()=>{D.current=null,$(null)},s.onerror=e=>{B(e)},s},F=e=>{try{let t=e.replace(/(^\w+:|^)\/\//,"");return t=t.startsWith("localhost")?t.replace("/api",""):"/api"===t?window.location.host:t.replace("/api","").replace(/\/$/,""),t}catch(E){throw console.error("Error processing server URL:",E),new Error("Invalid server URL configuration")}};return o.createElement("div",{className:"text-primary h-[calc(100vh-165px)] bg-primary relative rounded flex-1 scroll"},A,o.createElement("div",{className:"flex pt-2 items-center justify-between text-sm h-10"},o.createElement("div",{className:"flex items-center gap-2 min-w-0 overflow-hidden flex-1 pr-4"},n?o.createElement(ze,{session:t,availableSessions:m,onSessionChange:f||(()=>{}),className:"w-full"}):o.createElement(o.Fragment,null,o.createElement("span",{className:"text-primary font-medium whitespace-nowrap flex-shrink-0"},"Sessions"),t&&o.createElement(o.Fragment,null,o.createElement(Ae.A,{className:"w-4 h-4 text-secondary flex-shrink-0"}),o.createElement(a.A,{title:t.name},o.createElement("span",{className:"text-secondary truncate overflow-hidden"},t.name))))),o.createElement("div",{className:"flex items-center gap-2 flex-shrink-0 whitespace-nowrap"},!n&&!u&&p&&o.createElement(s.Ay,{type:"text",onClick:d,icon:o.createElement(Oe,{className:"w-4 h-4"})},"Compare"),n&&u&&o.createElement(s.Ay,{type:"text",onClick:h,icon:o.createElement(ne.A,{className:"w-4 h-4"})},"Exit Compare"))),o.createElement("div",{className:"flex flex-col h-full"},o.createElement("div",{ref:O,className:"flex-1 overflow-y-auto scroll mt-2 min-h-0 relative"},o.createElement("div",{id:"scroll-gradient",className:"scroll-gradient h-8 top-0"}," ",o.createElement("span",{className:"  inline-block h-6"})," "),o.createElement(o.Fragment,null,L&&o.createElement(o.Fragment,null,k.map(((e,t)=>o.createElement(Ce,{teamConfig:L,key:e.id+"-review-"+t,run:e,isFirstRun:0===t}))),S&&o.createElement(Ce,{run:S,teamConfig:L,onInputResponse:async e=>{if(D.current&&S){if(D.current.readyState!==WebSocket.OPEN)return console.error("Socket not in OPEN state:",D.current.readyState),void B(new Error("WebSocket connection not available"));R.current&&(clearTimeout(R.current),R.current=null);try{D.current.send(JSON.stringify({type:"input_response",response:e})),M((e=>e?{...e,status:"active"}:null))}catch(E){B(E)}}},onCancel:async()=>{if(D.current&&S){R.current&&(clearTimeout(R.current),R.current=null);try{D.current.send(JSON.stringify({type:"stop",reason:"Cancelled by user"})),M((e=>e?{...e,status:"stopped"}:null))}catch(E){B(E)}}},isFirstRun:0===k.length,streamingContent:I}),!S&&0===k.length&&o.createElement("div",{className:"flex items-center justify-center h-[80%]"},o.createElement("div",{className:"text-center"},o.createElement(Ie.A,{strokeWidth:1,className:"w-64 h-64 mb-4 inline-block"}),o.createElement("div",{className:"  font-medium mb-2"},"Start a new task"),o.createElement("div",{className:"text-secondary text-sm"},"Enter a task to get started")))),!L&&o.createElement("div",{className:"flex items-center justify-center h-[80%]"},o.createElement("div",{className:"text-center  "},o.createElement(Ie.A,{strokeWidth:1,className:"w-64 h-64 mb-4 inline-block"}),o.createElement("div",{className:"  font-medium mb-2"},"No team configuration found for this session (may have been deleted)."," "),o.createElement("div",{className:"text-secondary text-sm"},"Add a team to the session to get started."))))),t&&L&&o.createElement("div",{className:"flex-shrink-0"},o.createElement(g,{onSubmit:async e=>{if(_(null),b(!0),P&&(P.close(),$(null),D.current=null),R.current&&(clearTimeout(R.current),R.current=null),null!=t&&t.id&&L)try{const n=await(async e=>await v.j.createRun(e,(null==z?void 0:z.id)||""))(t.id);M({id:n,created_at:(new Date).toISOString(),status:"created",messages:[],task:{content:e,source:"user"},team_result:null,error_message:void 0});const r=V(n,e);$(r),D.current=r}catch(E){B(E)}finally{b(!1)}else b(!1)},loading:x,error:E,disabled:"awaiting_input"===(null==S?void 0:S.status)}))))}},3535:function(e,t,n){let r=n(6361),o=n(3900),i=n(7204);e.exports=function e(t,n,a,s){let c=t.children(n),l=t.node(n),u=l?l.borderLeft:void 0,d=l?l.borderRight:void 0,h={};u&&(c=c.filter((e=>e!==u&&e!==d)));let f=r(t,c);f.forEach((n=>{if(t.children(n.v).length){let i=e(t,n.v,a,s);h[n.v]=i,Object.hasOwn(i,"barycenter")&&(o=i,void 0!==(r=n).barycenter?(r.barycenter=(r.barycenter*r.weight+o.barycenter*o.weight)/(r.weight+o.weight),r.weight+=o.weight):(r.barycenter=o.barycenter,r.weight=o.weight))}var r,o}));let m=o(f,a);!function(e,t){e.forEach((e=>{e.vs=e.vs.flatMap((e=>t[e]?t[e].vs:e))}))}(m,h);let p=i(m,s);if(u&&(p.vs=[u,p.vs,d].flat(!0),t.predecessors(u).length)){let e=t.node(t.predecessors(u)[0]),n=t.node(t.predecessors(d)[0]);Object.hasOwn(p,"barycenter")||(p.barycenter=0,p.weight=0),p.barycenter=(p.barycenter*p.weight+e.order+n.order)/(p.weight+2),p.weight+=2}return p}},3776:function(e,t,n){"use strict";var r=n(6743).Graph,o=n(9294).slack;function i(e,t){return e.nodes().forEach((function n(r){t.nodeEdges(r).forEach((i=>{var a=i.v,s=r===a?i.w:a;e.hasNode(s)||o(t,i)||(e.setNode(s,{}),e.setEdge(r,s,{}),n(s))}))})),e.nodeCount()}function a(e,t){return t.edges().reduce(((n,r)=>{let i=Number.POSITIVE_INFINITY;return e.hasNode(r.v)!==e.hasNode(r.w)&&(i=o(t,r)),i<n[0]?[i,r]:n}),[Number.POSITIVE_INFINITY,null])[1]}function s(e,t,n){e.nodes().forEach((e=>t.node(e).rank+=n))}e.exports=function(e){var t,n,c=new r({directed:!1}),l=e.nodes()[0],u=e.nodeCount();c.setNode(l,{});for(;i(c,e)<u;)t=a(c,e),n=c.hasNode(t.v)?o(e,t):-o(e,t),s(c,e,n);return c}},3843:function(e,t,n){let r=n(6743).Graph,o=n(4809);e.exports=function(e,t,n){let i=function(e){var t;for(;e.hasNode(t=o.uniqueId("_root")););return t}(e),a=new r({compound:!0}).setGraph({root:i}).setDefaultNodeLabel((t=>e.node(t)));return e.nodes().forEach((r=>{let o=e.node(r),s=e.parent(r);(o.rank===t||o.minRank<=t&&t<=o.maxRank)&&(a.setNode(r),a.setParent(r,s||i),e[n](r).forEach((t=>{let n=t.v===r?t.w:t.v,o=a.edge(n,r),i=void 0!==o?o.weight:0;a.setEdge(n,r,{weight:e.edge(t).weight+i})})),Object.hasOwn(o,"minRank")&&a.setNode(r,{borderLeft:o.borderLeft[t],borderRight:o.borderRight[t]}))})),a}},3900:function(e,t,n){"use strict";let r=n(4809);e.exports=function(e,t){let n={};return e.forEach(((e,t)=>{let r=n[e.v]={indegree:0,in:[],out:[],vs:[e.v],i:t};void 0!==e.barycenter&&(r.barycenter=e.barycenter,r.weight=e.weight)})),t.edges().forEach((e=>{let t=n[e.v],r=n[e.w];void 0!==t&&void 0!==r&&(r.indegree++,t.out.push(n[e.w]))})),function(e){let t=[];function n(e){return t=>{t.merged||(void 0===t.barycenter||void 0===e.barycenter||t.barycenter>=e.barycenter)&&function(e,t){let n=0,r=0;e.weight&&(n+=e.barycenter*e.weight,r+=e.weight);t.weight&&(n+=t.barycenter*t.weight,r+=t.weight);e.vs=t.vs.concat(e.vs),e.barycenter=n/r,e.weight=r,e.i=Math.min(t.i,e.i),t.merged=!0}(e,t)}}function o(t){return n=>{n.in.push(t),0==--n.indegree&&e.push(n)}}for(;e.length;){let r=e.pop();t.push(r),r.in.reverse().forEach(n(r)),r.out.forEach(o(r))}return t.filter((e=>!e.merged)).map((e=>r.pick(e,["vs","i","barycenter","weight"])))}(Object.values(n).filter((e=>!e.indegree)))}},3933:function(e){function t(e,t,n,o){for(var i=[[e,!1]];i.length>0;){var a=i.pop();a[1]?o.push(a[0]):Object.hasOwn(n,a[0])||(n[a[0]]=!0,i.push([a[0],!0]),r(t(a[0]),(e=>i.push([e,!1]))))}}function n(e,t,n,o){for(var i=[e];i.length>0;){var a=i.pop();Object.hasOwn(n,a)||(n[a]=!0,o.push(a),r(t(a),(e=>i.push(e))))}}function r(e,t){for(var n=e.length;n--;)t(e[n],n,e);return e}e.exports=function(e,r,o){Array.isArray(r)||(r=[r]);var i=e.isDirected()?t=>e.successors(t):t=>e.neighbors(t),a="post"===o?t:n,s=[],c={};return r.forEach((t=>{if(!e.hasNode(t))throw new Error("Graph does not have node: "+t);a(t,i,c,s)})),s}},3973:function(e,t,n){"use strict";function r(e,t){if(Object.is(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[n,r]of e)if(!Object.is(r,t.get(n)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const r of n)if(!Object.prototype.hasOwnProperty.call(t,r)||!Object.is(e[r],t[r]))return!1;return!0}n.d(t,{x:function(){return r}})},4060:function(e,t,n){"use strict";n.d(t,{A:function(){return r}});const r=(0,n(1788).A)("RefreshCcw",[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]])},4168:function(e){e.exports=function(e){var t=0,n=[],r={},o=[];function i(a){var s=r[a]={onStack:!0,lowlink:t,index:t++};if(n.push(a),e.successors(a).forEach((function(e){Object.hasOwn(r,e)?r[e].onStack&&(s.lowlink=Math.min(s.lowlink,r[e].index)):(i(e),s.lowlink=Math.min(s.lowlink,r[e].lowlink))})),s.lowlink===s.index){var c,l=[];do{c=n.pop(),r[c].onStack=!1,l.push(c)}while(a!==c);o.push(l)}}return e.nodes().forEach((function(e){Object.hasOwn(r,e)||i(e)})),o}},4318:function(e,t,n){var r=n(6316);e.exports=function(e,t,n,i){return function(e,t,n,o){var i,a,s={},c=new r,l=function(e){var t=e.v!==i?e.v:e.w,r=s[t],o=n(e),l=a.distance+o;if(o<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+e+" Weight: "+o);l<r.distance&&(r.distance=l,r.predecessor=i,c.decrease(t,l))};e.nodes().forEach((function(e){var n=e===t?0:Number.POSITIVE_INFINITY;s[e]={distance:n},c.add(e,n)}));for(;c.size()>0&&(i=c.removeMin(),(a=s[i]).distance!==Number.POSITIVE_INFINITY);)o(i).forEach(l);return s}(e,String(t),n||o,i||function(t){return e.outEdges(t)})};var o=()=>1},4371:function(e,t,n){"use strict";n.d(t,{h:function(){return h},n:function(){return u}});var r=n(6540),o=n(9242);const i=e=>{let t;const n=new Set,r=(e,r)=>{const o="function"==typeof e?e(t):e;if(!Object.is(o,t)){const e=t;t=(null!=r?r:"object"!=typeof o||null===o)?o:Object.assign({},t,o),n.forEach((n=>n(t,e)))}},o=()=>t,i={setState:r,getState:o,getInitialState:()=>a,subscribe:e=>(n.add(e),()=>n.delete(e)),destroy:()=>{console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},a=t=e(r,o,i);return i},a=e=>e?i(e):i;const{useDebugValue:s}=r,{useSyncExternalStoreWithSelector:c}=o,l=e=>e;function u(e,t=l,n){const r=c(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return s(r),r}const d=(e,t)=>{const n=a(e),r=(e,r=t)=>u(n,e,r);return Object.assign(r,n),r},h=(e,t)=>e?d(e,t):d},4529:function(e){e.exports="1.1.4"},4570:function(e,t,n){let r=n(6743).Graph,o=n(6796);e.exports=function(e,t){if(e.nodeCount()<=1)return[];let n=function(e,t){let n=new r,i=0,a=0;e.nodes().forEach((e=>{n.setNode(e,{v:e,in:0,out:0})})),e.edges().forEach((e=>{let r=n.edge(e.v,e.w)||0,o=t(e),s=r+o;n.setEdge(e.v,e.w,s),a=Math.max(a,n.node(e.v).out+=o),i=Math.max(i,n.node(e.w).in+=o)}));let c=function(e){const t=[];for(let n=0;n<e;n++)t.push(n);return t}(a+i+3).map((()=>new o)),l=i+1;return n.nodes().forEach((e=>{s(c,l,n.node(e))})),{graph:n,buckets:c,zeroIdx:l}}(e,t||i);return function(e,t,n){let r,o=[],i=t[t.length-1],s=t[0];for(;e.nodeCount();){for(;r=s.dequeue();)a(e,t,n,r);for(;r=i.dequeue();)a(e,t,n,r);if(e.nodeCount())for(let i=t.length-2;i>0;--i)if(r=t[i].dequeue(),r){o=o.concat(a(e,t,n,r,!0));break}}return o}(n.graph,n.buckets,n.zeroIdx).flatMap((t=>e.outEdges(t.v,t.w)))};let i=()=>1;function a(e,t,n,r,o){let i=o?[]:void 0;return e.inEdges(r.v).forEach((r=>{let a=e.edge(r),c=e.node(r.v);o&&i.push({v:r.v,w:r.w}),c.out-=a,s(t,n,c)})),e.outEdges(r.v).forEach((r=>{let o=e.edge(r),i=r.w,a=e.node(i);a.in-=o,s(t,n,a)})),e.removeNode(r.v),i}function s(e,t,n){n.out?n.in?e[n.out-n.in+t].enqueue(n):e[e.length-1].enqueue(n):e[0].enqueue(n)}},4718:function(e,t,n){"use strict";n.d(t,{A:function(){return r}});const r=(0,n(1788).A)("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]])},4809:function(e,t,n){"use strict";let r=n(6743).Graph;function o(e,t,n,r){let o;do{o=l(r)}while(e.hasNode(o));return n.dummy=t,e.setNode(o,n),o}e.exports={addBorderNode:function(e,t,n,r){let i={width:0,height:0};arguments.length>=4&&(i.rank=n,i.order=r);return o(e,"border",i,t)},addDummyNode:o,applyWithChunking:a,asNonCompoundGraph:function(e){let t=new r({multigraph:e.isMultigraph()}).setGraph(e.graph());return e.nodes().forEach((n=>{e.children(n).length||t.setNode(n,e.node(n))})),e.edges().forEach((n=>{t.setEdge(n,e.edge(n))})),t},buildLayerMatrix:function(e){let t=u(s(e)+1).map((()=>[]));return e.nodes().forEach((n=>{let r=e.node(n),o=r.rank;void 0!==o&&(t[o][r.order]=n)})),t},intersectRect:function(e,t){let n,r,o=e.x,i=e.y,a=t.x-o,s=t.y-i,c=e.width/2,l=e.height/2;if(!a&&!s)throw new Error("Not possible to find intersection inside of the rectangle");Math.abs(s)*c>Math.abs(a)*l?(s<0&&(l=-l),n=l*a/s,r=l):(a<0&&(c=-c),n=c,r=c*s/a);return{x:o+n,y:i+r}},mapValues:function(e,t){let n=t;"string"==typeof t&&(n=e=>e[t]);return Object.entries(e).reduce(((e,[t,r])=>(e[t]=n(r,t),e)),{})},maxRank:s,normalizeRanks:function(e){let t=e.nodes().map((t=>{let n=e.node(t).rank;return void 0===n?Number.MAX_VALUE:n})),n=a(Math.min,t);e.nodes().forEach((t=>{let r=e.node(t);Object.hasOwn(r,"rank")&&(r.rank-=n)}))},notime:function(e,t){return t()},partition:function(e,t){let n={lhs:[],rhs:[]};return e.forEach((e=>{t(e)?n.lhs.push(e):n.rhs.push(e)})),n},pick:function(e,t){const n={};for(const r of t)void 0!==e[r]&&(n[r]=e[r]);return n},predecessorWeights:function(e){let t=e.nodes().map((t=>{let n={};return e.inEdges(t).forEach((t=>{n[t.v]=(n[t.v]||0)+e.edge(t).weight})),n}));return d(e.nodes(),t)},range:u,removeEmptyRanks:function(e){let t=e.nodes().map((t=>e.node(t).rank)),n=a(Math.min,t),r=[];e.nodes().forEach((t=>{let o=e.node(t).rank-n;r[o]||(r[o]=[]),r[o].push(t)}));let o=0,i=e.graph().nodeRankFactor;Array.from(r).forEach(((t,n)=>{void 0===t&&n%i!=0?--o:void 0!==t&&o&&t.forEach((t=>e.node(t).rank+=o))}))},simplify:function(e){let t=(new r).setGraph(e.graph());return e.nodes().forEach((n=>t.setNode(n,e.node(n)))),e.edges().forEach((n=>{let r=t.edge(n.v,n.w)||{weight:0,minlen:1},o=e.edge(n);t.setEdge(n.v,n.w,{weight:r.weight+o.weight,minlen:Math.max(r.minlen,o.minlen)})})),t},successorWeights:function(e){let t=e.nodes().map((t=>{let n={};return e.outEdges(t).forEach((t=>{n[t.w]=(n[t.w]||0)+e.edge(t).weight})),n}));return d(e.nodes(),t)},time:function(e,t){let n=Date.now();try{return t()}finally{console.log(e+" time: "+(Date.now()-n)+"ms")}},uniqueId:l,zipObject:d};const i=65535;function a(e,t){if(t.length>i){const n=function(e,t=i){const n=[];for(let r=0;r<e.length;r+=t){const o=e.slice(r,r+t);n.push(o)}return n}(t);return e.apply(null,n.map((t=>e.apply(null,t))))}return e.apply(null,t)}function s(e){const t=e.nodes().map((t=>{let n=e.node(t).rank;return void 0===n?Number.MIN_VALUE:n}));return a(Math.max,t)}let c=0;function l(e){var t=++c;return toString(e)+t}function u(e,t,n=1){null==t&&(t=e,e=0);let r=e=>e<t;n<0&&(r=e=>t<e);const o=[];for(let i=e;r(i);i+=n)o.push(i);return o}function d(e,t){return e.reduce(((e,n,r)=>(e[n]=t[r],e)),{})}},4822:function(e,t,n){"use strict";let r=n(2667),o=n(7764),i=n(3535),a=n(3843),s=n(477),c=n(6743).Graph,l=n(4809);function u(e,t,n){return t.map((function(t){return a(e,t,n)}))}function d(e,t){let n=new c;e.forEach((function(e){let r=e.graph().root,o=i(e,r,n,t);o.vs.forEach(((t,n)=>e.node(t).order=n)),s(e,n,o.vs)}))}function h(e,t){Object.values(t).forEach((t=>t.forEach(((t,n)=>e.node(t).order=n))))}e.exports=function e(t,n){if(n&&"function"==typeof n.customOrder)return void n.customOrder(t,e);let i=l.maxRank(t),a=u(t,l.range(1,i+1),"inEdges"),s=u(t,l.range(i-1,-1,-1),"outEdges"),c=r(t);if(h(t,c),n&&n.disableOptimalOrderHeuristic)return;let f,m=Number.POSITIVE_INFINITY;for(let r=0,u=0;u<4;++r,++u){d(r%2?a:s,r%4>=2),c=l.buildLayerMatrix(t);let e=o(t,c);e<m&&(u=0,f=Object.assign({},c),m=e)}h(t,f)}},4867:function(e){e.exports=function(e){let t=function(e){let t={},n=0;function r(o){let i=n;e.children(o).forEach(r),t[o]={low:i,lim:n++}}return e.children().forEach(r),t}(e);e.graph().dummyChains.forEach((n=>{let r=e.node(n),o=r.edgeObj,i=function(e,t,n,r){let o,i,a=[],s=[],c=Math.min(t[n].low,t[r].low),l=Math.max(t[n].lim,t[r].lim);o=n;do{o=e.parent(o),a.push(o)}while(o&&(t[o].low>c||l>t[o].lim));i=o,o=r;for(;(o=e.parent(o))!==i;)s.push(o);return{path:a.concat(s.reverse()),lca:i}}(e,t,o.v,o.w),a=i.path,s=i.lca,c=0,l=a[c],u=!0;for(;n!==o.w;){if(r=e.node(n),u){for(;(l=a[c])!==s&&e.node(l).maxRank<r.rank;)c++;l===s&&(u=!1)}if(!u){for(;c<a.length-1&&e.node(l=a[c+1]).minRank<=r.rank;)c++;l=a[c]}e.setParent(n,l),n=e.successors(n)[0]}}))}},5456:function(e,t,n){var r=n(6239),o=n(6316);e.exports=function(e,t){var n,i=new r,a={},s=new o;function c(e){var r=e.v===n?e.w:e.v,o=s.priority(r);if(void 0!==o){var i=t(e);i<o&&(a[r]=n,s.decrease(r,i))}}if(0===e.nodeCount())return i;e.nodes().forEach((function(e){s.add(e,Number.POSITIVE_INFINITY),i.setNode(e)})),s.decrease(e.nodes()[0],0);var l=!1;for(;s.size()>0;){if(n=s.removeMin(),Object.hasOwn(a,n))i.setEdge(n,a[n]);else{if(l)throw new Error("Input graph is not connected: "+e);l=!0}e.nodeEdges(n).forEach(c)}return i}},5677:function(e){"use strict";function t(e){e.nodes().forEach((t=>n(e.node(t)))),e.edges().forEach((t=>n(e.edge(t))))}function n(e){let t=e.width;e.width=e.height,e.height=t}function r(e){e.y=-e.y}function o(e){let t=e.x;e.x=e.y,e.y=t}e.exports={adjust:function(e){let n=e.graph().rankdir.toLowerCase();"lr"!==n&&"rl"!==n||t(e)},undo:function(e){let n=e.graph().rankdir.toLowerCase();"bt"!==n&&"rl"!==n||function(e){e.nodes().forEach((t=>r(e.node(t)))),e.edges().forEach((t=>{let n=e.edge(t);n.points.forEach(r),Object.hasOwn(n,"y")&&r(n)}))}(e);"lr"!==n&&"rl"!==n||(!function(e){e.nodes().forEach((t=>o(e.node(t)))),e.edges().forEach((t=>{let n=e.edge(t);n.points.forEach(o),Object.hasOwn(n,"x")&&o(n)}))}(e),t(e))}}},5944:function(e){e.exports=function(e){var t,n={},r=[];function o(r){Object.hasOwn(n,r)||(n[r]=!0,t.push(r),e.successors(r).forEach(o),e.predecessors(r).forEach(o))}return e.nodes().forEach((function(e){t=[],o(e),t.length&&r.push(t)})),r}},6043:function(e,t,n){"use strict";n.d(t,{A:function(){return r}});const r=(0,n(1788).A)("Map",[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]])},6100:function(e,t,n){"use strict";function r(e){if("string"==typeof e||"number"==typeof e)return""+e;let t="";if(Array.isArray(e))for(let n,o=0;o<e.length;o++)""!==(n=r(e[o]))&&(t+=(t&&" ")+n);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}n.d(t,{A:function(){return r}})},6239:function(e){"use strict";var t="\0";function n(e,t){e[t]?e[t]++:e[t]=1}function r(e,t){--e[t]||delete e[t]}function o(e,t,n,r){var o=""+t,i=""+n;if(!e&&o>i){var a=o;o=i,i=a}return o+""+i+""+(void 0===r?"\0":r)}function i(e,t){return o(e,t.v,t.w,t.name)}e.exports=class{_isDirected=!0;_isMultigraph=!1;_isCompound=!1;_label;_defaultNodeLabelFn=()=>{};_defaultEdgeLabelFn=()=>{};_nodes={};_in={};_preds={};_out={};_sucs={};_edgeObjs={};_edgeLabels={};_nodeCount=0;_edgeCount=0;_parent;_children;constructor(e){e&&(this._isDirected=!Object.hasOwn(e,"directed")||e.directed,this._isMultigraph=!!Object.hasOwn(e,"multigraph")&&e.multigraph,this._isCompound=!!Object.hasOwn(e,"compound")&&e.compound),this._isCompound&&(this._parent={},this._children={},this._children[t]={})}isDirected(){return this._isDirected}isMultigraph(){return this._isMultigraph}isCompound(){return this._isCompound}setGraph(e){return this._label=e,this}graph(){return this._label}setDefaultNodeLabel(e){return this._defaultNodeLabelFn=e,"function"!=typeof e&&(this._defaultNodeLabelFn=()=>e),this}nodeCount(){return this._nodeCount}nodes(){return Object.keys(this._nodes)}sources(){var e=this;return this.nodes().filter((t=>0===Object.keys(e._in[t]).length))}sinks(){var e=this;return this.nodes().filter((t=>0===Object.keys(e._out[t]).length))}setNodes(e,t){var n=arguments,r=this;return e.forEach((function(e){n.length>1?r.setNode(e,t):r.setNode(e)})),this}setNode(e,n){return Object.hasOwn(this._nodes,e)?(arguments.length>1&&(this._nodes[e]=n),this):(this._nodes[e]=arguments.length>1?n:this._defaultNodeLabelFn(e),this._isCompound&&(this._parent[e]=t,this._children[e]={},this._children[t][e]=!0),this._in[e]={},this._preds[e]={},this._out[e]={},this._sucs[e]={},++this._nodeCount,this)}node(e){return this._nodes[e]}hasNode(e){return Object.hasOwn(this._nodes,e)}removeNode(e){var t=this;if(Object.hasOwn(this._nodes,e)){var n=e=>t.removeEdge(t._edgeObjs[e]);delete this._nodes[e],this._isCompound&&(this._removeFromParentsChildList(e),delete this._parent[e],this.children(e).forEach((function(e){t.setParent(e)})),delete this._children[e]),Object.keys(this._in[e]).forEach(n),delete this._in[e],delete this._preds[e],Object.keys(this._out[e]).forEach(n),delete this._out[e],delete this._sucs[e],--this._nodeCount}return this}setParent(e,n){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(void 0===n)n=t;else{for(var r=n+="";void 0!==r;r=this.parent(r))if(r===e)throw new Error("Setting "+n+" as parent of "+e+" would create a cycle");this.setNode(n)}return this.setNode(e),this._removeFromParentsChildList(e),this._parent[e]=n,this._children[n][e]=!0,this}_removeFromParentsChildList(e){delete this._children[this._parent[e]][e]}parent(e){if(this._isCompound){var n=this._parent[e];if(n!==t)return n}}children(e=t){if(this._isCompound){var n=this._children[e];if(n)return Object.keys(n)}else{if(e===t)return this.nodes();if(this.hasNode(e))return[]}}predecessors(e){var t=this._preds[e];if(t)return Object.keys(t)}successors(e){var t=this._sucs[e];if(t)return Object.keys(t)}neighbors(e){var t=this.predecessors(e);if(t){const r=new Set(t);for(var n of this.successors(e))r.add(n);return Array.from(r.values())}}isLeaf(e){return 0===(this.isDirected()?this.successors(e):this.neighbors(e)).length}filterNodes(e){var t=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});t.setGraph(this.graph());var n=this;Object.entries(this._nodes).forEach((function([n,r]){e(n)&&t.setNode(n,r)})),Object.values(this._edgeObjs).forEach((function(e){t.hasNode(e.v)&&t.hasNode(e.w)&&t.setEdge(e,n.edge(e))}));var r={};function o(e){var i=n.parent(e);return void 0===i||t.hasNode(i)?(r[e]=i,i):i in r?r[i]:o(i)}return this._isCompound&&t.nodes().forEach((e=>t.setParent(e,o(e)))),t}setDefaultEdgeLabel(e){return this._defaultEdgeLabelFn=e,"function"!=typeof e&&(this._defaultEdgeLabelFn=()=>e),this}edgeCount(){return this._edgeCount}edges(){return Object.values(this._edgeObjs)}setPath(e,t){var n=this,r=arguments;return e.reduce((function(e,o){return r.length>1?n.setEdge(e,o,t):n.setEdge(e,o),o})),this}setEdge(){var e,t,r,i,a=!1,s=arguments[0];"object"==typeof s&&null!==s&&"v"in s?(e=s.v,t=s.w,r=s.name,2===arguments.length&&(i=arguments[1],a=!0)):(e=s,t=arguments[1],r=arguments[3],arguments.length>2&&(i=arguments[2],a=!0)),e=""+e,t=""+t,void 0!==r&&(r=""+r);var c=o(this._isDirected,e,t,r);if(Object.hasOwn(this._edgeLabels,c))return a&&(this._edgeLabels[c]=i),this;if(void 0!==r&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(e),this.setNode(t),this._edgeLabels[c]=a?i:this._defaultEdgeLabelFn(e,t,r);var l=function(e,t,n,r){var o=""+t,i=""+n;if(!e&&o>i){var a=o;o=i,i=a}var s={v:o,w:i};r&&(s.name=r);return s}(this._isDirected,e,t,r);return e=l.v,t=l.w,Object.freeze(l),this._edgeObjs[c]=l,n(this._preds[t],e),n(this._sucs[e],t),this._in[t][c]=l,this._out[e][c]=l,this._edgeCount++,this}edge(e,t,n){var r=1===arguments.length?i(this._isDirected,arguments[0]):o(this._isDirected,e,t,n);return this._edgeLabels[r]}edgeAsObj(){const e=this.edge(...arguments);return"object"!=typeof e?{label:e}:e}hasEdge(e,t,n){var r=1===arguments.length?i(this._isDirected,arguments[0]):o(this._isDirected,e,t,n);return Object.hasOwn(this._edgeLabels,r)}removeEdge(e,t,n){var a=1===arguments.length?i(this._isDirected,arguments[0]):o(this._isDirected,e,t,n),s=this._edgeObjs[a];return s&&(e=s.v,t=s.w,delete this._edgeLabels[a],delete this._edgeObjs[a],r(this._preds[t],e),r(this._sucs[e],t),delete this._in[t][a],delete this._out[e][a],this._edgeCount--),this}inEdges(e,t){var n=this._in[e];if(n){var r=Object.values(n);return t?r.filter((e=>e.v===t)):r}}outEdges(e,t){var n=this._out[e];if(n){var r=Object.values(n);return t?r.filter((e=>e.w===t)):r}}nodeEdges(e,t){var n=this.inEdges(e,t);if(n)return n.concat(this.outEdges(e,t))}}},6316:function(e){e.exports=class{_arr=[];_keyIndices={};size(){return this._arr.length}keys(){return this._arr.map((function(e){return e.key}))}has(e){return Object.hasOwn(this._keyIndices,e)}priority(e){var t=this._keyIndices[e];if(void 0!==t)return this._arr[t].priority}min(){if(0===this.size())throw new Error("Queue underflow");return this._arr[0].key}add(e,t){var n=this._keyIndices;if(e=String(e),!Object.hasOwn(n,e)){var r=this._arr,o=r.length;return n[e]=o,r.push({key:e,priority:t}),this._decrease(o),!0}return!1}removeMin(){this._swap(0,this._arr.length-1);var e=this._arr.pop();return delete this._keyIndices[e.key],this._heapify(0),e.key}decrease(e,t){var n=this._keyIndices[e];if(t>this._arr[n].priority)throw new Error("New priority is greater than current priority. Key: "+e+" Old: "+this._arr[n].priority+" New: "+t);this._arr[n].priority=t,this._decrease(n)}_heapify(e){var t=this._arr,n=2*e,r=n+1,o=e;n<t.length&&(o=t[n].priority<t[o].priority?n:o,r<t.length&&(o=t[r].priority<t[o].priority?r:o),o!==e&&(this._swap(e,o),this._heapify(o)))}_decrease(e){for(var t,n=this._arr,r=n[e].priority;0!==e&&!(n[t=e>>1].priority<r);)this._swap(e,t),e=t}_swap(e,t){var n=this._arr,r=this._keyIndices,o=n[e],i=n[t];n[e]=i,n[t]=o,r[i.key]=e,r[o.key]=t}}},6361:function(e){e.exports=function(e,t=[]){return t.map((t=>{let n=e.inEdges(t);if(n.length){let r=n.reduce(((t,n)=>{let r=e.edge(n),o=e.node(n.v);return{sum:t.sum+r.weight*o.order,weight:t.weight+r.weight}}),{sum:0,weight:0});return{v:t,barycenter:r.sum/r.weight,weight:r.weight}}return{v:t}}))}},6554:function(e,t,n){let r=n(4809);function o(e,t,n,i,a,s,c){let l=e.children(c);if(!l.length)return void(c!==t&&e.setEdge(t,c,{weight:0,minlen:n}));let u=r.addBorderNode(e,"_bt"),d=r.addBorderNode(e,"_bb"),h=e.node(c);e.setParent(u,c),h.borderTop=u,e.setParent(d,c),h.borderBottom=d,l.forEach((r=>{o(e,t,n,i,a,s,r);let l=e.node(r),h=l.borderTop?l.borderTop:r,f=l.borderBottom?l.borderBottom:r,m=l.borderTop?i:2*i,p=h!==f?1:a-s[c]+1;e.setEdge(u,h,{weight:m,minlen:p,nestingEdge:!0}),e.setEdge(f,d,{weight:m,minlen:p,nestingEdge:!0})})),e.parent(c)||e.setEdge(t,u,{weight:0,minlen:a+s[c]})}e.exports={run:function(e){let t=r.addDummyNode(e,"root",{},"_root"),n=function(e){var t={};function n(r,o){var i=e.children(r);i&&i.length&&i.forEach((e=>n(e,o+1))),t[r]=o}return e.children().forEach((e=>n(e,1))),t}(e),i=Object.values(n),a=r.applyWithChunking(Math.max,i)-1,s=2*a+1;e.graph().nestingRoot=t,e.edges().forEach((t=>e.edge(t).minlen*=s));let c=function(e){return e.edges().reduce(((t,n)=>t+e.edge(n).weight),0)}(e)+1;e.children().forEach((r=>o(e,t,s,c,a,n,r))),e.graph().nodeRankFactor=s},cleanup:function(e){var t=e.graph();e.removeNode(t.nestingRoot),delete t.nestingRoot,e.edges().forEach((t=>{e.edge(t).nestingEdge&&e.removeEdge(t)}))}}},6743:function(e,t,n){var r=n(9351);e.exports={Graph:r.Graph,json:n(2377),alg:n(7174),version:r.version}},6796:function(e){function t(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev}function n(e,t){if("_next"!==e&&"_prev"!==e)return t}e.exports=class{constructor(){let e={};e._next=e._prev=e,this._sentinel=e}dequeue(){let e=this._sentinel,n=e._prev;if(n!==e)return t(n),n}enqueue(e){let n=this._sentinel;e._prev&&e._next&&t(e),e._next=n._next,n._next._prev=e,n._next=e,e._prev=n}toString(){let e=[],t=this._sentinel,r=t._prev;for(;r!==t;)e.push(JSON.stringify(r,n)),r=r._prev;return"["+e.join(", ")+"]"}}},7015:function(e,t,n){"use strict";n.d(t,{A:function(){return r}});const r=(0,n(1788).A)("TextSearch",[["path",{d:"M21 6H3",key:"1jwq7v"}],["path",{d:"M10 12H3",key:"1ulcyk"}],["path",{d:"M10 18H3",key:"13769t"}],["circle",{cx:"17",cy:"15",r:"3",key:"1upz2a"}],["path",{d:"m21 19-1.9-1.9",key:"dwi7p8"}]])},7174:function(e,t,n){e.exports={components:n(5944),dijkstra:n(4318),dijkstraAll:n(9552),findCycles:n(2839),floydWarshall:n(8929),isAcyclic:n(7681),postorder:n(7448),preorder:n(9439),prim:n(5456),tarjan:n(4168),topsort:n(9441)}},7204:function(e,t,n){let r=n(4809);function o(e,t,n){let r;for(;t.length&&(r=t[t.length-1]).i<=n;)t.pop(),e.push(r.vs),n++;return n}e.exports=function(e,t){let n=r.partition(e,(e=>Object.hasOwn(e,"barycenter"))),i=n.lhs,a=n.rhs.sort(((e,t)=>t.i-e.i)),s=[],c=0,l=0,u=0;i.sort((d=!!t,(e,t)=>e.barycenter<t.barycenter?-1:e.barycenter>t.barycenter?1:d?t.i-e.i:e.i-t.i)),u=o(s,a,u),i.forEach((e=>{u+=e.vs.length,s.push(e.vs),c+=e.barycenter*e.weight,l+=e.weight,u=o(s,a,u)}));var d;let h={vs:s.flat(!0)};l&&(h.barycenter=c/l,h.weight=l);return h}},7277:function(e,t,n){"use strict";let r=n(4809),o=n(2806).positionX;e.exports=function(e){(function(e){let t=r.buildLayerMatrix(e),n=e.graph().ranksep,o=0;t.forEach((t=>{const r=t.reduce(((t,n)=>{const r=e.node(n).height;return t>r?t:r}),0);t.forEach((t=>e.node(t).y=o+r/2)),o+=r+n}))})(e=r.asNonCompoundGraph(e)),Object.entries(o(e)).forEach((([t,n])=>e.node(t).x=n))}},7448:function(e,t,n){var r=n(3933);e.exports=function(e,t){return r(e,t,"post")}},7681:function(e,t,n){var r=n(9441);e.exports=function(e){try{r(e)}catch(t){if(t instanceof r.CycleException)return!1;throw t}return!0}},7764:function(e,t,n){"use strict";let r=n(4809).zipObject;function o(e,t,n){let o=r(n,n.map(((e,t)=>t))),i=t.flatMap((t=>e.outEdges(t).map((t=>({pos:o[t.w],weight:e.edge(t).weight}))).sort(((e,t)=>e.pos-t.pos)))),a=1;for(;a<n.length;)a<<=1;let s=2*a-1;a-=1;let c=new Array(s).fill(0),l=0;return i.forEach((e=>{let t=e.pos+a;c[t]+=e.weight;let n=0;for(;t>0;)t%2&&(n+=c[t+1]),t=t-1>>1,c[t]+=e.weight;l+=e.weight*n})),l}e.exports=function(e,t){let n=0;for(let r=1;r<t.length;++r)n+=o(e,t[r-1],t[r]);return n}},8057:function(e,t,n){e.exports={graphlib:n(6743),layout:n(9507),debug:n(334),util:{time:n(4809).time,notime:n(4809).notime},version:n(4529)}},8280:function(){},8351:function(e,t,n){"use strict";t.A=n.p+"static/welcome-eb6c9c3c9d3b4710ff4a6026a37c39ce.svg"},8493:function(e,t,n){"use strict";var r=n(6540);var o="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},i=r.useState,a=r.useEffect,s=r.useLayoutEffect,c=r.useDebugValue;function l(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!o(e,n)}catch(r){return!0}}var u="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var n=t(),r=i({inst:{value:n,getSnapshot:t}}),o=r[0].inst,u=r[1];return s((function(){o.value=n,o.getSnapshot=t,l(o)&&u({inst:o})}),[e,n,t]),a((function(){return l(o)&&u({inst:o}),e((function(){l(o)&&u({inst:o})}))}),[e]),c(n),n};t.useSyncExternalStore=void 0!==r.useSyncExternalStore?r.useSyncExternalStore:u},8603:function(e,t,n){"use strict";n.d(t,{A:function(){return g}});var r=n(7550),o=n(6540),i=n(2318),a=n(6942),s=n.n(a),c=n(2941),l=n(2279),u=n(2702),d=n(6327),h=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};const f=e=>{const{getPopupContainer:t,getPrefixCls:n,direction:a}=o.useContext(l.QO),{prefixCls:f,type:m="default",danger:p,disabled:g,loading:y,onClick:v,htmlType:w,children:x,className:b,menu:E,arrow:_,autoFocus:k,overlay:N,trigger:S,align:M,open:C,onOpenChange:A,placement:O,getPopupContainer:I,href:T,icon:z=o.createElement(i.A,null),title:P,buttonsRender:$=e=>e,mouseEnterDelay:L,mouseLeaveDelay:j,overlayClassName:R,overlayStyle:D,destroyPopupOnHide:H,dropdownRender:B}=e,V=h(e,["prefixCls","type","danger","disabled","loading","onClick","htmlType","children","className","menu","arrow","autoFocus","overlay","trigger","align","open","onOpenChange","placement","getPopupContainer","href","icon","title","buttonsRender","mouseEnterDelay","mouseLeaveDelay","overlayClassName","overlayStyle","destroyPopupOnHide","dropdownRender"]),F=n("dropdown",f),Y=`${F}-button`,X={menu:E,arrow:_,autoFocus:k,align:M,disabled:g,trigger:g?[]:S,onOpenChange:A,getPopupContainer:I||t,mouseEnterDelay:L,mouseLeaveDelay:j,overlayClassName:R,overlayStyle:D,destroyPopupOnHide:H,dropdownRender:B},{compactSize:G,compactItemClassnames:q}=(0,d.RQ)(F,a),W=s()(Y,q,b);"overlay"in e&&(X.overlay=N),"open"in e&&(X.open=C),X.placement="placement"in e?O:"rtl"===a?"bottomLeft":"bottomRight";const U=o.createElement(c.Ay,{type:m,danger:p,disabled:g,loading:y,onClick:v,htmlType:w,href:T,title:P},x),Z=o.createElement(c.Ay,{type:m,danger:p,icon:z}),[K,J]=$([U,Z]);return o.createElement(u.A.Compact,Object.assign({className:W,size:G,block:!0},V),K,o.createElement(r.A,Object.assign({},X),J))};f.__ANT_BUTTON=!0;var m=f;const p=r.A;p.Button=m;var g=p},8929:function(e){e.exports=function(e,n,r){return function(e,t,n){var r={},o=e.nodes();return o.forEach((function(e){r[e]={},r[e][e]={distance:0},o.forEach((function(t){e!==t&&(r[e][t]={distance:Number.POSITIVE_INFINITY})})),n(e).forEach((function(n){var o=n.v===e?n.w:n.v,i=t(n);r[e][o]={distance:i,predecessor:e}}))})),o.forEach((function(e){var t=r[e];o.forEach((function(n){var i=r[n];o.forEach((function(n){var r=i[e],o=t[n],a=i[n],s=r.distance+o.distance;s<a.distance&&(a.distance=s,a.predecessor=o.predecessor)}))}))})),r}(e,n||t,r||function(t){return e.outEdges(t)})};var t=()=>1},9207:function(e){e.exports="2.2.4"},9242:function(e,t,n){"use strict";e.exports=n(2162)},9294:function(e,t,n){"use strict";const{applyWithChunking:r}=n(4809);e.exports={longestPath:function(e){var t={};e.sources().forEach((function n(o){var i=e.node(o);if(Object.hasOwn(t,o))return i.rank;t[o]=!0;let a=e.outEdges(o).map((t=>null==t?Number.POSITIVE_INFINITY:n(t.w)-e.edge(t).minlen));var s=r(Math.min,a);return s===Number.POSITIVE_INFINITY&&(s=0),i.rank=s}))},slack:function(e,t){return e.node(t.w).rank-e.node(t.v).rank-e.edge(t).minlen}}},9351:function(e,t,n){e.exports={Graph:n(6239),version:n(9207)}},9439:function(e,t,n){var r=n(3933);e.exports=function(e,t){return r(e,t,"pre")}},9441:function(e){function t(e){var t={},r={},o=[];if(e.sinks().forEach((function i(a){if(Object.hasOwn(r,a))throw new n;Object.hasOwn(t,a)||(r[a]=!0,t[a]=!0,e.predecessors(a).forEach(i),delete r[a],o.push(a))})),Object.keys(t).length!==e.nodeCount())throw new n;return o}class n extends Error{constructor(){super(...arguments)}}e.exports=t,t.CycleException=n},9492:function(e,t,n){"use strict";n.d(t,{A:function(){return r}});const r=(0,n(1788).A)("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]])},9507:function(e,t,n){"use strict";let r=n(41),o=n(258),i=n(860),a=n(4809).normalizeRanks,s=n(4867),c=n(4809).removeEmptyRanks,l=n(6554),u=n(1236),d=n(5677),h=n(4822),f=n(7277),m=n(4809),p=n(6743).Graph;e.exports=function(e,t){let n=t&&t.debugTiming?m.time:m.notime;n("layout",(()=>{let S=n("  buildLayoutGraph",(()=>function(e){let t=new p({multigraph:!0,compound:!0}),n=N(e.graph());return t.setGraph(Object.assign({},y,k(n,g),m.pick(n,v))),e.nodes().forEach((n=>{const r=k(N(e.node(n)),w);Object.keys(x).forEach((e=>{void 0===r[e]&&(r[e]=x[e])})),t.setNode(n,r),t.setParent(n,e.parent(n))})),e.edges().forEach((n=>{let r=N(e.edge(n));t.setEdge(n,Object.assign({},E,k(r,b),m.pick(r,_)))})),t}(e)));n("  runLayout",(()=>function(e,t,n){t("    makeSpaceForEdgeLabels",(()=>function(e){let t=e.graph();t.ranksep/=2,e.edges().forEach((n=>{let r=e.edge(n);r.minlen*=2,"c"!==r.labelpos.toLowerCase()&&("TB"===t.rankdir||"BT"===t.rankdir?r.width+=r.labeloffset:r.height+=r.labeloffset)}))}(e))),t("    removeSelfEdges",(()=>function(e){e.edges().forEach((t=>{if(t.v===t.w){var n=e.node(t.v);n.selfEdges||(n.selfEdges=[]),n.selfEdges.push({e:t,label:e.edge(t)}),e.removeEdge(t)}}))}(e))),t("    acyclic",(()=>r.run(e))),t("    nestingGraph.run",(()=>l.run(e))),t("    rank",(()=>i(m.asNonCompoundGraph(e)))),t("    injectEdgeLabelProxies",(()=>function(e){e.edges().forEach((t=>{let n=e.edge(t);if(n.width&&n.height){let n=e.node(t.v),r={rank:(e.node(t.w).rank-n.rank)/2+n.rank,e:t};m.addDummyNode(e,"edge-proxy",r,"_ep")}}))}(e))),t("    removeEmptyRanks",(()=>c(e))),t("    nestingGraph.cleanup",(()=>l.cleanup(e))),t("    normalizeRanks",(()=>a(e))),t("    assignRankMinMax",(()=>function(e){let t=0;e.nodes().forEach((n=>{let r=e.node(n);r.borderTop&&(r.minRank=e.node(r.borderTop).rank,r.maxRank=e.node(r.borderBottom).rank,t=Math.max(t,r.maxRank))})),e.graph().maxRank=t}(e))),t("    removeEdgeLabelProxies",(()=>function(e){e.nodes().forEach((t=>{let n=e.node(t);"edge-proxy"===n.dummy&&(e.edge(n.e).labelRank=n.rank,e.removeNode(t))}))}(e))),t("    normalize.run",(()=>o.run(e))),t("    parentDummyChains",(()=>s(e))),t("    addBorderSegments",(()=>u(e))),t("    order",(()=>h(e,n))),t("    insertSelfEdges",(()=>function(e){var t=m.buildLayerMatrix(e);t.forEach((t=>{var n=0;t.forEach(((t,r)=>{var o=e.node(t);o.order=r+n,(o.selfEdges||[]).forEach((t=>{m.addDummyNode(e,"selfedge",{width:t.label.width,height:t.label.height,rank:o.rank,order:r+ ++n,e:t.e,label:t.label},"_se")})),delete o.selfEdges}))}))}(e))),t("    adjustCoordinateSystem",(()=>d.adjust(e))),t("    position",(()=>f(e))),t("    positionSelfEdges",(()=>function(e){e.nodes().forEach((t=>{var n=e.node(t);if("selfedge"===n.dummy){var r=e.node(n.e.v),o=r.x+r.width/2,i=r.y,a=n.x-o,s=r.height/2;e.setEdge(n.e,n.label),e.removeNode(t),n.label.points=[{x:o+2*a/3,y:i-s},{x:o+5*a/6,y:i-s},{x:o+a,y:i},{x:o+5*a/6,y:i+s},{x:o+2*a/3,y:i+s}],n.label.x=n.x,n.label.y=n.y}}))}(e))),t("    removeBorderNodes",(()=>function(e){e.nodes().forEach((t=>{if(e.children(t).length){let n=e.node(t),r=e.node(n.borderTop),o=e.node(n.borderBottom),i=e.node(n.borderLeft[n.borderLeft.length-1]),a=e.node(n.borderRight[n.borderRight.length-1]);n.width=Math.abs(a.x-i.x),n.height=Math.abs(o.y-r.y),n.x=i.x+n.width/2,n.y=r.y+n.height/2}})),e.nodes().forEach((t=>{"border"===e.node(t).dummy&&e.removeNode(t)}))}(e))),t("    normalize.undo",(()=>o.undo(e))),t("    fixupEdgeLabelCoords",(()=>function(e){e.edges().forEach((t=>{let n=e.edge(t);if(Object.hasOwn(n,"x"))switch("l"!==n.labelpos&&"r"!==n.labelpos||(n.width-=n.labeloffset),n.labelpos){case"l":n.x-=n.width/2+n.labeloffset;break;case"r":n.x+=n.width/2+n.labeloffset}}))}(e))),t("    undoCoordinateSystem",(()=>d.undo(e))),t("    translateGraph",(()=>function(e){let t=Number.POSITIVE_INFINITY,n=0,r=Number.POSITIVE_INFINITY,o=0,i=e.graph(),a=i.marginx||0,s=i.marginy||0;function c(e){let i=e.x,a=e.y,s=e.width,c=e.height;t=Math.min(t,i-s/2),n=Math.max(n,i+s/2),r=Math.min(r,a-c/2),o=Math.max(o,a+c/2)}e.nodes().forEach((t=>c(e.node(t)))),e.edges().forEach((t=>{let n=e.edge(t);Object.hasOwn(n,"x")&&c(n)})),t-=a,r-=s,e.nodes().forEach((n=>{let o=e.node(n);o.x-=t,o.y-=r})),e.edges().forEach((n=>{let o=e.edge(n);o.points.forEach((e=>{e.x-=t,e.y-=r})),Object.hasOwn(o,"x")&&(o.x-=t),Object.hasOwn(o,"y")&&(o.y-=r)})),i.width=n-t+a,i.height=o-r+s}(e))),t("    assignNodeIntersects",(()=>function(e){e.edges().forEach((t=>{let n,r,o=e.edge(t),i=e.node(t.v),a=e.node(t.w);o.points?(n=o.points[0],r=o.points[o.points.length-1]):(o.points=[],n=a,r=i),o.points.unshift(m.intersectRect(i,n)),o.points.push(m.intersectRect(a,r))}))}(e))),t("    reversePoints",(()=>function(e){e.edges().forEach((t=>{let n=e.edge(t);n.reversed&&n.points.reverse()}))}(e))),t("    acyclic.undo",(()=>r.undo(e)))}(S,n,t))),n("  updateInputGraph",(()=>function(e,t){e.nodes().forEach((n=>{let r=e.node(n),o=t.node(n);r&&(r.x=o.x,r.y=o.y,r.rank=o.rank,t.children(n).length&&(r.width=o.width,r.height=o.height))})),e.edges().forEach((n=>{let r=e.edge(n),o=t.edge(n);r.points=o.points,Object.hasOwn(o,"x")&&(r.x=o.x,r.y=o.y)})),e.graph().width=t.graph().width,e.graph().height=t.graph().height}(e,S)))}))};let g=["nodesep","edgesep","ranksep","marginx","marginy"],y={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},v=["acyclicer","ranker","rankdir","align"],w=["width","height"],x={width:0,height:0},b=["minlen","weight","width","height","labeloffset"],E={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},_=["labelpos"];function k(e,t){return m.mapValues(m.pick(e,t),Number)}function N(e){var t={};return e&&Object.entries(e).forEach((([e,n])=>{"string"==typeof e&&(e=e.toLowerCase()),t[e]=n})),t}},9552:function(e,t,n){var r=n(4318);e.exports=function(e,t,n){return e.nodes().reduce((function(o,i){return o[i]=r(e,i,t,n),o}),{})}},9850:function(e,t,n){"use strict";n.d(t,{j:function(){return i}});var r=n(7387);let o=function(e){function t(){return e.apply(this,arguments)||this}(0,r.A)(t,e);var n=t.prototype;return n.listSessions=async function(e){const t=await fetch(`${this.getBaseUrl()}/sessions/?user_id=${e}`,{headers:this.getHeaders()}),n=await t.json();if(!n.status)throw new Error(n.message||"Failed to fetch sessions");return n.data},n.getSession=async function(e,t){const n=await fetch(`${this.getBaseUrl()}/sessions/${e}?user_id=${t}`,{headers:this.getHeaders()}),r=await n.json();if(!r.status)throw new Error(r.message||"Failed to fetch session");return r.data},n.createSession=async function(e,t){const n={...e,user_id:t},r=await fetch(`${this.getBaseUrl()}/sessions/`,{method:"POST",headers:this.getHeaders(),body:JSON.stringify(n)}),o=await r.json();if(!o.status)throw new Error(o.message||"Failed to create session");return o.data},n.updateSession=async function(e,t,n){const r={...t,id:e,user_id:n},o=await fetch(`${this.getBaseUrl()}/sessions/${e}?user_id=${n}`,{method:"PUT",headers:this.getHeaders(),body:JSON.stringify(r)}),i=await o.json();if(!i.status)throw new Error(i.message||"Failed to update session");return i.data},n.getSessionRuns=async function(e,t){const n=await fetch(`${this.getBaseUrl()}/sessions/${e}/runs?user_id=${t}`,{headers:this.getHeaders()}),r=await n.json();if(!r.status)throw new Error(r.message||"Failed to fetch session runs");return r.data},n.deleteSession=async function(e,t){const n=await fetch(`${this.getBaseUrl()}/sessions/${e}?user_id=${t}`,{method:"DELETE",headers:this.getHeaders()}),r=await n.json();if(!r.status)throw new Error(r.message||"Failed to delete session")},n.listSessionMessages=async function(e,t){const n=await fetch(`${this.getBaseUrl()}/sessions/${e}/messages?user_id=${t}`,{headers:this.getHeaders()}),r=await n.json();if(!r.status)throw new Error(r.message||"Failed to fetch messages");return r.data},n.createRun=async function(e,t){const n={session_id:e,user_id:t},r=await fetch(`${this.getBaseUrl()}/runs/`,{method:"POST",headers:this.getHeaders(),body:JSON.stringify(n)}),o=await r.json();if(!o.status)throw new Error(o.message||"Failed to create run");return o.data.run_id},t}(n(3838).y);const i=new o},9888:function(e,t,n){"use strict";e.exports=n(8493)}}]);
//# sourceMappingURL=d8f268ac9f2b87d121a872ac85fce383f250aa9f-2b3e27b11be0a4fb0339.js.map